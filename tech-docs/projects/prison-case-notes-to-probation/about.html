<!doctype html>
<html lang="en" class="govuk-template no-js">
  <head>
    
    

    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>Prison Case Notes to Probation - HMPPS Probation Integration Services</title>

    <link href="../../stylesheets/manifest.css" rel="stylesheet" />

    <link rel="canonical" href="https://ministryofjustice.github.io/hmpps-probation-integration-services/tech-docs/projects/prison-case-notes-to-probation/about.html">
      <link rel="icon" sizes="48x48" href="/images/favicon.ico">
      <link rel="icon" sizes="any" href="/images/favicon.svg" type="image/svg+xml">

      <meta name="twitter:card" content="summary" />
      <meta name="twitter:domain" content="ministryofjustice.github.io" />
      <meta name="twitter:image" content="https://ministryofjustice.github.io/hmpps-probation-integration-services/tech-docs/images/opengraph-image.png" />
      <meta name="twitter:title" content="Prison Case Notes to Probation - HMPPS Probation Integration Services" />
      <meta name="twitter:url" content="https://ministryofjustice.github.io/hmpps-probation-integration-services/tech-docs/projects/prison-case-notes-to-probation/about.html" />

      <meta property="og:image" content="https://ministryofjustice.github.io/hmpps-probation-integration-services/tech-docs/images/opengraph-image.png" />
      <meta property="og:site_name" content="HMPPS Probation Integration Services" />
      <meta property="og:title" content="Prison Case Notes to Probation" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="https://ministryofjustice.github.io/hmpps-probation-integration-services/tech-docs/projects/prison-case-notes-to-probation/about.html" />

    
  </head>

  <body class="govuk-template__body">
    <script>document.body.className += ' js-enabled' + ('noModule' in HTMLScriptElement.prototype ? ' govuk-frontend-supported' : '');</script>

    <div class="app-pane">
      
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="https://ministryofjustice.github.io/hmpps-probation-integration-services/tech-docs" class="govuk-header__link govuk-header__link--homepage">
        <span class="govuk-header__product-name">
          HMPPS Probation Integration
        </span>
      </a>
    </div>
    <div class="govuk-header__content">
      <nav class="govuk-header__navigation govuk-header__navigation--end" aria-label="Menu">
        <button type="button" class="govuk-header__menu-button govuk-js-header-toggle" aria-controls="navigation" hidden>Menu</button>
        <ul id="navigation" class="govuk-header__navigation-list">
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="https://github.com/ministryofjustice/hmpps-probation-integration-services#readme">GitHub</a>
            </li>
            <li class="govuk-header__navigation-item">
              <a class="govuk-header__link" href="https://mojdt.slack.com/archives/C02HQ4M2YQN">Slack</a>
            </li>
        </ul>
      </nav>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <button type="button" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </button>
        </div>

      <div class="app-pane__body" data-module="in-page-navigation">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents" tabindex="-1">
              <div class="search" data-module="search" data-path-to-site-root="../../">
  <form action="https://www.google.co.uk/search" method="get" role="search" class="search__form govuk-!-margin-bottom-4">
    <input type="hidden" name="as_sitesearch" value="https://ministryofjustice.github.io/hmpps-probation-integration-services/tech-docs"/>
    <label class="govuk-label search__label" for="search">
      Search (via Google)
    </label>
    <input
      type="search"
      id="search" name="q"
      class="govuk-input govuk-!-margin-bottom-0 search__input"
      aria-controls="search-results"
      placeholder="Search">
    <button type="submit" class="search__button">Search</button>
  </form>
</div>

              <button type="button" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></button>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading">
                      <ul>
  <li>
    <a href="#prison-case-notes-to-probation"><span>Prison Case Notes to Probation</span></a>
    <ul>
      <li>
        <a href="#probation-business-need"><span>Probation Business Need</span></a>
      </li>
      <li>
        <a href="#context-map"><span>Context Map</span></a>
      </li>
      <li>
        <a href="#interfaces"><span>Interfaces</span></a>
        <ul>
          <li>
            <a href="#message-formats"><span>Message Formats</span></a>
          </li>
          <li>
            <a href="#case-note-details"><span>Case Note Details</span></a>
          </li>
          <li>
            <a href="#alert-details"><span>Alert Details</span></a>
          </li>
          <li>
            <a href="#person-matching"><span>Person Matching</span></a>
          </li>
        </ul>
      </li>
      <li>
        <a href="#event-triggers"><span>Event Triggers</span></a>
      </li>
      <li>
        <a href="#hmpps-technical-environment"><span>HMPPS Technical Environment</span></a>
      </li>
      <li>
        <a href="#api-reference"><span>API Reference</span></a>
      </li>
    </ul>
  </li>
</ul>


              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled" aria-label="Content">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
            <h1 id="prison-case-notes-to-probation">Prison Case Notes to Probation</h1>
<p>Inbound service that responds to case note and prison alert creation events, calls the <a href="https://github.com/ministryofjustice/offender-case-notes">Offender
Case Notes Service</a>
the <a href="https://github.com/ministryofjustice/hmpps-alerts-api">Prison Alerts Service</a> respectively,
and adds the relevant information to the Delius case history as a contact.</p>
<h2 id="probation-business-need">Probation Business Need</h2>
<p>Prison case notes and alerts are displayed as contacts in the NDelius contact log and
used by probation practitioners as part of the probation case history</p>
<h2 id="context-map">Context Map</h2>
<p><a href="../../images/prison-case-notes-to-probation-context-map.svg" rel="noopener noreferrer"><img src="../../images/prison-case-notes-to-probation-context-map.svg" alt="Context Map" /></a></p>
<h2 id="interfaces">Interfaces</h2>
<h3 id="message-formats">Message Formats</h3>
<p>The service responds to &lsquo;HMPPS domain events&rsquo; messages via the
<a href="https://github.com/ministryofjustice/cloud-platform-environments/blob/main/namespaces/live.cloud-platform.service.justice.gov.uk/hmpps-probation-integration-services-dev/resources/prison-case-notes-to-probation-queue.tf">SQS queue</a>
which are raised by the <a href="https://github.com/ministryofjustice/prison-offender-events">Prison Offender Events</a>
service</p>
<p>Example <a href="https://github.com/ministryofjustice/hmpps-probation-integration-services/blob/main/projects/prison-case-notes-to-probation/src/dev/resources/messages/">messages</a> are in the development source tree</p>
<p>Incoming messages are filtered on <code>eventType</code> by
the <a href="https://github.com/ministryofjustice/cloud-platform-environments/blob/main/namespaces/live.cloud-platform.service.justice.gov.uk/hmpps-probation-integration-services-dev/resources/prison-case-notes-to-probation-queue.tf">SQS queue policy</a></p>
<h3 id="case-note-details">Case Note Details</h3>
<p>The service uses the case note id contained in the message and a known URL for
the <a href="https://github.com/ministryofjustice/offender-case-notes">Offender Case Notes Service</a>
to request the specific case note details.</p>
<h3 id="alert-details">Alert Details</h3>
<p>The service uses the <code>detailUrl</code> contained in the message to request the specific
alert details from the <a href="https://github.com/ministryofjustice/hmpps-alerts-api">Prison Alerts Service</a>.</p>
<h3 id="person-matching">Person Matching</h3>
<p>Person records are matched across NOMIS and Delius using the NOMS number. This
relies on the NOMS number being set in Delius which happens as part of the
processing within the <a href="https://github.com/ministryofjustice/prison-to-probation-update">Prison to Probation Update</a>
service</p>
<h2 id="event-triggers">Event Triggers</h2>
<p>Prison case notes are collected and transferred based on fine-grained data
events raised when there are changes to the NOMIS database tables. As a result
of this the case notes do not necessarily map to a single business activity.
The events we respond to are roughly raised in the following circumstances:</p>
<div class="table-container">
        <table>
          <tr>
<th>Business Event</th>
<th>Message Class</th>
<th>Message Event Type / Filter</th>
<th>Case note type filter</th>
</tr><tr>
<td>NOMIS ID linked to a probation case</td>
<td>HMPPS Domain Event</td>
<td>&ldquo;probation-case.prison-identifier.added&rdquo;</td>
<td>All below types</td>
</tr><tr>
<td>Person Released from Institution</td>
<td>HMPPS Domain Event</td>
<td>&ldquo;person.case-note.created&rdquo;/&ldquo;updated&rdquo;</td>
<td>&ldquo;PRISON-RELEASE&rdquo;</td>
</tr><tr>
<td>Person Transferred</td>
<td>HMPPS Domain Event</td>
<td>&ldquo;person.case-note.created&rdquo;/&ldquo;updated&rdquo;</td>
<td>&ldquo;TRANSFER-FROMTOL&rdquo;</td>
</tr><tr>
<td>General Observations</td>
<td>HMPPS Domain Event</td>
<td>&ldquo;person.case-note.created&rdquo;/&ldquo;updated&rdquo;</td>
<td>&ldquo;GEN-OSE&rdquo;</td>
</tr><tr>
<td>Alerts Active</td>
<td>HMPPS Domain Event</td>
<td>&ldquo;person.alert.created&rdquo;/&ldquo;updated&rdquo;</td>
<td>&ldquo;ALERT-ACTIVE&rdquo;</td>
</tr><tr>
<td>Alerts Inactive</td>
<td>HMPPS Domain Event</td>
<td>&ldquo;person.alert.inactive&rdquo;</td>
<td>&ldquo;ALERT-INACTIVE&rdquo;</td>
</tr><tr>
<td>All OMiC Events</td>
<td>HMPPS Domain Event</td>
<td>&ldquo;person.case-note.created&rdquo;/&ldquo;updated&rdquo;</td>
<td>{ prefix = &ldquo;OMIC&rdquo; }</td>
</tr><tr>
<td>All OMiC OPD Events</td>
<td>HMPPS Domain Event</td>
<td>&ldquo;person.case-note.created&rdquo;/&ldquo;updated&rdquo;</td>
<td>{ prefix = &ldquo;OMIC_OPD&rdquo; }</td>
</tr><tr>
<td>Keyworking Events</td>
<td>HMPPS Domain Event</td>
<td>&ldquo;person.case-note.created&rdquo;/&ldquo;updated&rdquo;</td>
<td>{ prefix = &ldquo;KA&rdquo; }</td>
</tr>
        </table>
      </div><h2 id="hmpps-technical-environment">HMPPS Technical Environment</h2>
<p>This service takes on the responsibilities of the existing <a href="https://github.com/ministryofjustice/case-notes-to-probation">Case Notes to Probation</a>
service. It also supports the deprecation of the NDelius HTTP/JSON API interface for
ingesting case notes and the <a href="https://github.com/ministryofjustice/community-api">Community API</a>
endpoint (<code>PUT /secure/nomisCaseNotes/{nomisId}/{caseNotesId}</code>) that calls this.</p>
<h2 id="api-reference">API Reference</h2>

<ul>
<li><a href="asyncapi-reference.html">AsyncAPI Reference</a></li>
</ul>

              <div data-module='page-expiry' data-last-reviewed-on="2026-01-28">
    <div class='page-expiry--not-expired'>
      This page was last reviewed on 28 October 2025.

        It needs to be reviewed again on 28 January 2026
        by the page owner <a href="https://mojdt.slack.com/messages/probation-integration-team">#probation-integration-team</a>
        .
    </div>

    <div class='page-expiry--expired' hidden>
      This page was set to be reviewed before 28 January 2026
       by the page owner <a href="https://mojdt.slack.com/messages/probation-integration-team">#probation-integration-team</a>.
      This might mean the content is out of date.
    </div>
  </div>

          </main>

          <aside>
              <ul class="contribution-banner">
                <li><a href="https://github.com/ministryofjustice/hmpps-probation-integration-services/blob/main/doc/tech-docs/source/projects/prison-case-notes-to-probation/about.html.md.erb">View source</a></li>
                <li><a href="https://github.com/ministryofjustice/hmpps-probation-integration-services/issues/new?body=Problem+with+%27Prison+Case+Notes+to+Probation%27+%28https%3A%2F%2Fministryofjustice.github.io%2Fhmpps-probation-integration-services%2Ftech-docs%2Fprojects%2Fprison-case-notes-to-probation%2Fabout.html%29&amp;labels=bug&amp;title=Re%3A+%27Prison+Case+Notes+to+Probation%27">Report problem</a></li>
                <li><a href="https://github.com/ministryofjustice/hmpps-probation-integration-services">GitHub Repo</a></li>
              </ul>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">


      <svg
        aria-hidden="true"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >Â© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>

    
    <script src="../../javascripts/govuk_frontend.js" type="module"></script>
    <script src="../../javascripts/application.js"></script>
  </body>
</html>

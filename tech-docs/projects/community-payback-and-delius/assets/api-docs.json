{"openapi":"3.1.0","info":{"title":"API Reference","contact":{"name":"Probation Integration Team","url":"https://mojdt.slack.com/archives/C02HQ4M2YQN","email":"probation-integration-team@digital.justice.gov.uk"},"license":{"name":"MIT","url":"https://github.com/ministryofjustice/hmpps-probation-integration-services/blob/main/LICENSE"},"version":"1.0"},"servers":[{"url":"/"}],"security":[{"hmpps-auth-token":[]}],"paths":{"/projects/{projectCode}/appointments/{appointmentId}/outcome":{"put":{"tags":["appointments-controller"],"operationId":"updateAppointmentOutcome","parameters":[{"name":"projectCode","in":"path","required":true,"schema":{"type":"string"}},{"name":"appointmentId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AppointmentOutcomeRequest"}}},"required":true},"responses":{"200":{"description":"OK"}}}},"/projects/{projectCode}/appointments":{"get":{"tags":["appointments-controller"],"operationId":"getSession","parameters":[{"name":"projectCode","in":"path","required":true,"schema":{"type":"string"}},{"name":"date","in":"query","required":true,"schema":{"type":"string","format":"date"}},{"name":"username","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionResponse"}}}}}},"post":{"tags":["appointments-controller"],"operationId":"createAppointments","parameters":[{"name":"projectCode","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateAppointmentsRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CreatedAppointment"}}}}}}}},"/supervisors":{"get":{"tags":["supervisors-controller"],"operationId":"getSupervisors","parameters":[{"name":"username","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SupervisorResponse"}}}}}}},"/reference-data/unpaid-work-appointment-outcomes":{"get":{"tags":["reference-data-controller"],"operationId":"getUnpaidWorkAppointmentOutcomes","responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CodeDescription"}}}}}}}},"/reference-data/project-types":{"get":{"tags":["reference-data-controller"],"operationId":"getProjectTypes","responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/CodeDescription"}}}}}}}},"/reference-data/non-working-days":{"get":{"tags":["reference-data-controller"],"operationId":"getNonWorkingDays","responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"type":"array","items":{"type":"string","format":"date"}}}}}}}},"/providers":{"get":{"tags":["providers-controller"],"operationId":"getProviders","parameters":[{"name":"username","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProvidersResponse"}}}}}}},"/providers/{providerCode}/teams/{teamCode}/supervisors":{"get":{"tags":["providers-controller"],"operationId":"getSupervisors_1","parameters":[{"name":"providerCode","in":"path","required":true,"schema":{"type":"string"}},{"name":"teamCode","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SupervisorsResponse"}}}}}}},"/providers/{providerCode}/teams/{teamCode}/sessions":{"get":{"tags":["providers-controller"],"operationId":"getSessions","parameters":[{"name":"providerCode","in":"path","required":true,"schema":{"type":"string"}},{"name":"teamCode","in":"path","required":true,"schema":{"type":"string"}},{"name":"startDate","in":"query","required":true,"schema":{"type":"string","format":"date"}},{"name":"endDate","in":"query","required":true,"schema":{"type":"string","format":"date"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionsResponse"}}}}}}},"/providers/{code}/teams":{"get":{"tags":["providers-controller"],"operationId":"getTeams","parameters":[{"name":"code","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TeamsResponse"}}}}}}},"/projects/{projectCode}/appointments/{appointmentId}":{"get":{"tags":["appointments-controller"],"operationId":"getAppointment","parameters":[{"name":"projectCode","in":"path","required":true,"schema":{"type":"string"}},{"name":"appointmentId","in":"path","required":true,"schema":{"type":"integer","format":"int64"}},{"name":"username","in":"query","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AppointmentResponse"}}}}}}},"/docs/asyncapi":{"get":{"tags":["async-api-controller"],"operationId":"asyncApi","responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"type":"string"}}}}}}},"/case/{crn}/event/{eventNumber}/appointments/schedule":{"get":{"tags":["case-controller"],"operationId":"getSchedule","parameters":[{"name":"crn","in":"path","required":true,"schema":{"type":"string"}},{"name":"eventNumber","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ScheduleResponse"}}}}}}}},"components":{"schemas":{"AppointmentOutcomeRequest":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"version":{"type":"string","format":"uuid"},"outcome":{"$ref":"#/components/schemas/Code"},"supervisor":{"$ref":"#/components/schemas/Code"},"startTime":{"type":"string"},"endTime":{"type":"string"},"notes":{"type":"string"},"hiVisWorn":{"type":"boolean"},"workedIntensively":{"type":"boolean"},"penaltyMinutes":{"type":"integer","format":"int64"},"minutesCredited":{"type":"integer","format":"int64"},"workQuality":{"type":"string","enum":["EXCELLENT","GOOD","NOT_APPLICABLE","POOR","SATISFACTORY","UNSATISFACTORY"]},"behaviour":{"type":"string","enum":["EXCELLENT","GOOD","NOT_APPLICABLE","POOR","SATISFACTORY","UNSATISFACTORY"]},"sensitive":{"type":"boolean"},"alertActive":{"type":"boolean"}},"required":["endTime","id","startTime","supervisor","version"]},"Code":{"type":"object","properties":{"code":{"type":"string"}},"required":["code"]},"CreateAppointmentRequest":{"type":"object","properties":{"reference":{"type":"string","format":"uuid"},"crn":{"type":"string","pattern":"[A-Z][0-9]{6}"},"eventNumber":{"type":"integer","format":"int32"},"date":{"type":"string","format":"date"},"startTime":{"type":"string"},"endTime":{"type":"string"},"supervisor":{"$ref":"#/components/schemas/Code","description":"The appointment supervisor. Defaults to the unallocated staff member in the project team."},"allocationId":{"type":"integer","format":"int64"},"pickUp":{"$ref":"#/components/schemas/PickUp"},"minutesOffered":{"type":"integer","format":"int64","description":"The minutes offered towards a person's unpaid work requirement. Defaults to the difference between the appointment startTime and endTime."},"outcome":{"$ref":"#/components/schemas/Code"},"penaltyMinutes":{"type":"integer","format":"int64"},"minutesCredited":{"type":"integer","format":"int64"},"hiVisWorn":{"type":"boolean"},"workedIntensively":{"type":"boolean"},"workQuality":{"type":"string","enum":["EXCELLENT","GOOD","NOT_APPLICABLE","POOR","SATISFACTORY","UNSATISFACTORY"]},"behaviour":{"type":"string","enum":["EXCELLENT","GOOD","NOT_APPLICABLE","POOR","SATISFACTORY","UNSATISFACTORY"]},"sensitive":{"type":"boolean"},"alertActive":{"type":"boolean"},"notes":{"type":"string"}},"required":["crn","date","endTime","eventNumber","reference","startTime"]},"CreateAppointmentsRequest":{"type":"object","properties":{"appointments":{"type":"array","items":{"$ref":"#/components/schemas/CreateAppointmentRequest"}}},"required":["appointments"]},"PickUp":{"type":"object","properties":{"time":{"type":"string"},"location":{"$ref":"#/components/schemas/Code"}}},"CreatedAppointment":{"type":"object","properties":{"id":{"type":"integer","format":"int64"}},"required":["id"]},"CodeDescription":{"type":"object","properties":{"code":{"type":"string"},"description":{"type":"string"}},"required":["code","description"]},"SupervisorResponse":{"type":"object","properties":{"code":{"type":"string"},"isUnpaidWorkTeamMember":{"type":"boolean"},"unpaidWorkTeams":{"type":"array","items":{"$ref":"#/components/schemas/SupervisorTeamsResponse"}}},"required":["code","isUnpaidWorkTeamMember","unpaidWorkTeams"]},"SupervisorTeamsResponse":{"type":"object","properties":{"code":{"type":"string"},"description":{"type":"string"},"provider":{"$ref":"#/components/schemas/CodeDescription"}},"required":["code","description","provider"]},"ProvidersResponse":{"type":"object","properties":{"providers":{"type":"array","items":{"$ref":"#/components/schemas/CodeDescription"}}},"required":["providers"]},"Name":{"type":"object","properties":{"forename":{"type":"string"},"middleName":{"type":"string"},"surname":{"type":"string"}},"required":["forename","surname"]},"Supervisor":{"type":"object","properties":{"name":{"$ref":"#/components/schemas/Name"},"code":{"type":"string"},"grade":{"$ref":"#/components/schemas/CodeDescription"}},"required":["code","name"]},"SupervisorsResponse":{"type":"object","properties":{"supervisors":{"type":"array","items":{"$ref":"#/components/schemas/Supervisor"}}},"required":["supervisors"]},"SessionsResponse":{"type":"object","properties":{"sessions":{"type":"array","items":{"$ref":"#/components/schemas/UnpaidWorkSession"}}},"required":["sessions"]},"UnpaidWorkSession":{"type":"object","properties":{"project":{"$ref":"#/components/schemas/CodeDescription"},"date":{"type":"string","format":"date"},"allocatedCount":{"type":"integer","format":"int64"},"outcomeCount":{"type":"integer","format":"int64"},"enforcementActionCount":{"type":"integer","format":"int64"}},"required":["allocatedCount","date","enforcementActionCount","outcomeCount","project"]},"TeamsResponse":{"type":"object","properties":{"teams":{"type":"array","items":{"$ref":"#/components/schemas/CodeDescription"}}},"required":["teams"]},"AppointmentResponseAddress":{"type":"object","properties":{"streetName":{"type":"string"},"buildingName":{"type":"string"},"addressNumber":{"type":"string"},"townCity":{"type":"string"},"county":{"type":"string"},"postCode":{"type":"string"}}},"AppointmentResponseCase":{"type":"object","properties":{"crn":{"type":"string"},"name":{"$ref":"#/components/schemas/AppointmentResponseName"},"dateOfBirth":{"type":"string","format":"date"},"currentExclusion":{"type":"boolean"},"exclusionMessage":{"type":"string"},"currentRestriction":{"type":"boolean"},"restrictionMessage":{"type":"string"}},"required":["crn","currentExclusion","currentRestriction","dateOfBirth","name"]},"AppointmentResponseName":{"type":"object","properties":{"forename":{"type":"string"},"surname":{"type":"string"},"middleNames":{"type":"array","items":{"type":"string"}}},"required":["forename","middleNames","surname"]},"Project":{"type":"object","properties":{"name":{"type":"string"},"code":{"type":"string"},"location":{"$ref":"#/components/schemas/AppointmentResponseAddress"},"hiVisRequired":{"type":"boolean"}},"required":["code","hiVisRequired","name"]},"SessionResponse":{"type":"object","properties":{"project":{"$ref":"#/components/schemas/Project"},"appointmentSummaries":{"type":"array","items":{"$ref":"#/components/schemas/SessionResponseAppointmentSummary"}}},"required":["appointmentSummaries","project"]},"SessionResponseAppointmentSummary":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"case":{"$ref":"#/components/schemas/AppointmentResponseCase"},"outcome":{"$ref":"#/components/schemas/CodeDescription"},"requirementProgress":{"$ref":"#/components/schemas/UpwMinutes"}},"required":["case","id","requirementProgress"]},"UpwMinutes":{"type":"object","properties":{"requiredMinutes":{"type":"integer","format":"int64"},"completedMinutes":{"type":"integer","format":"int64"},"adjustments":{"type":"integer","format":"int64"}},"required":["adjustments","completedMinutes","requiredMinutes"]},"AppointmentResponse":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"reference":{"type":"string","format":"uuid"},"version":{"type":"string","format":"uuid"},"project":{"$ref":"#/components/schemas/Project"},"projectType":{"$ref":"#/components/schemas/NameCode"},"case":{"$ref":"#/components/schemas/AppointmentResponseCase"},"event":{"$ref":"#/components/schemas/EventResponse"},"supervisor":{"$ref":"#/components/schemas/AppointmentResponseSupervisor"},"team":{"$ref":"#/components/schemas/NameCode"},"provider":{"$ref":"#/components/schemas/NameCode"},"pickUpData":{"$ref":"#/components/schemas/AppointmentResponsePickupData"},"date":{"type":"string","format":"date"},"startTime":{"type":"string"},"endTime":{"type":"string"},"penaltyHours":{"type":"string"},"outcome":{"$ref":"#/components/schemas/CodeDescription"},"enforcementAction":{"$ref":"#/components/schemas/AppointmentResponseEnforcementAction"},"hiVisWorn":{"type":"boolean"},"workedIntensively":{"type":"boolean"},"workQuality":{"type":"string","enum":["EXCELLENT","GOOD","NOT_APPLICABLE","POOR","SATISFACTORY","UNSATISFACTORY"]},"behaviour":{"type":"string","enum":["EXCELLENT","GOOD","NOT_APPLICABLE","POOR","SATISFACTORY","UNSATISFACTORY"]},"notes":{"type":"string"},"updatedAt":{"type":"string","format":"date-time"},"sensitive":{"type":"boolean"},"alertActive":{"type":"boolean"}},"required":["case","date","endTime","event","id","penaltyHours","project","projectType","provider","startTime","supervisor","team","updatedAt","version"]},"AppointmentResponseEnforcementAction":{"type":"object","properties":{"code":{"type":"string"},"description":{"type":"string"},"respondBy":{"type":"string","format":"date"}},"required":["code","description"]},"AppointmentResponsePickupData":{"type":"object","properties":{"location":{"$ref":"#/components/schemas/AppointmentResponseAddress"},"locationCode":{"$ref":"#/components/schemas/Code"},"time":{"type":"string"}}},"AppointmentResponseSupervisor":{"type":"object","properties":{"code":{"type":"string"},"name":{"$ref":"#/components/schemas/AppointmentResponseName"}},"required":["code","name"]},"EventResponse":{"type":"object","properties":{"number":{"type":"integer","format":"int32"}},"required":["number"]},"NameCode":{"type":"object","properties":{"name":{"type":"string"},"code":{"type":"string"}},"required":["code","name"]},"AllocationResponse":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"project":{"$ref":"#/components/schemas/ProjectDetails"},"projectAvailability":{"$ref":"#/components/schemas/ProjectAvailabilityDetails"},"frequency":{"type":"string"},"dayOfWeek":{"type":"string"},"startDateInclusive":{"type":"string","format":"date"},"endDateInclusive":{"type":"string","format":"date"},"startTime":{"type":"string"},"endTime":{"type":"string"},"pickUp":{"$ref":"#/components/schemas/PickUp"}},"required":["dayOfWeek","endTime","id","project","startTime"]},"AppointmentScheduleResponse":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"version":{"type":"string","format":"uuid"},"project":{"$ref":"#/components/schemas/NameCode"},"date":{"type":"string","format":"date"},"startTime":{"type":"string"},"endTime":{"type":"string"},"outcome":{"$ref":"#/components/schemas/CodeDescription"},"minutesCredited":{"type":"integer","format":"int64"},"allocationId":{"type":"integer","format":"int64"}},"required":["date","endTime","id","minutesCredited","project","startTime","version"]},"ProjectAvailabilityDetails":{"type":"object","properties":{"frequency":{"type":"string"},"endDateExclusive":{"type":"string","format":"date"}}},"ProjectDetails":{"type":"object","properties":{"name":{"type":"string"},"code":{"type":"string"},"expectedEndDateExclusive":{"type":"string","format":"date"},"actualEndDateExclusive":{"type":"string","format":"date"},"type":{"$ref":"#/components/schemas/NameCode"},"provider":{"$ref":"#/components/schemas/NameCode"},"team":{"$ref":"#/components/schemas/NameCode"}},"required":["code","name","type"]},"ScheduleResponse":{"type":"object","properties":{"requirementProgress":{"$ref":"#/components/schemas/UpwMinutes"},"allocations":{"type":"array","items":{"$ref":"#/components/schemas/AllocationResponse"}},"appointments":{"type":"array","items":{"$ref":"#/components/schemas/AppointmentScheduleResponse"}}},"required":["allocations","appointments","requirementProgress"]}},"securitySchemes":{"hmpps-auth-token":{"type":"http","name":"Authorization","in":"header","scheme":"bearer","bearerFormat":"JWT"}}}}
openapi: 3.1.0
info:
  title: API Reference
  contact:
    name: Probation Integration Team
    url: https://mojdt.slack.com/archives/C02HQ4M2YQN
    email: probation-integration-team@digital.justice.gov.uk
  license:
    name: MIT
    url: https://github.com/ministryofjustice/hmpps-probation-integration-services/blob/main/LICENSE
  version: "1.0"
servers:
- url: /
security:
- hmpps-auth-token: []
paths:
  /probation-cases/{identifier}:
    get:
      tags:
      - person-resource
      operationId: getPersonDetails
      parameters:
      - name: identifier
        in: path
        required: true
        schema:
          type: string
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PersonDetail"
  /all-probation-cases:
    get:
      tags:
      - person-resource
      operationId: getPersonDetails_1
      parameters:
      - name: pageable
        in: query
        required: true
        schema:
          $ref: "#/components/schemas/Pageable"
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PagedModelPersonDetail"
components:
  schemas:
    Address:
      type: object
      properties:
        fullAddress:
          type: string
        postcode:
          type: string
        noFixedAbode:
          type: boolean
        status:
          $ref: "#/components/schemas/CodeDescription"
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
      required:
      - fullAddress
      - noFixedAbode
      - postcode
      - startDate
      - status
    Alias:
      type: object
      properties:
        name:
          $ref: "#/components/schemas/Name"
        dateOfBirth:
          type: string
          format: date
      required:
      - dateOfBirth
      - name
    CodeDescription:
      type: object
      properties:
        code:
          type: string
        description:
          type: string
      required:
      - code
      - description
    ContactDetails:
      type: object
      properties:
        telephone:
          type: string
        mobile:
          type: string
        email:
          type: string
    Identifiers:
      type: object
      properties:
        deliusId:
          type: integer
          format: int64
        crn:
          type: string
        nomsId:
          type: string
        prisonerNumber:
          type: string
        pnc:
          type: string
        cro:
          type: string
        ni:
          type: string
      required:
      - crn
      - deliusId
    LimitedAccess:
      type: object
      properties:
        message:
          type: string
        users:
          type: array
          items:
            $ref: "#/components/schemas/LimitedAccessUser"
      required:
      - users
    LimitedAccessUser:
      type: object
      properties:
        username:
          type: string
      required:
      - username
    Name:
      type: object
      properties:
        forename:
          type: string
        middleName:
          type: string
        surname:
          type: string
        previousSurname:
          type: string
        preferred:
          type: string
      required:
      - forename
      - surname
    PersonDetail:
      type: object
      properties:
        identifiers:
          $ref: "#/components/schemas/Identifiers"
        name:
          $ref: "#/components/schemas/Name"
        dateOfBirth:
          type: string
          format: date
        title:
          $ref: "#/components/schemas/CodeDescription"
        gender:
          $ref: "#/components/schemas/CodeDescription"
        nationality:
          $ref: "#/components/schemas/CodeDescription"
        secondNationality:
          $ref: "#/components/schemas/CodeDescription"
        ethnicity:
          $ref: "#/components/schemas/CodeDescription"
        ethnicityDescription:
          type: string
        contactDetails:
          $ref: "#/components/schemas/ContactDetails"
        aliases:
          type: array
          items:
            $ref: "#/components/schemas/Alias"
        addresses:
          type: array
          items:
            $ref: "#/components/schemas/Address"
        excludedFrom:
          $ref: "#/components/schemas/LimitedAccess"
        restrictedTo:
          $ref: "#/components/schemas/LimitedAccess"
        sentences:
          type: array
          items:
            $ref: "#/components/schemas/Sentence"
      required:
      - addresses
      - aliases
      - dateOfBirth
      - identifiers
      - name
      - sentences
    Sentence:
      type: object
      properties:
        date:
          type: string
          format: date
        active:
          type: boolean
      required:
      - active
      - date
    Pageable:
      type: object
      properties:
        page:
          type: integer
          format: int32
          minimum: 0
        size:
          type: integer
          format: int32
          minimum: 1
        sort:
          type: array
          items:
            type: string
    PageMetadata:
      type: object
      properties:
        size:
          type: integer
          format: int64
        number:
          type: integer
          format: int64
        totalElements:
          type: integer
          format: int64
        totalPages:
          type: integer
          format: int64
    PagedModelPersonDetail:
      type: object
      properties:
        content:
          type: array
          items:
            $ref: "#/components/schemas/PersonDetail"
        page:
          $ref: "#/components/schemas/PageMetadata"
  securitySchemes:
    hmpps-auth-token:
      type: http
      name: Authorization
      in: header
      scheme: bearer
      bearerFormat: JWT

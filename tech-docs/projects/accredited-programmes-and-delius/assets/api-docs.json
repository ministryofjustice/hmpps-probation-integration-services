{"openapi":"3.1.0","info":{"title":"API Reference","contact":{"name":"Probation Integration Team","url":"https://mojdt.slack.com/archives/C02HQ4M2YQN","email":"probation-integration-team@digital.justice.gov.uk"},"license":{"name":"MIT","url":"https://github.com/ministryofjustice/hmpps-probation-integration-services/blob/main/LICENSE"},"version":"1.0"},"servers":[{"url":"/"}],"security":[{"hmpps-auth-token":[]}],"paths":{"/appointments":{"put":{"tags":["Appointments"],"operationId":"updateAppointments","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateAppointmentsRequest"}}},"required":true},"responses":{"204":{"description":"No Content"}}},"post":{"tags":["Appointments"],"operationId":"createAppointments","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateAppointmentsRequest"}}},"required":true},"responses":{"201":{"description":"Created"}}},"delete":{"tags":["Appointments"],"operationId":"deleteAppointments","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeleteAppointmentsRequest"}}},"required":true},"responses":{"204":{"description":"No Content"}}}},"/user/{username}/access":{"post":{"tags":["Users"],"operationId":"getLimitedAccess","parameters":[{"name":"username","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"type":"array","items":{"type":"string"}}}},"required":true},"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserAccess"}}}}}}},"/appointments/search":{"post":{"tags":["Appointments"],"summary":"Get all accredited programmes appointments for a given group of cases within the provided data range","operationId":"searchAppointments","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetAppointmentsRequest"}}},"required":true},"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetAppointmentsResponse"}}}}}}},"/docs/asyncapi":{"get":{"tags":["async-api-controller"],"operationId":"asyncApi","responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"type":"string"}}}}}}},"/case/{crn}/sentence/{eventNumber}":{"get":{"tags":["Cases"],"operationId":"getSentence","parameters":[{"name":"crn","in":"path","required":true,"schema":{"type":"string"}},{"name":"eventNumber","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Sentence"}}}}}}},"/case/{crn}/sentence/{eventNumber}/offences":{"get":{"tags":["Cases"],"operationId":"getOffences","parameters":[{"name":"crn","in":"path","required":true,"schema":{"type":"string"}},{"name":"eventNumber","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Offences"}}}}}}},"/case/{crn}/requirement/{id}":{"get":{"tags":["Cases"],"operationId":"getRequirement","parameters":[{"name":"crn","in":"path","required":true,"schema":{"type":"string"}},{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Requirement"}}}}}}},"/case/{crn}/registrations":{"get":{"tags":["Cases"],"operationId":"getRegistrations","parameters":[{"name":"crn","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Registrations"}}}}}}},"/case/{crn}/personal-details":{"get":{"tags":["Cases"],"operationId":"getPersonalDetails","parameters":[{"name":"crn","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PersonalDetails"}}}}}}},"/case/{crn}/licence-conditions/{id}":{"get":{"tags":["Cases"],"operationId":"getLicenceCondition","parameters":[{"name":"crn","in":"path","required":true,"schema":{"type":"string"}},{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LicenceCondition"}}}}}}}},"components":{"schemas":{"RequestCode":{"type":"object","properties":{"code":{"type":"string"}},"required":["code"]},"UpdateAppointmentRequest":{"type":"object","properties":{"reference":{"type":"string","format":"uuid"},"date":{"type":"string","format":"date"},"startTime":{"type":"string"},"endTime":{"type":"string"},"outcome":{"$ref":"#/components/schemas/RequestCode"},"location":{"$ref":"#/components/schemas/RequestCode"},"staff":{"$ref":"#/components/schemas/RequestCode"},"team":{"$ref":"#/components/schemas/RequestCode"},"notes":{"type":"string"},"sensitive":{"type":"boolean"}},"required":["date","endTime","reference","sensitive","staff","startTime","team"]},"UpdateAppointmentsRequest":{"type":"object","properties":{"appointments":{"type":"array","items":{"$ref":"#/components/schemas/UpdateAppointmentRequest"},"minItems":1}},"required":["appointments"]},"CaseAccess":{"type":"object","properties":{"crn":{"type":"string"},"userExcluded":{"type":"boolean"},"userRestricted":{"type":"boolean"},"exclusionMessage":{"type":"string"},"restrictionMessage":{"type":"string"}},"required":["crn","userExcluded","userRestricted"]},"UserAccess":{"type":"object","properties":{"access":{"type":"array","items":{"$ref":"#/components/schemas/CaseAccess"}}},"required":["access"]},"CreateAppointmentRequest":{"type":"object","properties":{"reference":{"type":"string","format":"uuid"},"requirementId":{"type":"integer","format":"int64"},"licenceConditionId":{"type":"integer","format":"int64"},"date":{"type":"string","format":"date"},"startTime":{"type":"string"},"endTime":{"type":"string"},"outcome":{"$ref":"#/components/schemas/RequestCode"},"location":{"$ref":"#/components/schemas/RequestCode"},"staff":{"$ref":"#/components/schemas/RequestCode"},"team":{"$ref":"#/components/schemas/RequestCode"},"notes":{"type":"string"},"sensitive":{"type":"boolean"}},"required":["date","endTime","reference","sensitive","staff","startTime","team"]},"CreateAppointmentsRequest":{"type":"object","properties":{"appointments":{"type":"array","items":{"$ref":"#/components/schemas/CreateAppointmentRequest"},"minItems":1}},"required":["appointments"]},"GetAppointmentsRequest":{"type":"object","properties":{"requirementIds":{"type":"array","items":{"type":"integer","format":"int64"},"maxItems":500,"minItems":0},"licenceConditionIds":{"type":"array","items":{"type":"integer","format":"int64"},"maxItems":500,"minItems":0},"fromDate":{"type":"string","format":"date"},"toDate":{"type":"string","format":"date"}},"required":["fromDate","licenceConditionIds","requirementIds","toDate"]},"AppointmentOutcome":{"type":"object","properties":{"code":{"type":"string"},"description":{"type":"string"},"attended":{"type":"boolean"},"complied":{"type":"boolean"}},"required":["code","description"]},"AppointmentResponse":{"type":"object","properties":{"crn":{"type":"string"},"reference":{"type":"string"},"requirementId":{"type":"integer","format":"int64"},"licenceConditionId":{"type":"integer","format":"int64"},"date":{"type":"string","format":"date"},"startTime":{"type":"string","format":"date-time"},"endTime":{"type":"string","format":"date-time"},"outcome":{"$ref":"#/components/schemas/AppointmentOutcome"},"location":{"$ref":"#/components/schemas/CodedValue"},"staff":{"$ref":"#/components/schemas/ProbationPractitioner"},"team":{"$ref":"#/components/schemas/CodedValue"},"notes":{"type":"string"},"sensitive":{"type":"boolean"}},"required":["crn","date","sensitive","staff","team"]},"CodedValue":{"type":"object","properties":{"code":{"type":"string"},"description":{"type":"string"}},"required":["code","description"]},"GetAppointmentsResponse":{"type":"object","properties":{"content":{"type":"object","additionalProperties":{"type":"array","items":{"$ref":"#/components/schemas/AppointmentResponse"}}}},"required":["content"]},"Name":{"type":"object","properties":{"forename":{"type":"string"},"middleNames":{"type":"string"},"surname":{"type":"string"}},"required":["forename","surname"]},"ProbationPractitioner":{"type":"object","properties":{"name":{"$ref":"#/components/schemas/Name"},"code":{"type":"string"},"email":{"type":"string"}},"required":["code","name"]},"Sentence":{"type":"object","properties":{"description":{"type":"string"},"startDate":{"type":"string","format":"date"},"expectedEndDate":{"type":"string","format":"date"},"licenceExpiryDate":{"type":"string","format":"date"},"postSentenceSupervisionEndDate":{"type":"string","format":"date"},"twoThirdsSupervisionDate":{"type":"string","format":"date"},"custodial":{"type":"boolean"},"releaseType":{"type":"string"},"licenceConditions":{"type":"array","items":{"$ref":"#/components/schemas/CodedValue"}},"requirements":{"type":"array","items":{"$ref":"#/components/schemas/CodedValue"}},"postSentenceSupervisionRequirements":{"type":"array","items":{"$ref":"#/components/schemas/CodedValue"}}},"required":["custodial","licenceConditions","postSentenceSupervisionRequirements","requirements","startDate"]},"Offence":{"type":"object","properties":{"date":{"type":"string","format":"date"},"mainCategoryCode":{"type":"string"},"mainCategoryDescription":{"type":"string"},"subCategoryCode":{"type":"string"},"subCategoryDescription":{"type":"string"}},"required":["date","mainCategoryCode","mainCategoryDescription","subCategoryCode","subCategoryDescription"]},"Offences":{"type":"object","properties":{"mainOffence":{"$ref":"#/components/schemas/Offence"},"additionalOffences":{"type":"array","items":{"$ref":"#/components/schemas/Offence"}}},"required":["additionalOffences","mainOffence"]},"Manager":{"type":"object","properties":{"staff":{"$ref":"#/components/schemas/ProbationPractitioner"},"team":{"$ref":"#/components/schemas/CodedValue"},"probationDeliveryUnit":{"$ref":"#/components/schemas/CodedValue"},"officeLocations":{"type":"array","items":{"$ref":"#/components/schemas/CodedValue"}}},"required":["officeLocations","probationDeliveryUnit","staff","team"]},"PduOfficeLocations":{"type":"object","properties":{"code":{"type":"string"},"description":{"type":"string"},"officeLocations":{"type":"array","items":{"$ref":"#/components/schemas/CodedValue"}}},"required":["code","description","officeLocations"]},"Requirement":{"type":"object","properties":{"manager":{"$ref":"#/components/schemas/Manager"},"probationDeliveryUnits":{"type":"array","items":{"$ref":"#/components/schemas/PduOfficeLocations"}}},"required":["manager","probationDeliveryUnits"]},"Registration":{"type":"object","properties":{"type":{"$ref":"#/components/schemas/CodedValue"},"category":{"$ref":"#/components/schemas/CodedValue"},"date":{"type":"string","format":"date"},"nextReviewDate":{"type":"string","format":"date"}},"required":["date","type"]},"Registrations":{"type":"object","properties":{"registrations":{"type":"array","items":{"$ref":"#/components/schemas/Registration"}}},"required":["registrations"]},"PersonalDetails":{"type":"object","properties":{"crn":{"type":"string"},"name":{"$ref":"#/components/schemas/Name"},"dateOfBirth":{"type":"string","format":"date"},"age":{"type":"string"},"sex":{"$ref":"#/components/schemas/CodedValue"},"ethnicity":{"$ref":"#/components/schemas/CodedValue"},"probationPractitioner":{"$ref":"#/components/schemas/ProbationPractitioner"},"team":{"$ref":"#/components/schemas/CodedValue"},"probationDeliveryUnit":{"$ref":"#/components/schemas/CodedValue"}},"required":["age","crn","dateOfBirth","name","probationDeliveryUnit","probationPractitioner","sex","team"]},"LicenceCondition":{"type":"object","properties":{"manager":{"$ref":"#/components/schemas/Manager"},"probationDeliveryUnits":{"type":"array","items":{"$ref":"#/components/schemas/PduOfficeLocations"}}},"required":["manager","probationDeliveryUnits"]},"AppointmentReference":{"type":"object","properties":{"reference":{"type":"string","format":"uuid"}},"required":["reference"]},"DeleteAppointmentsRequest":{"type":"object","properties":{"appointments":{"type":"array","items":{"$ref":"#/components/schemas/AppointmentReference"},"minItems":1}},"required":["appointments"]}},"securitySchemes":{"hmpps-auth-token":{"type":"http","name":"Authorization","in":"header","scheme":"bearer","bearerFormat":"JWT"}}}}
{"openapi":"3.1.0","info":{"title":"API Reference","contact":{"name":"Probation Integration Team","url":"https://mojdt.slack.com/archives/C02HQ4M2YQN","email":"probation-integration-team@digital.justice.gov.uk"},"license":{"name":"MIT","url":"https://github.com/ministryofjustice/hmpps-probation-integration-services/blob/main/LICENSE"},"version":"1.0"},"servers":[{"url":"/"}],"security":[{"hmpps-auth-token":[]}],"paths":{"/users/{username}/access":{"get":{"tags":["user-resource"],"operationId":"userAccessCheck","parameters":[{"name":"username","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"type":"array","items":{"type":"string"}}}},"required":true},"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserAccess"}}}}}},"post":{"tags":["user-resource"],"operationId":"userAccessCheck_1","parameters":[{"name":"username","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"type":"array","items":{"type":"string"}}}},"required":true},"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserAccess"}}}}}}},"/probation-case/{crn}/referrals":{"put":{"tags":["referral-resource"],"operationId":"referralStarted","parameters":[{"name":"crn","in":"path","required":true,"schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReferralStarted"}}},"required":true},"responses":{"204":{"description":"No Content"}}}},"/probation-case/{crn}/referrals/{referralId}/appointments":{"put":{"tags":["referral-resource"],"operationId":"mergeAppointment","parameters":[{"name":"crn","in":"path","required":true,"schema":{"type":"string"}},{"name":"referralId","in":"path","required":true,"schema":{"type":"string","format":"uuid"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MergeAppointment"}}},"required":true},"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"type":"object","additionalProperties":{"type":"integer","format":"int64"}}}}}}}},"/users/{username}/managed-cases":{"get":{"tags":["user-resource"],"operationId":"managedCases","parameters":[{"name":"username","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ManagedCases"}}}}}}},"/users/{username}/details":{"get":{"tags":["user-resource"],"operationId":"userDetails","parameters":[{"name":"username","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserDetail"}}}}}}},"/probation-delivery-units":{"get":{"tags":["pdu-resource"],"operationId":"findAllDeliveryUnits","responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/DeliveryUnit"}}}}}}}},"/probation-case/{crn}/responsible-officer":{"get":{"tags":["probation-case-resource"],"operationId":"findResponsibleOfficer","parameters":[{"name":"crn","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResponsibleOfficer"}}}}}}},"/probation-case/{crn}/identifiers":{"get":{"tags":["probation-case-resource"],"operationId":"findIdentifiers","parameters":[{"name":"crn","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CaseIdentifier"}}}}}}},"/probation-case/{crn}/details":{"get":{"tags":["probation-case-resource"],"operationId":"findDetails","parameters":[{"name":"crn","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CaseDetail"}}}}}}},"/probation-case/{crn}/convictions":{"get":{"tags":["probation-case-resource"],"operationId":"findConvictions","parameters":[{"name":"crn","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CaseConvictions"}}}}}}},"/probation-case/{crn}/convictions/{id}":{"get":{"tags":["probation-case-resource"],"operationId":"findConviction","parameters":[{"name":"crn","in":"path","required":true,"schema":{"type":"string"}},{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CaseConviction"}}}}}}},"/office-locations":{"get":{"tags":["office-location-resource"],"operationId":"findAllActiveLocations","responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/OfficeLocation"}}}}}}}},"/docs/asyncapi":{"get":{"tags":["async-api-controller"],"operationId":"asyncApi","responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"type":"string"}}}}}}}},"components":{"schemas":{"CaseAccess":{"type":"object","properties":{"crn":{"type":"string"},"userExcluded":{"type":"boolean"},"userRestricted":{"type":"boolean"},"exclusionMessage":{"type":"string"},"restrictionMessage":{"type":"string"}},"required":["crn","userExcluded","userRestricted"]},"UserAccess":{"type":"object","properties":{"access":{"type":"array","items":{"$ref":"#/components/schemas/CaseAccess"}}},"required":["access"]},"ReferralStarted":{"type":"object","properties":{"referralId":{"type":"string","format":"uuid"},"startedAt":{"type":"string","format":"date-time"},"contractType":{"type":"string"},"sentenceId":{"type":"integer","format":"int64"},"notes":{"type":"string"},"urn":{"type":"string"}},"required":["contractType","notes","referralId","sentenceId","startedAt","urn"]},"MergeAppointment":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"referralId":{"type":"string","format":"uuid"},"referralReference":{"type":"string"},"start":{"type":"string","format":"date-time"},"durationInMinutes":{"type":"integer","format":"int64"},"notes":{"type":"string"},"officeLocationCode":{"type":"string"},"countsTowardsRar":{"type":"boolean"},"outcome":{"$ref":"#/components/schemas/Outcome"},"sentenceId":{"type":"integer","format":"int64"},"previousId":{"type":"string","format":"uuid"},"deliusId":{"type":"integer","format":"int64"},"rescheduleRequestedBy":{"type":"string"},"end":{"type":"string","format":"date-time"},"typeCode":{"type":"string","enum":["REFER_TO_PERSON_MANAGER","REVIEW_ENFORCEMENT_STATUS","CRSAPT","CRSSAA","CRSNOTE","NSI_REFERRAL","NSI_COMMENCED","NSI_TERMINATED","IN_PROGRESS","COMPLETED"]},"urn":{"type":"string"},"previousUrn":{"type":"string"},"referralUrn":{"type":"string"},"rescheduleOutcome":{"type":"string"}},"required":["countsTowardsRar","durationInMinutes","end","id","referralId","referralReference","referralUrn","rescheduleOutcome","start","typeCode","urn"]},"Outcome":{"type":"object","properties":{"attended":{"type":"string","enum":["YES","LATE","NO"]},"didSessionHappen":{"type":"boolean","writeOnly":true},"noSessionReasonType":{"type":"string","enum":["LOGISTICS","POP_ACCEPTABLE","POP_UNACCEPTABLE"]},"notify":{"type":"boolean"},"sessionHappened":{"type":"boolean"}},"required":["attended","notify","sessionHappened"]},"CaseIdentifier":{"type":"object","properties":{"crn":{"type":"string"},"nomsId":{"type":"string"}},"required":["crn"]},"ManagedCases":{"type":"object","properties":{"managedCases":{"type":"array","items":{"$ref":"#/components/schemas/CaseIdentifier"}}},"required":["managedCases"]},"Name":{"type":"object","properties":{"forename":{"type":"string"},"surname":{"type":"string"}},"required":["forename","surname"]},"UserDetail":{"type":"object","properties":{"username":{"type":"string"},"name":{"$ref":"#/components/schemas/Name"},"email":{"type":"string"}},"required":["name","username"]},"DeliveryUnit":{"type":"object","properties":{"code":{"type":"string"},"description":{"type":"string"},"region":{"$ref":"#/components/schemas/Region"}},"required":["code","description","region"]},"Region":{"type":"object","properties":{"code":{"type":"string"},"description":{"type":"string"}},"required":["code","description"]},"Address":{"type":"object","properties":{"buildingName":{"type":"string"},"buildingNumber":{"type":"string"},"streetName":{"type":"string"},"district":{"type":"string"},"town":{"type":"string"},"county":{"type":"string"},"postcode":{"type":"string"}}},"Manager":{"type":"object","properties":{"code":{"type":"string"},"name":{"$ref":"#/components/schemas/Name"},"username":{"type":"string"},"email":{"type":"string"},"telephoneNumber":{"type":"string"},"responsibleOfficer":{"type":"boolean"},"pdu":{"$ref":"#/components/schemas/Pdu"},"team":{"$ref":"#/components/schemas/Team"},"officeLocations":{"type":"array","items":{"$ref":"#/components/schemas/OfficeLocation"}},"unallocated":{"type":"boolean"}},"required":["code","name","officeLocations","pdu","responsibleOfficer","team","unallocated"]},"OfficeLocation":{"type":"object","properties":{"code":{"type":"string"},"description":{"type":"string"},"address":{"$ref":"#/components/schemas/Address"},"telephoneNumber":{"type":"string"},"provider":{"$ref":"#/components/schemas/Provider"}},"required":["code","description","provider"]},"Pdu":{"type":"object","properties":{"code":{"type":"string"},"description":{"type":"string"}},"required":["code","description"]},"Provider":{"type":"object","properties":{"code":{"type":"string"},"description":{"type":"string"}},"required":["code","description"]},"ResponsibleOfficer":{"type":"object","properties":{"communityManager":{"$ref":"#/components/schemas/Manager"},"prisonManager":{"$ref":"#/components/schemas/Manager"}},"required":["communityManager"]},"Team":{"type":"object","properties":{"code":{"type":"string"},"description":{"type":"string"},"email":{"type":"string"},"telephoneNumber":{"type":"string"}},"required":["code","description"]},"CaseDetail":{"type":"object","properties":{"crn":{"type":"string"},"name":{"$ref":"#/components/schemas/Name"},"dateOfBirth":{"type":"string","format":"date"},"gender":{"type":"string"},"profile":{"$ref":"#/components/schemas/Profile"},"contactDetails":{"$ref":"#/components/schemas/ContactDetails"}},"required":["contactDetails","crn","dateOfBirth","name"]},"ContactDetails":{"type":"object","properties":{"noFixedAbode":{"type":"boolean"},"mainAddress":{"$ref":"#/components/schemas/Address"},"emailAddress":{"type":"string"},"telephoneNumber":{"type":"string"},"mobileNumber":{"type":"string"}},"required":["noFixedAbode"]},"Disability":{"type":"object","properties":{"type":{"type":"string"},"startDate":{"type":"string","format":"date"},"notes":{"type":"string"}},"required":["startDate","type"]},"Profile":{"type":"object","properties":{"primaryLanguage":{"type":"string"},"ethnicity":{"type":"string"},"religion":{"type":"string"},"disabilities":{"type":"array","items":{"$ref":"#/components/schemas/Disability"}}},"required":["disabilities"]},"CaseConvictions":{"type":"object","properties":{"caseDetail":{"$ref":"#/components/schemas/CaseDetail"},"convictions":{"type":"array","items":{"$ref":"#/components/schemas/Conviction"}}},"required":["caseDetail","convictions"]},"Conviction":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"date":{"type":"string","format":"date"},"sentence":{"$ref":"#/components/schemas/Sentence"},"mainOffence":{"$ref":"#/components/schemas/Offence"},"active":{"type":"boolean"}},"required":["active","id","mainOffence","sentence"]},"Offence":{"type":"object","properties":{"category":{"type":"string"},"subCategory":{"type":"string"}},"required":["category","subCategory"]},"Sentence":{"type":"object","properties":{"description":{"type":"string"},"expectedEndDate":{"type":"string","format":"date"}},"required":["description"]},"CaseConviction":{"type":"object","properties":{"caseDetail":{"$ref":"#/components/schemas/CaseDetail"},"conviction":{"$ref":"#/components/schemas/Conviction"}},"required":["caseDetail","conviction"]}},"securitySchemes":{"hmpps-auth-token":{"type":"http","name":"Authorization","in":"header","scheme":"bearer","bearerFormat":"JWT"}}}}
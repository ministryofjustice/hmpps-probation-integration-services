{"openapi":"3.1.0","info":{"title":"API Reference","contact":{"name":"Probation Integration Team","url":"https://mojdt.slack.com/archives/C02HQ4M2YQN","email":"probation-integration-team@digital.justice.gov.uk"},"license":{"name":"MIT","url":"https://github.com/ministryofjustice/hmpps-probation-integration-services/blob/main/LICENSE"},"version":"1.0"},"servers":[{"url":"/"}],"security":[{"hmpps-auth-token":[]}],"paths":{"/assessments/{id}/section/{name}":{"get":{"tags":["assessment-controller"],"operationId":"getSection","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}},{"name":"name","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/JsonNode"}}}}}}},"/assessments/{id}/risk-predictors":{"get":{"tags":["assessment-controller"],"operationId":"getRiskPredictors","parameters":[{"name":"id","in":"path","required":true,"schema":{"type":"integer","format":"int64"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RiskPrediction"}}}}}}},"/assessments/timeline/{nomisIdOrCrn}":{"get":{"tags":["assessment-controller"],"operationId":"getTimeline","parameters":[{"name":"nomisIdOrCrn","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Timeline"}}}}}}},"/assessments/pni/{nomisIdOrCrn}":{"get":{"tags":["assessment-controller"],"operationId":"getPniCalculation","parameters":[{"name":"nomisIdOrCrn","in":"path","required":true,"schema":{"type":"string"}},{"name":"community","in":"query","required":true,"schema":{"type":"boolean"}}],"responses":{"200":{"description":"OK","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PniResponse"}}}}}}}},"components":{"schemas":{"JsonNode":{},"RiskPrediction":{"type":"object","properties":{"groupReconvictionScore":{"$ref":"#/components/schemas/YearPredictor"},"violencePredictorScore":{"$ref":"#/components/schemas/YearPredictor"},"generalPredictorScore":{"$ref":"#/components/schemas/YearPredictor"},"riskOfSeriousRecidivismScore":{"$ref":"#/components/schemas/RsrPredictor"},"sexualPredictorScore":{"$ref":"#/components/schemas/SexualPredictor"}}},"RsrPredictor":{"type":"object","properties":{"scoreLevel":{"type":"string","enum":["LOW","MEDIUM","HIGH","VERY_HIGH","NOT_APPLICABLE"]},"percentageScore":{"type":"number"}}},"SexualPredictor":{"type":"object","properties":{"ospIndecentPercentageScore":{"type":"number"},"ospContactPercentageScore":{"type":"number"},"ospIndecentPercentageScoreLevel":{"type":"string","enum":["LOW","MEDIUM","HIGH","VERY_HIGH","NOT_APPLICABLE"]},"ospContactPercentageScoreLevel":{"type":"string","enum":["LOW","MEDIUM","HIGH","VERY_HIGH","NOT_APPLICABLE"]},"ospIndirectImagePercentageScore":{"type":"number"},"ospDirectContactPercentageScore":{"type":"number"},"ospIndirectImagePercentageScoreLevel":{"type":"string","enum":["LOW","MEDIUM","HIGH","VERY_HIGH","NOT_APPLICABLE"]},"ospDirectContactPercentageScoreLevel":{"type":"string","enum":["LOW","MEDIUM","HIGH","VERY_HIGH","NOT_APPLICABLE"]}}},"YearPredictor":{"type":"object","properties":{"oneYear":{"type":"number"},"twoYears":{"type":"number"},"scoreLevel":{"type":"string","enum":["LOW","MEDIUM","HIGH","VERY_HIGH","NOT_APPLICABLE"]}}},"AssessmentSummary":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"completedAt":{"type":"string","format":"date-time"},"type":{"type":"string"},"status":{"type":"string"}},"required":["id","status","type"]},"Timeline":{"type":"object","properties":{"crn":{"type":"string"},"nomsId":{"type":"string"},"timeline":{"type":"array","items":{"$ref":"#/components/schemas/AssessmentSummary"}}},"required":["timeline"]},"Ldc":{"type":"object","properties":{"score":{"type":"integer","format":"int32"},"subTotal":{"type":"integer","format":"int32"}},"required":["score","subTotal"]},"LevelScore":{"type":"object","properties":{"level":{"type":"string","enum":["H","M","L"]},"score":{"type":"integer","format":"int32"}},"required":["level","score"]},"Osp":{"type":"object","properties":{"cdc":{"type":"string","enum":["LOW","MEDIUM","HIGH","VERY_HIGH","NOT_APPLICABLE"]},"iiic":{"type":"string","enum":["LOW","MEDIUM","HIGH","VERY_HIGH","NOT_APPLICABLE"]}}},"PniAssessment":{"type":"object","properties":{"id":{"type":"integer","format":"int64"},"ldc":{"$ref":"#/components/schemas/Ldc"},"ldcMessage":{"type":"string"},"ogrs3Risk":{"type":"string","enum":["LOW","MEDIUM","HIGH","VERY_HIGH","NOT_APPLICABLE"]},"ovpRisk":{"type":"string","enum":["LOW","MEDIUM","HIGH","VERY_HIGH","NOT_APPLICABLE"]},"osp":{"$ref":"#/components/schemas/Osp"},"rsrPercentage":{"type":"number","format":"double"},"offenderAge":{"type":"integer","format":"int32"},"questions":{"$ref":"#/components/schemas/Questions"}},"required":["id","offenderAge","questions"]},"PniCalculation":{"type":"object","properties":{"sexDomain":{"$ref":"#/components/schemas/LevelScore"},"thinkingDomain":{"$ref":"#/components/schemas/LevelScore"},"relationshipDomain":{"$ref":"#/components/schemas/LevelScore"},"selfManagementDomain":{"$ref":"#/components/schemas/LevelScore"},"riskLevel":{"type":"string","enum":["H","M","L"]},"needLevel":{"type":"string","enum":["H","M","L"]},"totalDomainScore":{"type":"integer","format":"int32"},"pni":{"type":"string","enum":["H","M","A","O"]},"saraRiskLevel":{"$ref":"#/components/schemas/SaraRiskLevel"},"missingFields":{"type":"array","items":{"type":"string"}}},"required":["missingFields","needLevel","pni","relationshipDomain","riskLevel","saraRiskLevel","selfManagementDomain","sexDomain","thinkingDomain","totalDomainScore"]},"PniResponse":{"type":"object","properties":{"pniCalculation":{"$ref":"#/components/schemas/PniCalculation"},"assessment":{"$ref":"#/components/schemas/PniAssessment"}}},"Questions":{"type":"object","properties":{"everCommittedSexualOffence":{"type":"string","enum":["YES","NO","Unknown"]},"openSexualOffendingQuestions":{"type":"string","enum":["YES","NO","Unknown"]},"sexualPreOccupation":{"type":"string","enum":["NONE","SOME","SIGNIFICANT","MISSING"]},"offenceRelatedSexualInterests":{"type":"string","enum":["NONE","SOME","SIGNIFICANT","MISSING"]},"emotionalCongruence":{"type":"string","enum":["NONE","SOME","SIGNIFICANT","MISSING"]},"proCriminalAttitudes":{"type":"string","enum":["NONE","SOME","SIGNIFICANT","MISSING"]},"hostileOrientation":{"type":"string","enum":["NONE","SOME","SIGNIFICANT","MISSING"]},"relCloseFamily":{"type":"string","enum":["NONE","SOME","SIGNIFICANT","MISSING"]},"prevCloseRelationships":{"type":"string","enum":["NONE","SOME","SIGNIFICANT","MISSING"]},"easilyInfluenced":{"type":"string","enum":["NONE","SOME","SIGNIFICANT","MISSING"]},"aggressiveControllingBehaviour":{"type":"string","enum":["NONE","SOME","SIGNIFICANT","MISSING"]},"impulsivity":{"type":"string","enum":["NONE","SOME","SIGNIFICANT","MISSING"]},"temperControl":{"type":"string","enum":["NONE","SOME","SIGNIFICANT","MISSING"]},"problemSolvingSkills":{"type":"string","enum":["NONE","SOME","SIGNIFICANT","MISSING"]},"difficultiesCoping":{"type":"string","enum":["NONE","SOME","SIGNIFICANT","MISSING"]}},"required":["aggressiveControllingBehaviour","difficultiesCoping","easilyInfluenced","emotionalCongruence","everCommittedSexualOffence","hostileOrientation","impulsivity","offenceRelatedSexualInterests","prevCloseRelationships","proCriminalAttitudes","problemSolvingSkills","relCloseFamily","sexualPreOccupation","temperControl"]},"SaraRiskLevel":{"type":"object","properties":{"toPartner":{"type":"integer","format":"int32"},"toOther":{"type":"integer","format":"int32"}},"required":["toOther","toPartner"]}},"securitySchemes":{"hmpps-auth-token":{"type":"http","name":"Authorization","in":"header","scheme":"bearer","bearerFormat":"JWT"}}}}
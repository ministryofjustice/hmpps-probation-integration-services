<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>TSTNDA.DELIUS_APP_SCHEMA</title>
        <!-- Tell the browser to be responsive to screen width -->
        <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
        <link rel="icon" type="image/png" sizes="16x16" href="../favicon.png">
        <!-- Bootstrap 3.3.5 -->
        <link rel="stylesheet" href="../bower/admin-lte/bootstrap/css/bootstrap.min.css">
        <!-- Font Awesome -->
        <link rel="stylesheet" href="../bower/font-awesome/css/font-awesome.min.css">
        <!-- Ionicons -->
        <link rel="stylesheet" href="../bower/ionicons/css/ionicons.min.css">
        <!-- DataTables -->
        <link rel="stylesheet" href="../bower/datatables.net-bs/css/dataTables.bootstrap.min.css">
        <link rel="stylesheet" href="../bower/datatables.net-buttons-bs/css/buttons.bootstrap.min.css">
        <!-- Code Mirror -->
        <link rel="stylesheet" href="../bower/codemirror/codemirror.css">
        <!-- Fonts -->
        <link href='../fonts/indieflower/indie-flower.css' rel='stylesheet' type='text/css'>
        <link href='../fonts/source-sans-pro/source-sans-pro.css' rel='stylesheet' type='text/css'>

        <!-- Theme style -->
        <link rel="stylesheet" href="../bower/admin-lte/dist/css/AdminLTE.min.css">
        <!-- Salvattore -->
        <link rel="stylesheet" href="../bower/salvattore/salvattore.css">
        <!-- AdminLTE Skins. Choose a skin from the css/skins
           folder instead of downloading all of them to reduce the load. -->
        <link rel="stylesheet" href="../bower/admin-lte/dist/css/skins/_all-skins.min.css">
        <!-- SchemaSpy -->
        <link rel="stylesheet" href="../schemaSpy.css">

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
        <script src="../bower/html5shiv/html5shiv.min.js"></script>
        <script src="../bower/respond/respond.min.js"></script>
        <![endif]-->
    </head>
    <!-- ADD THE CLASS layout-top-nav TO REMOVE THE SIDEBAR. -->
    <body class="hold-transition skin-blue layout-top-nav">
        <div class="wrapper">
            <header class="main-header">
                <nav class="navbar navbar-static-top">
                    <div class="container">
                        <div class="navbar-header">
                            <a href="../index.html" class="navbar-brand"><b>TSTNDA</b></a><span class="navbar-brand" style="padding-left: 0">.DELIUS_APP_SCHEMA</span>
                            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse"><i class="fa fa-bars"></i></button>
                        </div>

                        <!-- Collect the nav links, forms, and other content for toggling -->
                        <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
                            <ul class="nav navbar-nav">
                                <li><a href="../index.html">Tables <span class="sr-only">(current)</span></a></li>
                                <li><a href="../columns.html" title="All of the columns in the schema">Columns</a></li>
                                <li><a href="../constraints.html" title="Useful for diagnosing error messages that just give constraint name or number">Constraints</a></li>
                                <li><a href="../relationships.html" title="Diagram of table relationships">Relationships</a></li>
                                <li><a href="../orphans.html" title="View of tables with neither parents nor children">Orphan&nbsp;Tables</a></li>
                                <li><a href="../anomalies.html" title="Things that might not be quite right">Anomalies</a></li>
                                <li><a href="../routines.html" title="Procedures and functions">Routines</a></li>
                            </ul>
                        </div>
                        <!-- /.navbar-collapse -->
                        <!-- Navbar Right Menu -->
                    </div>
                    <!-- /.container-fluid -->
                </nav>
            </header>
            <!-- Main content -->
            <!-- Full Width Column -->
            <div class="content-wrapper">
                <!-- Content Header (Page header) -->
                <section class="content-header">
                    <h1>DELIUS_APP_SCHEMA.PKG_DYNSQL</h1><br />
                </section>
                <!-- Main content -->
                <section class="content">
                    <div class="box box-primary">
                        <div class="box-header with-border">
                            <span class="glyphicon glyphicon-list-alt" aria-hidden="true"></span>
                            <h3 id="Columns" class="box-title">Parameters</h3>
                            <div class="box-tools pull-right">
                                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                                <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                            </div>
                        </div>
                        <div class="box-body">
                            <table id="standard_table" class="table table-bordered table-striped dataTable" role="grid">
                                <thead align='left'>
                                <tr>
                                    <th>Name</th>
                                    <th>Type</th>
                                    <th>Mode</th>
                                </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="box box-primary">
                        <div class="box-header with-border">
                            <i class="fa fa-file-code-o"></i>
                            <h3 id="RoutineDefinition" class="box-title">Definition</h3>
                            <div class="box-tools pull-right">
                                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                                <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                            </div>
                        </div>
                        <div class="box-body">
                            <textarea id="sql-script-codemirror" name="sql-script-codemirror" rows="" style="display: none;">PACKAGE BODY PKG_DynSQL&#10;AS&#10;--&#10;--&#10;--&#10;--&#10;&#10;VARCHAR_IS_TOO_BIG EXCEPTION;&#10;lc_max_vchar_size  CONSTANT INTEGER :&#61; 32767;&#10;&#10;g_label        VARCHAR2(30);&#10;--&#10;g_bind_cnt NUMBER :&#61; 0;&#10;&#10;GC_DB_NAME   VARCHAR2(40) :&#61; &#39;nd_lup&#39;; --&#39;dbname&#61;delius_app_schema&#39;;&#10;G_CONN_NAME VARCHAR2(31)  :&#61; &#39;exec_sql_atnm&#39;;&#10;&#10;G_AUTONOMOUS_TRX_INIT BOOLEAN :&#61; FALSE;&#10;&#10;--&#10;--&#10;g_tab_info_CLOB      CLOB;&#10;g_tab_info           TYP_tab_info_TAB;&#10;G_TAB_INFO_INIT_FLAG BOOLEAN :&#61; FALSE;&#10;&#10;g_TAB_HIER           ttabTablesHierarchy :&#61; ttabTablesHierarchy();&#10;g_TAB1_HIER          ttabTablesHierarchy :&#61; ttabTablesHierarchy();&#10;g_TAB_HIER_FLAG      BOOLEAN :&#61; FALSE;&#10;&#10;&#10;&#10;&#10;&#10;FUNCTION get_version RETURN VARCHAR2 IS&#10;BEGIN&#10;    RETURN GC_VERSION;&#10;END get_version;&#10;&#10;--&#10;-- PKG_COMMON wrappers&#10;--&#10;PROCEDURE procDebug(p_msg CLOB, p_print_flag VARCHAR2 DEFAULT &#39;N&#39;) IS&#10;BEGIN&#10;    PKG_Debug.procDebug(p_msg, p_print_flag);&#10;END procDebug;&#10;--&#10;PROCEDURE message(p_msg VARCHAR2, p_trace_level NUMBER DEFAULT 0) IS&#10;BEGIN&#10;    PKG_Common.print_message(&#10;        p_msg         &#61;&gt; p_msg,&#10;        p_trace_level &#61;&gt; NVL(p_trace_level, PKG_Common.GC_TRACE_LEVEL),&#10;        p_label       &#61;&gt; g_label );&#10;END message;&#10;--&#10;FUNCTION empty2null(p_str VARCHAR2) RETURN VARCHAR2 IS&#10;BEGIN&#10;    RETURN PKG_Common.empty2null(p_str);&#10;END empty2null;&#10;&#10;FUNCTION nvlstr(p_str1 VARCHAR2, p_str2 VARCHAR2) RETURN VARCHAR2 IS&#10;BEGIN&#10;    RETURN PKG_Common.NVLSTR(p_str1, p_str2);&#10;END nvlstr;&#10;&#10;FUNCTION is_str_empty(p_str VARCHAR2, p_ignore_spaces_and_zeroes VARCHAR2 DEFAULT &#39;N&#39;) RETURN VARCHAR2 IS&#10;BEGIN&#10;    RETURN PKG_Common.is_str_empty( p_str, p_ignore_spaces_and_zeroes );&#10;END is_str_empty;&#10;--&#10;PROCEDURE raise_error(p_err_msg VARCHAR2, p_proc VARCHAR2 DEFAULT NULL, p_label VARCHAR2 DEFAULT NULL ) IS&#10;BEGIN&#10;    PKG_Common.raise_error( p_err_msg, &#39;PKG_DynSQL.&#39; || p_proc, p_label );&#10;END raise_error;&#10;--&#10;--&#10;--&#10;--&#10;-- ORA&#10;--FUNCTION DBLINK_CONNECT(p_conn_name VARCHAR2, p_db_name VARCHAR2) RETURN VARCHAR2 IS BEGIN RETURN &#39;OK&#39;; END DBLINK_CONNECT;&#10;--FUNCTION DBLINK_DISCONNECT(p_conn_name VARCHAR2)                  RETURN VARCHAR2 IS BEGIN RETURN &#39;OK&#39;; END DBLINK_DISCONNECT;&#10;--FUNCTION DBLINK_EXEC(p_conn_name VARCHAR2, p_SQL VARCHAR2, p_raise_err_flag BOOLEAN DEFAULT TRUE) RETURN VARCHAR2 IS BEGIN RETURN &#39;OK&#39;; END DBLINK_EXEC;&#10;&#10;PROCEDURE do_add_str(p_str VARCHAR2, x_bind_par_str IN OUT VARCHAR2) IS&#10;BEGIN&#10;    IF nvlstr(p_str, &#39;X&#39;) &lt;&gt; &#39;NO_VALUE&#39; THEN&#10;        --&#10;        g_bind_cnt :&#61; g_bind_cnt + 1;&#10;        --&#10;        IF empty2null(x_bind_par_str) IS NOT NULL THEN&#10;            x_bind_par_str :&#61; SUBSTRB(x_bind_par_str || &#39;,&#39;, 1, 30000);&#10;        END IF;&#10;        x_bind_par_str :&#61; SUBSTRB(x_bind_par_str || p_str, 1, 30000);&#10;    END IF;&#10;END do_add_str;&#10;--&#10;PROCEDURE do_print_sql(&#10;    p_sql VARCHAR2,&#10;    p_bind_vars VARCHAR2 DEFAULT &#39;N&#39;,&#10;    p_trace_level NUMBER DEFAULT 5,&#10;    --&#10;    p_param_1  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_2 VARCHAR2 DEFAULT &#39;NO_VALUE&#39; , p_param_3  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_4  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_5  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_6  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_7  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_8  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_9  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_10 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_11 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_12 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_13 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_14 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_15 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_16 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_17 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_18 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_19 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_20 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_21 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_22 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_23 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_24 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_25 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_26 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_27 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_28 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_29 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_30 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_31 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_32 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_33 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_34 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_35 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_36 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_37 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_38 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_39 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_40 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_41 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_42 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_43 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_44 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_45 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_46 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_47 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_48 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_49 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_50 VARCHAR2 DEFAULT &#39;NO_VALUE&#39; )&#10;IS&#10;    l_bind_par_str VARCHAR2(30000);&#10;BEGIN&#10;    message(&#39;exec_sql: &#39; || p_sql, p_trace_level);&#10;    IF p_bind_vars &#61; &#39;Y&#39; THEN&#10;        --print_bind_vars;&#10;        IF nvlstr(p_param_1, &#39;X&#39;) &lt;&gt; &#39;NO_VALUE&#39; THEN&#10;            do_add_str(p_param_1, l_bind_par_str);&#10;            do_add_str(p_param_2, l_bind_par_str);&#10;            do_add_str(p_param_3, l_bind_par_str);&#10;            do_add_str(p_param_4, l_bind_par_str);&#10;            do_add_str(p_param_5, l_bind_par_str);&#10;            do_add_str(p_param_6, l_bind_par_str);&#10;            do_add_str(p_param_7, l_bind_par_str);&#10;            do_add_str(p_param_8, l_bind_par_str);&#10;            do_add_str(p_param_9, l_bind_par_str);&#10;            do_add_str(p_param_10, l_bind_par_str);&#10;            do_add_str(p_param_11, l_bind_par_str);&#10;            do_add_str(p_param_12, l_bind_par_str);&#10;            do_add_str(p_param_13, l_bind_par_str);&#10;            do_add_str(p_param_14, l_bind_par_str);&#10;            do_add_str(p_param_15, l_bind_par_str);&#10;            do_add_str(p_param_16, l_bind_par_str);&#10;            do_add_str(p_param_17, l_bind_par_str);&#10;            do_add_str(p_param_18, l_bind_par_str);&#10;            do_add_str(p_param_19, l_bind_par_str);&#10;            do_add_str(p_param_20, l_bind_par_str);&#10;            do_add_str(p_param_21, l_bind_par_str);&#10;            do_add_str(p_param_22, l_bind_par_str);&#10;            do_add_str(p_param_23, l_bind_par_str);&#10;            do_add_str(p_param_24, l_bind_par_str);&#10;            do_add_str(p_param_25, l_bind_par_str);&#10;            do_add_str(p_param_26, l_bind_par_str);&#10;            do_add_str(p_param_27, l_bind_par_str);&#10;            do_add_str(p_param_28, l_bind_par_str);&#10;            do_add_str(p_param_29, l_bind_par_str);&#10;            do_add_str(p_param_30, l_bind_par_str);&#10;            do_add_str(p_param_31, l_bind_par_str);&#10;            do_add_str(p_param_32, l_bind_par_str);&#10;            do_add_str(p_param_33, l_bind_par_str);&#10;            do_add_str(p_param_34, l_bind_par_str);&#10;            do_add_str(p_param_35, l_bind_par_str);&#10;            do_add_str(p_param_36, l_bind_par_str);&#10;            do_add_str(p_param_37, l_bind_par_str);&#10;            do_add_str(p_param_38, l_bind_par_str);&#10;            do_add_str(p_param_39, l_bind_par_str);&#10;            do_add_str(p_param_40, l_bind_par_str);&#10;            do_add_str(p_param_41, l_bind_par_str);&#10;            do_add_str(p_param_42, l_bind_par_str);&#10;            do_add_str(p_param_43, l_bind_par_str);&#10;            do_add_str(p_param_44, l_bind_par_str);&#10;            do_add_str(p_param_45, l_bind_par_str);&#10;            do_add_str(p_param_46, l_bind_par_str);&#10;            do_add_str(p_param_47, l_bind_par_str);&#10;            do_add_str(p_param_48, l_bind_par_str);&#10;            do_add_str(p_param_49, l_bind_par_str);&#10;            do_add_str(p_param_50, l_bind_par_str);&#10;            --&#10;            IF empty2null(l_bind_par_str) IS NOT NULL THEN&#10;                message(&#39;SQL bind variables (&#39; || g_bind_cnt || &#39;): &#39; || l_bind_par_str, p_trace_level);&#10;            END IF;&#10;        END IF;&#10;    END IF;&#10;END do_print_sql;&#10;--&#10;PROCEDURE do_bind_parameter(p_par_num NUMBER, p_par_value VARCHAR2, x_SQL IN OUT VARCHAR2) IS&#10;BEGIN&#10;    IF nvlstr(p_par_value, &#39;X&#39;) &lt;&gt; &#39;NO_VALUE&#39; THEN&#10;        x_SQL :&#61; REPLACE(x_SQL, &#39;:p_param_&#39; || p_par_num, &#39;&#39;&#39;&#39; || p_par_value || &#39;&#39;&#39;&#39;);&#10;    END IF;&#10;END do_bind_parameter;&#10;--&#10;PROCEDURE do_bind_params_sql(&#10;    x_SQL IN OUT VARCHAR2,&#10;    --&#10;    p_param_1  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_2 VARCHAR2 DEFAULT &#39;NO_VALUE&#39; , p_param_3  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_4  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_5  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_6  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_7  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_8  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_9  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_10 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_11 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_12 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_13 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_14 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_15 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_16 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_17 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_18 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_19 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_20 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_21 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_22 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_23 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_24 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_25 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_26 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_27 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_28 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_29 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_30 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_31 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_32 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_33 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_34 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_35 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_36 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_37 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_38 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_39 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_40 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_41 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_42 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_43 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_44 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_45 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_46 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_47 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_48 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_49 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_50 VARCHAR2 DEFAULT &#39;NO_VALUE&#39; )&#10;IS&#10;BEGIN&#10;    --message(&#39;exec_sql: &#39; || p_sql, p_trace_level);&#10;    IF nvlstr(p_param_1, &#39;X&#39;) &lt;&gt; &#39;NO_VALUE&#39; THEN&#10;        do_bind_parameter(50, p_param_50, x_SQL);&#10;        do_bind_parameter(49, p_param_49, x_SQL);&#10;        do_bind_parameter(48, p_param_48, x_SQL);&#10;        do_bind_parameter(47, p_param_47, x_SQL);&#10;        do_bind_parameter(46, p_param_46, x_SQL);&#10;        do_bind_parameter(45, p_param_45, x_SQL);&#10;        do_bind_parameter(44, p_param_44, x_SQL);&#10;        do_bind_parameter(43, p_param_43, x_SQL);&#10;        do_bind_parameter(42, p_param_42, x_SQL);&#10;        do_bind_parameter(41, p_param_41, x_SQL);&#10;        do_bind_parameter(40, p_param_40, x_SQL);&#10;        --&#10;        do_bind_parameter(39, p_param_39, x_SQL);&#10;        do_bind_parameter(38, p_param_38, x_SQL);&#10;        do_bind_parameter(37, p_param_37, x_SQL);&#10;        do_bind_parameter(36, p_param_36, x_SQL);&#10;        do_bind_parameter(35, p_param_35, x_SQL);&#10;        do_bind_parameter(34, p_param_34, x_SQL);&#10;        do_bind_parameter(33, p_param_33, x_SQL);&#10;        do_bind_parameter(32, p_param_32, x_SQL);&#10;        do_bind_parameter(31, p_param_31, x_SQL);&#10;        do_bind_parameter(30, p_param_30, x_SQL);&#10;        --&#10;        do_bind_parameter(29, p_param_29, x_SQL);&#10;        do_bind_parameter(28, p_param_28, x_SQL);&#10;        do_bind_parameter(27, p_param_27, x_SQL);&#10;        do_bind_parameter(26, p_param_26, x_SQL);&#10;        do_bind_parameter(25, p_param_25, x_SQL);&#10;        do_bind_parameter(24, p_param_24, x_SQL);&#10;        do_bind_parameter(23, p_param_23, x_SQL);&#10;        do_bind_parameter(22, p_param_22, x_SQL);&#10;        do_bind_parameter(21, p_param_21, x_SQL);&#10;        do_bind_parameter(20, p_param_20, x_SQL);&#10;        --&#10;        do_bind_parameter(19, p_param_19, x_SQL);&#10;        do_bind_parameter(18, p_param_18, x_SQL);&#10;        do_bind_parameter(17, p_param_17, x_SQL);&#10;        do_bind_parameter(16, p_param_16, x_SQL);&#10;        do_bind_parameter(15, p_param_15, x_SQL);&#10;        do_bind_parameter(14, p_param_14, x_SQL);&#10;        do_bind_parameter(13, p_param_13, x_SQL);&#10;        do_bind_parameter(12, p_param_12, x_SQL);&#10;        do_bind_parameter(11, p_param_11, x_SQL);&#10;        do_bind_parameter(10, p_param_10, x_SQL);&#10;        --&#10;        do_bind_parameter(9, p_param_9, x_SQL);&#10;        do_bind_parameter(8, p_param_8, x_SQL);&#10;        do_bind_parameter(7, p_param_7, x_SQL);&#10;        do_bind_parameter(6, p_param_6, x_SQL);&#10;        do_bind_parameter(5, p_param_5, x_SQL);&#10;        do_bind_parameter(4, p_param_4, x_SQL);&#10;        do_bind_parameter(3, p_param_3, x_SQL);&#10;        do_bind_parameter(2, p_param_2, x_SQL);&#10;        do_bind_parameter(1, p_param_1, x_SQL);&#10;        --&#10;    END IF;&#10;END do_bind_params_sql;&#10;--&#10;PROCEDURE exec_sql(&#10;    p_sql VARCHAR2, p_ignore_err_flag VARCHAR2 DEFAULT &#39;N&#39;, p_print_SQL VARCHAR2 DEFAULT &#39;N&#39;,&#10;    p_param_1  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_2 VARCHAR2 DEFAULT &#39;NO_VALUE&#39; , p_param_3  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_4  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_5  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_6  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_7  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_8  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_9  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_10 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_11 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_12 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_13 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_14 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_15 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_16 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_17 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_18 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_19 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_20 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_21 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_22 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_23 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_24 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_25 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_26 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_27 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_28 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_29 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_30 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_31 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_32 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_33 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_34 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_35 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_36 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_37 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_38 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_39 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_40 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_41 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_42 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_43 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_44 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_45 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_46 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_47 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_48 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_49 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_50 VARCHAR2 DEFAULT &#39;NO_VALUE&#39; )&#10;IS&#10;BEGIN&#10;    g_bind_cnt :&#61; 0;&#10;    IF nvlstr(p_print_SQL, &#39;Y&#39;) &#61; &#39;Y&#39; THEN&#10;        do_print_sql(&#10;            p_sql, &#39;Y&#39;, 5,&#10;            --&#10;            p_param_1 , p_param_2 , p_param_3 , p_param_4 , p_param_5,&#10;            p_param_6 , p_param_7 , p_param_8 , p_param_9 , p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15,&#10;            p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25,&#10;            p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32, p_param_33, p_param_34, p_param_35,&#10;            p_param_36, p_param_37, p_param_38, p_param_39, p_param_40,&#10;            p_param_41, p_param_42, p_param_43, p_param_44, p_param_45,&#10;            p_param_46, p_param_47, p_param_48, p_param_49, p_param_50 );&#10;    END IF;&#10;    IF p_param_1 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql;&#10;    ELSIF p_param_2 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING p_param_1;&#10;    ELSIF p_param_3 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING p_param_1, p_param_2;&#10;    ELSIF p_param_4 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING p_param_1, p_param_2, p_param_3;&#10;    ELSIF p_param_5 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING p_param_1, p_param_2, p_param_3, p_param_4;&#10;    ELSIF p_param_6 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING p_param_1, p_param_2, p_param_3, p_param_4, p_param_5;&#10;    ELSIF p_param_7 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6;&#10;    ELSIF p_param_8 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7;&#10;    ELSIF p_param_9 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8;&#10;    ELSIF p_param_10 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9;&#10;    ELSIF p_param_11 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10;&#10;    ELSIF p_param_12 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11;&#10;    ELSIF p_param_13 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12;&#10;    ELSIF p_param_14 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13;&#10;    ELSIF p_param_15 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14;&#10;    ELSIF p_param_16 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15;&#10;    ELSIF p_param_17 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16;&#10;    ELSIF p_param_18 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17;&#10;    ELSIF p_param_19 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18;&#10;    ELSIF p_param_20 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19;&#10;    ELSIF p_param_21 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20;&#10;    ELSIF p_param_22 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21;&#10;    ELSIF p_param_23 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22;&#10;    ELSIF p_param_24 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23;&#10;    ELSIF p_param_25 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24;&#10;    ELSIF p_param_26 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25;&#10;    ELSIF p_param_27 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26;&#10;    ELSIF p_param_28 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27;&#10;    ELSIF p_param_29 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28;&#10;    ELSIF p_param_30 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29;&#10;    ELSIF p_param_31 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30;&#10;    ELSIF p_param_32 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31;&#10;    ELSIF p_param_33 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32;&#10;    ELSIF p_param_34 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32, p_param_33;&#10;    ELSIF p_param_35 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32, p_param_33, p_param_34;&#10;    ELSIF p_param_36 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32, p_param_33, p_param_34, p_param_35;&#10;    ELSIF p_param_37 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32, p_param_33, p_param_34, p_param_35, p_param_36;&#10;    ELSIF p_param_38 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32, p_param_33, p_param_34, p_param_35, p_param_36, p_param_37;&#10;    ELSIF p_param_39 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32, p_param_33, p_param_34, p_param_35, p_param_36, p_param_37, p_param_38;&#10;    ELSIF p_param_40 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32, p_param_33, p_param_34, p_param_35, p_param_36, p_param_37, p_param_38, p_param_39;&#10;    ELSIF p_param_41 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32, p_param_33, p_param_34, p_param_35, p_param_36, p_param_37, p_param_38, p_param_39, p_param_40;&#10;    ELSIF p_param_42 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32, p_param_33, p_param_34, p_param_35, p_param_36, p_param_37, p_param_38, p_param_39, p_param_40,&#10;            p_param_41;&#10;    ELSIF p_param_43 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32, p_param_33, p_param_34, p_param_35, p_param_36, p_param_37, p_param_38, p_param_39, p_param_40,&#10;            p_param_41, p_param_42;&#10;    ELSIF p_param_44 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32, p_param_33, p_param_34, p_param_35, p_param_36, p_param_37, p_param_38, p_param_39, p_param_40,&#10;            p_param_41, p_param_42, p_param_43;&#10;    ELSIF p_param_45 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32, p_param_33, p_param_34, p_param_35, p_param_36, p_param_37, p_param_38, p_param_39, p_param_40,&#10;            p_param_41, p_param_42, p_param_43, p_param_44;&#10;    ELSIF p_param_46 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32, p_param_33, p_param_34, p_param_35, p_param_36, p_param_37, p_param_38, p_param_39, p_param_40,&#10;            p_param_41, p_param_42, p_param_43, p_param_44, p_param_45;&#10;    ELSIF p_param_47 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32, p_param_33, p_param_34, p_param_35, p_param_36, p_param_37, p_param_38, p_param_39, p_param_40,&#10;            p_param_41, p_param_42, p_param_43, p_param_44, p_param_45, p_param_46;&#10;    ELSIF p_param_48 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32, p_param_33, p_param_34, p_param_35, p_param_36, p_param_37, p_param_38, p_param_39, p_param_40,&#10;            p_param_41, p_param_42, p_param_43, p_param_44, p_param_45, p_param_46, p_param_47;&#10;    ELSIF p_param_49 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32, p_param_33, p_param_34, p_param_35, p_param_36, p_param_37, p_param_38, p_param_39, p_param_40,&#10;            p_param_41, p_param_42, p_param_43, p_param_44, p_param_45, p_param_46, p_param_47, p_param_48;&#10;    ELSIF p_param_50 &#61; &#39;NO_VALUE&#39; THEN&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32, p_param_33, p_param_34, p_param_35, p_param_36, p_param_37, p_param_38, p_param_39, p_param_40,&#10;            p_param_41, p_param_42, p_param_43, p_param_44, p_param_45, p_param_46, p_param_47, p_param_48, p_param_49;&#10;    ELSE&#10;        EXECUTE IMMEDIATE p_sql USING&#10;            p_param_1, p_param_2, p_param_3, p_param_4, p_param_5, p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;            p_param_11, p_param_12, p_param_13, p_param_14, p_param_15, p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;            p_param_21, p_param_22, p_param_23, p_param_24, p_param_25, p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;            p_param_31, p_param_32, p_param_33, p_param_34, p_param_35, p_param_36, p_param_37, p_param_38, p_param_39, p_param_40,&#10;            p_param_41, p_param_42, p_param_43, p_param_44, p_param_45, p_param_46, p_param_47, p_param_48, p_param_49, p_param_50;&#10;    END IF;&#10;EXCEPTION WHEN OTHERS THEN&#10;    IF nvlstr(p_ignore_err_flag, &#39;N&#39;) &#61; &#39;Y&#39; THEN&#10;        message(&#39;WARNING: exec_sql ERROR: &#39; || SQLERRM, 1);&#10;    ELSE&#10;        message(&#39;FAILED: exec_sql ERROR: &#39; || SQLERRM, 1);&#10;        --RAISE;&#10;        raise_error(&#10;            &#39;FAILED: &#39; ||&#10;            &#39;[err&#61;&#39;  || SQLERRM   || &#39;]&#39; || CHR(10) ||&#10;            &#39;[&#39;      || p_SQL     || &#39;]&#39; || CHR(10) ||&#10;            &#39;[par1&#61;&#39; || p_param_1 || &#39;]&#39; ||&#10;            &#39;[par2&#61;&#39; || p_param_2 || &#39;]&#39; ||&#10;            &#39;[par3&#61;&#39; || p_param_3 || &#39;]&#39; ||&#10;            &#39;[par4&#61;&#39; || p_param_4 || &#39;]&#39; ||&#10;            &#39;[par5&#61;&#39; || p_param_5 || &#39;]&#39; ||&#10;            &#39;[par6&#61;&#39; || p_param_6 || &#39;]&#39; ||&#10;            &#39;[par7&#61;&#39; || p_param_7 || &#39;]&#39; ||&#10;            &#39;[par8&#61;&#39; || p_param_8 || &#39;]&#39;,&#10;            &#39;EXEC_SQL&#39; );&#10;    END IF;&#10;END exec_sql;&#10;--&#10;PROCEDURE exec_sql_atnm(&#10;    p_sql VARCHAR2, p_ignore_err_flag VARCHAR2 DEFAULT &#39;N&#39;, p_print_SQL VARCHAR2 DEFAULT &#39;N&#39;,&#10;    p_param_1  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_2 VARCHAR2 DEFAULT &#39;NO_VALUE&#39; , p_param_3  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_4  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_5  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_6  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_7  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_8  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_9  VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_10 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_11 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_12 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_13 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_14 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_15 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_16 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_17 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_18 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_19 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_20 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_21 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_22 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_23 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_24 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_25 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_26 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_27 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_28 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_29 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_30 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_31 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_32 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_33 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_34 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_35 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_36 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_37 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_38 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_39 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_40 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_41 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_42 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_43 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_44 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_45 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    p_param_46 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_47 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_48 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_49 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;, p_param_50 VARCHAR2 DEFAULT &#39;NO_VALUE&#39;,&#10;    --&#10;    p_remote_ctx_flag VARCHAR2 DEFAULT &#39;N&#39; )&#10;IS&#10;    PRAGMA AUTONOMOUS_TRANSACTION;&#10;BEGIN&#10;    g_label :&#61; &#39;10000&#39;;&#10;    --&#10;    exec_SQL(&#10;        p_sql, p_ignore_err_flag, p_print_SQL,&#10;        p_param_1, p_param_2, p_param_3, p_param_4, p_param_5,&#10;        p_param_6, p_param_7, p_param_8, p_param_9, p_param_10,&#10;        p_param_11, p_param_12, p_param_13, p_param_14, p_param_15,&#10;        p_param_16, p_param_17, p_param_18, p_param_19, p_param_20,&#10;        p_param_21, p_param_22, p_param_23, p_param_24, p_param_25,&#10;        p_param_26, p_param_27, p_param_28, p_param_29, p_param_30,&#10;        p_param_31, p_param_32, p_param_33, p_param_34, p_param_35,&#10;        p_param_36, p_param_37, p_param_38, p_param_39, p_param_40,&#10;        p_param_41, p_param_42, p_param_43, p_param_44, p_param_45,&#10;        p_param_46, p_param_47, p_param_48, p_param_49, p_param_50 );&#10;    --&#10;    COMMIT;&#10;    --&#10;END exec_sql_atnm;&#10;--&#10;PROCEDURE exec_ddl(p_sql CLOB, p_ignore_err_flag VARCHAR2 DEFAULT &#39;N&#39;, p_print_SQL VARCHAR2 DEFAULT &#39;N&#39;)&#10;IS&#10;BEGIN&#10;    IF nvlstr(p_print_SQL, &#39;Y&#39;) &#61; &#39;Y&#39; THEN&#10;        do_print_sql( p_sql, &#39;N&#39;, 5 );&#10;    END IF;&#10;    EXECUTE IMMEDIATE p_sql;&#10;EXCEPTION WHEN OTHERS THEN&#10;    IF nvlstr(p_ignore_err_flag, &#39;N&#39;) &#61; &#39;Y&#39; THEN&#10;        message(&#39;WARNING: exec_sql ERROR: &#39; || SQLERRM, 1);&#10;    ELSE&#10;        message(&#39;FAILED: exec_sql ERROR: &#39; || SQLERRM, 1);&#10;        --RAISE;&#10;        raise_error(&#10;            PKG_LstUtl.concat(&#10;                &#39;FAILED: [err&#61;&#39;  || SQLERRM || &#39;]&#39;,&#10;                &#39;[&#39; || SUBSTR(p_SQL, 1, 32000) || &#39;]&#39;,&#10;                p_delim&#61;&gt;CHR(10) ),&#10;            &#39;EXEC_SQL&#39; );&#10;    END IF;&#10;END exec_ddl;&#10;--&#10;--&#10;--&#10;--&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;--&#10;--&#10;-- NDelius Offender Tables Hierarchy helper subroutines&#10;--&#10;--&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;&#61;--&#10;--&#10;--&#10;FUNCTION get_xml_view_name(p_xml_message_id NUMBER, p_use_new_name VARCHAR2 DEFAULT &#39;N&#39;) RETURN VARCHAR2&#10;IS&#10;    --&#10;    l_view_name VARCHAR2(100);&#10;    --&#10;BEGIN&#10;    --&#10;    IF p_xml_message_id &gt; 0 THEN&#10;        --&#10;        l_view_name :&#61; &#39;XML&#39; || SPGMESSAGE.GC_SCHEMA_NUMBER || &#39;_MSG_&#39; || TO_CHAR(p_xml_message_id) || &#39;_V&#39;;&#10;        --&#10;        IF p_use_new_name &#61; &#39;Y&#39; THEN&#10;            SELECT&#10;              DECODE( l_view_name,&#10;                  &#39;XML1_MSG_1001_V&#39;, &#39;PRF_APPROVED_PREMISES_REFERRAL_V&#39;,&#10;                  &#39;XML1_MSG_1002_V&#39;, &#39;PRF_APPROVED_PREMISES_RESIDENCE_V&#39;,&#10;                  &#39;XML1_MSG_1003_V&#39;, &#39;PRF_OFFENDER_DETAILS_V&#39;,&#10;                  &#39;XML1_MSG_1004_V&#39;, &#39;PRF_CONTACT_V&#39;,&#10;                  &#39;XML1_MSG_1005_V&#39;, &#39;PRF_COURT_APPEARANCE_V&#39;,&#10;                  &#39;XML1_MSG_1006_V&#39;, &#39;PRF_COURT_REPORT_V&#39;,&#10;                  &#39;XML1_MSG_1007_V&#39;, &#39;PRF_PROPOSED_REQUIREMENT_V&#39;,&#10;                  &#39;XML1_MSG_1008_V&#39;, &#39;PRF_EVENT_V&#39;,&#10;                  &#39;XML1_MSG_1009_V&#39;, &#39;PRF_COHORT_V&#39;,&#10;                  &#39;XML1_MSG_1010_V&#39;, &#39;PRF_ALIAS_V&#39;,&#10;                  &#39;XML1_MSG_1011_V&#39;, &#39;PRF_OFFENDER_ADDRESS_V&#39;,&#10;                  &#39;XML1_MSG_1012_V&#39;, &#39;PRF_ADDRESS_ASSESSMENT_V&#39;,&#10;                  &#39;XML1_MSG_1013_V&#39;, &#39;PRF_OFFENDER_DISABILITY_V&#39;,&#10;                  &#39;XML1_MSG_1014_V&#39;, &#39;PRF_PROVISION_V&#39;,&#10;                  &#39;XML1_MSG_1015_V&#39;, &#39;PRF_PERSONAL_CONTACT_V&#39;,&#10;                  &#39;XML1_MSG_1016_V&#39;, &#39;PRF_PERSONAL_CIRCUMSTANCE_V&#39;,&#10;                  &#39;XML1_MSG_1017_V&#39;, &#39;PRF_INSTITUTIONAL_REPORT_V&#39;,&#10;                  &#39;XML1_MSG_1018_V&#39;, &#39;PRF_REGISTRATION_V&#39;,&#10;                  &#39;XML1_MSG_1019_V&#39;, &#39;PRF_REGISTRATION_REVIEW_V&#39;,&#10;                  &#39;XML1_MSG_1020_V&#39;, &#39;PRF_COMMUNITY_REQUIREMENT_V&#39;,&#10;                  &#39;XML1_MSG_1021_V&#39;, &#39;PRF_LIC_CONDITION_V&#39;,&#10;                  &#39;XML1_MSG_1022_V&#39;, &#39;PRF_PSS_REQUIREMENT_V&#39;,&#10;                  &#39;XML1_MSG_1023_V&#39;, &#39;PRF_CUSTODY_LOCATION_V&#39;,&#10;                  &#39;XML1_MSG_1024_V&#39;, &#39;PRF_CUSTODY_KEY_DATE_V&#39;,&#10;                  &#39;XML1_MSG_1025_V&#39;, &#39;PRF_ADDITIONAL_OFFENCE_V&#39;,&#10;                  &#39;XML1_MSG_1026_V&#39;, &#39;PRF_OFFENDER_ADDITIONAL_SENTENCE_V&#39;,&#10;                  &#39;XML1_MSG_1027_V&#39;, &#39;PRF_REFERRAL_V&#39;,&#10;                  &#39;XML1_MSG_1028_V&#39;, &#39;PRF_ASSESSMENT_V&#39;,&#10;                  &#39;XML1_MSG_1029_V&#39;, &#39;PRF_DRUGS_TEST_V&#39;,&#10;                  &#39;XML1_MSG_1030_V&#39;, &#39;PRF_UPW_ADJUSTMENT_V&#39;,&#10;                  &#39;XML1_MSG_1031_V&#39;, &#39;PRF_UPW_APPOINTMENT_V&#39;,&#10;                  &#39;XML1_MSG_1032_V&#39;, &#39;PRF_UPW_DETAILS_V&#39;,&#10;                  &#39;XML1_MSG_1047_V&#39;, &#39;PRF_ADDITIONAL_IDENTIFIER_V&#39;,&#10;                  &#39;XML1_MSG_1048_V&#39;, &#39;PRF_PROCESS_CONTACT_V&#39;,&#10;                  &#39;XML1_MSG_1049_V&#39;, &#39;PRF_OFFENDER_MANAGER_V&#39;,&#10;                  &#39;XML1_MSG_1050_V&#39;, &#39;PRF_ORDER_MANAGER_V&#39;,&#10;                  &#39;XML1_MSG_1051_V&#39;, &#39;PRF_RELEASE_V&#39;,&#10;                  &#39;XML1_MSG_1052_V&#39;, &#39;PRF_RECALL_V&#39;,&#10;                  &#39;XML1_MSG_1053_V&#39;, &#39;PRF_PSS_CONTACT_V&#39;,&#10;                  &#39;XML1_MSG_1054_V&#39;, &#39;PRF_ALLOCATE_PROCESS_V&#39;,&#10;                  &#39;XML1_MSG_1055_V&#39;, &#39;PRF_RATE_CARD_INTERVENTION_V&#39;,&#10;                  &#39;XML1_MSG_1059_V&#39;, &#39;PRF_DRUG_TEST_RESULT_V&#39;,&#10;                  &#39;XML1_MSG_1060_V&#39;, &#39;PRF_PROVIDER_LAO_DETAILS_V&#39;,&#10;                  &#39;XML1_MSG_1061_V&#39;, &#39;PRF_NAT_OFFENDER_ALERT_V&#39;,&#10;                  &#39;XML1_MSG_1062_V&#39;, &#39;PRF_RQMNT_MANAGER_V&#39;,&#10;                  &#39;XML1_MSG_1063_V&#39;, &#39;PRF_LIC_COND_MANAGER_V&#39;,&#10;                  &#39;XML1_MSG_1064_V&#39;, &#39;PRF_PSS_RQMNT_MANAGER_V&#39;,&#10;                  &#39;XML1_MSG_1065_V&#39;, &#39;PRF_DOCUMENT_LIST_HDR_V&#39;,&#10;                  &#39;XML1_MSG_1066_V&#39;, &#39;PRF_DOCUMENT_DETAIL_V&#39;,&#10;                  &#39;XML1_MSG_2121_V&#39;, &#39;PRF_OM_TRANSFER_REQUEST_V&#39;,&#10;                  &#39;XML1_MSG_2122_V&#39;, &#39;PRF_OS_TRANSFER_REQUEST_V&#39;,&#10;                  &#39;XML1_MSG_2123_V&#39;, &#39;PRF_RQ_TRANSFER_REQUEST_V&#39;,&#10;                  &#39;XML1_MSG_2124_V&#39;, &#39;PRF_LC_TRANSFER_REQUEST_V&#39;,&#10;                  &#39;XML1_MSG_2125_V&#39;, &#39;PRF_PSS_TRANSFER_REQUEST_V&#39;,&#10;                  &#39;XML1_MSG_2126_V&#39;, &#39;PRF_NSI_TRANSFER_REQUEST_V&#39;,&#10;                  &#39;XML1_MSG_2127_V&#39;, &#39;PRF_CR_TRANSFER_REQUEST_V&#39;,&#10;                  &#39;XML1_MSG_2128_V&#39;, &#39;PRF_IR_TRANSFER_REQUEST_V&#39;,&#10;                  --&#10;                  l_view_name )&#10;            INTO l_view_name&#10;            FROM dual;&#10;            --&#10;        END IF;&#10;        --&#10;    ELSE&#10;        l_view_name :&#61; NULL;&#10;    END IF;&#10;    --&#10;    RETURN l_view_name;&#10;    --&#10;END get_xml_view_name;&#10;--&#10;FUNCTION get_xml_view_name(p_xml_message_id NUMBER, p_xsd_number NUMBER, p_use_new_name VARCHAR2 DEFAULT &#39;N&#39;) RETURN VARCHAR2 IS&#10;BEGIN&#10;    RETURN&#10;        REPLACE(&#10;            get_xml_view_name(p_xml_message_id, p_use_new_name),&#10;            &#39;XML1_MSG_&#39;,&#10;            &#39;XML&#39; || TO_CHAR(p_xsd_number) || &#39;_MSG_&#39; );&#10;END get_xml_view_name;&#10;--&#10;FUNCTION get_xml_view_name(p_xml_message_id NUMBER, p_probation_area_id NUMBER, p_use_new_name VARCHAR2 DEFAULT &#39;N&#39;) RETURN VARCHAR2&#10;IS&#10;    --&#10;    l_xsd_number  SPG_xsd.xsd_number%TYPE;&#10;    --&#10;BEGIN&#10;    --&#10;    l_xsd_number :&#61; SPGCONFIG.get_xsd_number(p_probation_area_id &#61;&gt; p_probation_area_id, p_bi_code &#61;&gt; NULL);&#10;    --&#10;    RETURN get_xml_view_name(p_xml_message_id&#61;&gt;p_xml_message_id, p_xsd_number&#61;&gt;l_xsd_number, p_use_new_name&#61;&gt;p_use_new_name);&#10;    --&#10;END get_xml_view_name;&#10;--&#10;FUNCTION get_xml_message_id(p_view_name VARCHAR2) RETURN NUMBER IS&#10;BEGIN&#10;    IF EMPTY2NULL(p_view_name) IS NOT NULL THEN&#10;        --RETURN TO_NUMBER(RTRIM(LTRIM(p_view_name, &#39;XML_MSG_&#39;), &#39;_V&#39;));&#10;        RETURN TO_NUMBER(REGEXP_SUBSTR (p_view_name, &#39;(\d)(\d)(\d)(\d)&#39;));&#10;    ELSE&#10;        RETURN NULL;&#10;    END IF;&#10;END get_xml_message_id;&#10;--&#10;FUNCTION get_xsd_number(p_view_name VARCHAR2) RETURN NUMBER&#10;IS&#10;BEGIN&#10;    IF EMPTY2NULL(p_view_name) IS NOT NULL THEN&#10;        --RETURN TO_NUMBER(RTRIM(LTRIM(p_view_name, &#39;XML_MSG_&#39;), &#39;_V&#39;));&#10;        RETURN TO_NUMBER(REGEXP_SUBSTR (p_view_name, &#39;(\d)&#39;));&#10;    ELSE&#10;        RETURN NULL;&#10;    END IF;&#10;END get_xsd_number;&#10;--&#10;FUNCTION get_tab_child_tables_priv(p_table VARCHAR2, p_table_type VARCHAR2 DEFAULT &#39;O&#39;) RETURN t_hier_tab_TYP&#10;RESULT_CACHE&#10;IS&#10;    CURSOR csTabOH IS&#10;      SELECT /* RESULT_CACHE */ DISTINCT&#10;        T.parent_table,&#10;        T.table_name,&#10;        T.table_type,&#10;        T.order_by,&#10;        T.hier_level,&#10;        T.hier_order_by,&#10;        T.pk_col_name,&#10;        T.fk_col_name,&#10;        T.not_null_col_name,&#10;        T.from_clause,&#10;        T.where_clause,&#10;        T.where_clause1&#10;        -- crcD specific&#10;        --T.vpd_broad_flag,&#10;        --T.local_flag&#10;      FROM  TABLE( PKG_DynSQL.get_tab_list ) T&#10;      WHERE table_type &#61; NVL(PKG_Common.empty2null(p_table_type), &#39;O&#39;)&#10;        AND table_name NOT IN ( &#39;CASELOAD&#39;, &#39;COHORT_DIARY&#39;, &#39;CONTACT_ALERT&#39;, &#39;REJECTED_TRANSFER_DIARY&#39;, &#39;ORGANISATION_OFFENDER&#39; )&#10;        AND NOT ( parent_table &#61; &#39;CONTACT&#39; AND table_name &#61; &#39;CONTACT&#39; )&#10;        --&#10;        AND parent_table &#61; p_table&#10;    ORDER BY T.hier_order_by;&#10;    --&#10;    l_rec1 trecTablesHierarchy;&#10;    --&#10;    l_rec t_hier_rec_TYP;&#10;    l_tab t_hier_tab_TYP :&#61; t_hier_tab_TYP();&#10;    --&#10;BEGIN&#10;    --IF NOT g_TAB_HIER_FLAG THEN&#10;        OPEN csTabOH;&#10;        FETCH csTabOH BULK COLLECT INTO l_tab;&#10;        CLOSE csTabOH;&#10;    /*ELSE&#10;        --&#10;        --raise_application_error(-20001, &#39;g_TAB_HIER&#61;&#39; || g_TAB_HIER.COUNT);&#10;        --&#10;        FOR l_i IN 1 .. g_TAB_HIER.COUNT LOOP&#10;            --&#10;            l_rec1 :&#61; g_TAB_HIER(l_i);&#10;            --&#10;            IF ( l_rec1.parent_table &#61; p_table ) AND&#10;               ( l_rec1.table_type &#61; NVL(PKG_Common.empty2null(p_table_type), &#39;O&#39;) ) AND&#10;               ( l_rec1.table_name NOT IN ( &#39;CASELOAD&#39;, &#39;COHORT_DIARY&#39;, &#39;CONTACT_ALERT&#39;, &#39;REJECTED_TRANSFER_DIARY&#39;, &#39;ORGANISATION_OFFENDER&#39; ) ) AND&#10;               ( NOT ( l_rec1.parent_table &#61; &#39;CONTACT&#39; AND l_rec1.table_name &#61; &#39;CONTACT&#39; ) )&#10;            THEN&#10;                l_rec.parent_table      :&#61; l_rec1.parent_table;&#10;                l_rec.table_name        :&#61; l_rec1.table_name;&#10;                l_rec.table_type        :&#61; l_rec1.table_type;&#10;                l_rec.order_by          :&#61; l_rec1.order_by;&#10;                l_rec.hier_level        :&#61; l_rec1.hier_level;&#10;                l_rec.hier_order_by     :&#61; l_rec1.hier_order_by;&#10;                l_rec.pk_col_name       :&#61; l_rec1.pk_col_name;&#10;                l_rec.fk_col_name       :&#61; l_rec1.fk_col_name;&#10;                l_rec.not_null_col_name :&#61; l_rec1.not_null_col_name;&#10;                l_rec.from_clause       :&#61; l_rec1.from_clause;&#10;                l_rec.where_clause      :&#61; l_rec1.where_clause;&#10;                l_rec.where_clause1     :&#61; l_rec1.where_clause1;&#10;                -- crcDelius specific&#10;                --vpd_broad_flag    VARCHAR2(1),&#10;                --local_flag        VARCHAR2(1)&#10;                --&#10;                l_tab.EXTEND;&#10;                l_tab(l_tab.COUNT) :&#61; l_rec;&#10;                --&#10;            END IF;&#10;            --&#10;        END LOOP;&#10;        --&#10;    END IF;*/&#10;    --&#10;    RETURN l_tab;&#10;END get_tab_child_tables_priv;&#10;--&#10;-- FORWARD Declaration&#10;/*PROCEDURE init_tab_info_PRIV(p_table_name VARCHAR2 DEFAULT NULL, p_force_flag VARCHAR2 DEFAULT &#39;N&#39;);&#10;--&#10;FUNCTION get_tab_info_encoded(p_global_cache_flag VARCHAR2 DEFAULT &#39;N&#39;) RETURN VARCHAR2&#10;  RESULT_CACHE&#10;  RELIES_ON (BUSINESS_INTERACTION,BUSINESS_INT_XML_MAP,BUSINESS_INT_XML_SUMMARY,BUSINESS_INT_XML_DETAIL)&#10;IS&#10;    l_ret VARCHAR2(32767);&#10;BEGIN&#10;    IF p_global_cache_flag &#61; &#39;Y&#39; THEN&#10;        IF PKG_Global.GC_PG_MEMCACHE_FLAG &#61; &#39;Y&#39; THEN&#10;            --l_ret :&#61; PKG_Mem_Cache_get_item(&#39;DYN_SQL_TAB_INFO&#39;);&#10;            init_tab_info_PRIV(p_force_flag&#61;&gt;&#39;Y&#39;);&#10;            --&#10;            IF DBMS_LOB.GETLENGTH(g_tab_info_CLOB) &gt; lc_max_vchar_size THEN&#10;                procDebug(&#39;ERROR in GET_TAB_INFO_ENCODED: xSQL string length (&#39; || DBMS_LOB.GETLENGTH(g_tab_info_CLOB) || &#39;) has exceeded maximum of &#39; || lc_max_vchar_size || &#39;characters&#39;);&#10;                RAISE VARCHAR_IS_TOO_BIG;&#10;            END IF;&#10;            --&#10;            l_ret :&#61; g_tab_info_CLOB;&#10;        ELSE&#10;            l_ret :&#61; NULL;&#10;        END IF;&#10;    ELSE&#10;        --&#10;        IF DBMS_LOB.GETLENGTH(g_tab_info_CLOB) &gt; lc_max_vchar_size THEN&#10;            procDebug(&#39;ERROR in GET_TAB_INFO_ENCODED: xSQL string length (&#39; || DBMS_LOB.GETLENGTH(g_tab_info_CLOB) || &#39;) has exceeded maximum of &#39; || lc_max_vchar_size || &#39;characters&#39;);&#10;            RAISE VARCHAR_IS_TOO_BIG;&#10;        END IF;&#10;        --&#10;        l_ret :&#61; g_tab_info_CLOB;&#10;    END IF;&#10;    --&#10;    RETURN l_ret;&#10;END get_tab_info_encoded;&#10;--&#10;PROCEDURE set_tab_info_encoded&#10;IS&#10;    --&#10;    l_table_name   VARCHAR2(100);&#10;    l_tab_info_REC PKG_DynSQL.TYP_tab_info_REC;&#10;    l_tab_hier     t_hier_tab_TYP;&#10;    l_delim        VARCHAR2(10) :&#61; &#39;@REC@&#39;;&#10;    l_delim1       VARCHAR2(10) :&#61; &#39;@HREC@&#39;;&#10;    --&#10;    l_line CLOB;&#10;BEGIN&#10;    g_tab_info_CLOB :&#61; &#39;&#39;;&#10;    l_table_name :&#61; g_tab_info.FIRST;&#10;    LOOP&#10;        EXIT WHEN empty2null(l_table_name) IS NULL;&#10;        --&#10;        l_tab_info_rec :&#61; g_tab_info(l_table_name);&#10;        --&#10;        l_line :&#61;&#10;            --&#39;Yuri Fedkiv&#39;   || l_delim ||&#10;            l_tab_info_REC.table_name   || l_delim ||&#10;            l_tab_info_REC.table_type   || l_delim ||&#10;            l_tab_info_REC.parent_table || l_delim ||&#10;            l_tab_info_REC.hier_level   || l_delim ||&#10;            l_tab_info_REC.pk_fld_lst   || l_delim ||&#10;            l_tab_info_REC.fk_fld_lst   || l_delim ||&#10;            l_tab_info_REC.fld_lst      || l_delim ||&#10;            l_tab_info_REC.fld_lst_1    || l_delim ||&#10;            --&#10;            &#39;l_tab_info_REC.child_tables&#39; || l_delim;&#10;            -- crcD specific&#10;            --l_tab_info_REC.vpd_broad_flag || l_delim ||&#10;            --l_tab_info_REC.local_flag;&#10;            --&#10;            --l_tab_info_REC.child_tables  :&#61; get_tab_child_tables_priv(crTab.table_name, crTab.table_type);&#10;        --&#10;        g_tab_info_CLOB :&#61; PKG_LstUtl.concat_CLOB(g_tab_info_CLOB, l_line, p_delim &#61;&gt; l_delim || CHR(10));&#10;        --&#10;        l_table_name :&#61; g_tab_info.NEXT(l_table_name);&#10;    END LOOP;&#10;    --&#10;    IF PKG_Global.GC_PG_MEMCACHE_FLAG &#61; &#39;Y&#39; THEN&#10;        PKG_Mem_Cache.set_item(&#10;            p_key           &#61;&gt; &#39;DYN_SQL_TAB_INFO&#39;,&#10;            p_val           &#61;&gt; g_tab_info_CLOB,&#10;            p_relied_on_lst &#61;&gt; &#39;BUSINESS_INTERACTION,BUSINESS_INT_XML_MAP,BUSINESS_INT_XML_SUMMARY,BUSINESS_INT_XML_DETAIL&#39; );&#10;    END IF;&#10;    --&#10;END set_tab_info_encoded;&#10;--&#10;PROCEDURE set_tab_info_decoded(p_tab_info_CLOB CLOB)&#10;IS&#10;    --&#10;    l_table_name    VARCHAR2(100);&#10;    l_tab_info_REC  PKG_DynSQL.TYP_tab_info_REC;&#10;    l_tab_hier      t_hier_tab_TYP;&#10;    l_delim         VARCHAR2(10) :&#61; &#39;@REC@&#39;;&#10;    l_delim1        VARCHAR2(10) :&#61; &#39;@HREC@&#39;;&#10;    --&#10;    l_tab_info_clob VARCHAR2(32767);&#10;    l_line          CLOB;&#10;    l_line1         CLOB;&#10;BEGIN&#10;    l_tab_info_CLOB :&#61; p_tab_info_CLOB;&#10;    l_table_name :&#61; g_tab_info.FIRST;&#10;    LOOP&#10;        l_line :&#61; PKG_LstUtl.list_next_elem(l_tab_info_CLOB, l_delim || CHR(10));&#10;        EXIT WHEN empty2null(l_line) IS NULL AND empty2null(l_tab_info_CLOB) IS NULL;&#10;        --&#10;        l_tab_info_rec :&#61; NULL;&#10;        --&#10;        l_tab_info_REC.table_name   :&#61; PKG_LstUtl.list_next_elem(l_line, l_delim);&#10;        l_tab_info_REC.table_type   :&#61; PKG_LstUtl.list_next_elem(l_line, l_delim);&#10;        l_tab_info_REC.parent_table :&#61; PKG_LstUtl.list_next_elem(l_line, l_delim);&#10;        l_tab_info_REC.hier_level   :&#61; PKG_LstUtl.list_next_elem(l_line, l_delim);&#10;        l_tab_info_REC.pk_fld_lst   :&#61; PKG_LstUtl.list_next_elem(l_line, l_delim);&#10;        l_tab_info_REC.fk_fld_lst   :&#61; PKG_LstUtl.list_next_elem(l_line, l_delim);&#10;        l_tab_info_REC.fld_lst      :&#61; PKG_LstUtl.list_next_elem(l_line, l_delim);&#10;        l_tab_info_REC.fld_lst_1    :&#61; PKG_LstUtl.list_next_elem(l_line, l_delim);&#10;        --&#10;        --&#39;l_tab_info_REC.child_tables&#39;;&#10;        l_line1                     :&#61; PKG_LstUtl.list_next_elem(l_line, l_delim);&#10;        l_tab_info_REC.child_tables  :&#61; get_tab_child_tables_priv(l_tab_info_REC.table_name, l_tab_info_REC.table_type);&#10;        -- crcD specific&#10;        --l_tab_info_REC.vpd_broad_flag :&#61; PKG_LstUtl.list_next_elem(l_line, l_delim);&#10;        --l_tab_info_REC.local_flag     :&#61; PKG_LstUtl.list_next_elem(l_line, l_delim);&#10;        --&#10;        g_tab_info(l_tab_info_REC.table_name) :&#61; l_tab_info_REC;&#10;        --&#10;    END LOOP;&#10;    --&#10;EXCEPTION WHEN OTHERS THEN&#10;    raise_error(&#10;        p_err_msg &#61;&gt; &#39;FAILED: &#39; || SQLERRM || CHR(10) || l_line,&#10;        p_proc    &#61;&gt; &#39;PKG_DynSQL.set_tab_info_decoded&#39;,&#10;        p_label   &#61;&gt; g_label );&#10;END set_tab_info_decoded;*/&#10;--&#10;PROCEDURE init_tab_info_PRIV(p_table_name VARCHAR2 DEFAULT NULL, p_force_flag VARCHAR2 DEFAULT &#39;N&#39;)&#10;IS&#10;    --&#10;    PROCEDURE do_populate_tab1&#10;    IS&#10;        --&#10;        CURSOR csTab IS&#10;          WITH T AS (&#10;            SELECT /*+ RESULT_CACHE */ DISTINCT table_name, parent_table, hier_level, table_type, pk_col_name, fk_col_name--, vpd_broad_flag, local_flag&#10;            FROM TABLE( PKG_DynSQL.get_tab_list )&#10;            WHERE table_type IN ( &#39;O&#39;, &#39;R&#39;, &#39;M&#39; )&#10;          )&#10;          SELECT /*+ RESULT_CACHE */&#10;            T.table_type,&#10;            T.table_name,&#10;            T.parent_table,&#10;            T.hier_level,&#10;            --T.vpd_broad_flag,&#10;            --T.local_flag,&#10;            --&#10;            T.pk_col_name,&#10;            T.fk_col_name,&#10;            --&#10;            &#39;&#39; AS PK_fld_lst,&#10;            --&#10;            CASE WHEN T.table_type IN ( &#39;M&#39; ) THEN  T.fk_col_name ELSE NULL END FK_fld_lst,&#10;            --&#10;            &#39;&#39; AS fld_lst,&#10;            &#39;&#39; AS fld_lst_1&#10;            --&#10;          FROM T&#10;          ORDER BY T.table_name;&#10;        --&#10;        TYPE l_rec_TYP IS RECORD(&#10;          table_type    VARCHAR2(1),&#10;          table_name    VARCHAR2(30),&#10;          parent_table  VARCHAR2(30),&#10;          hier_level    NUMBER,&#10;          -- crcD specific&#10;          --vpd_broad_flag VARCHAR2(1),&#10;          --local_flag     VARCHAR2(1),&#10;          pk_col_name   VARCHAR2(200),&#10;          fk_col_name   VARCHAR2(200),&#10;          PK_fld_lst    VARCHAR2(4000),&#10;          FK_fld_lst    VARCHAR2(4000),&#10;          fld_lst       VARCHAR2(4000),&#10;          fld_lst_1     VARCHAR2(4000)&#10;        );&#10;        TYPE l_tab_TYP IS TABLE OF l_rec_TYP;&#10;        --&#10;        l_rec          l_rec_TYP;&#10;        l_tab          l_tab_TYP;&#10;        --&#10;        l_tab_info_REC PKG_DynSQL.TYP_tab_info_REC;&#10;        l_table_name   VARCHAR2(30);&#10;        --&#10;    BEGIN&#10;        IF EMPTY2NULL(p_table_name) IS NULL THEN&#10;            --&#10;            procDebug(&#39;PKG_DynSQL.init_tab_info_PRIV.do_populate_tab1: (1)&#39;);&#10;            --&#10;            OPEN csTab;&#10;            FETCH csTab BULK COLLECT INTO l_tab;&#10;            CLOSE csTab;&#10;            --&#10;            procDebug(&#39;PKG_DynSQL.init_tab_info_PRIV.do_populate_tab1: (2)&#39;);&#10;            --&#10;            FOR l_idx IN 1..l_tab.COUNT LOOP&#10;                --&#10;                l_rec :&#61; l_tab(l_idx);&#10;                --&#10;                l_tab_info_REC.table_name   :&#61; l_rec.table_name;&#10;                l_tab_info_REC.table_type   :&#61; l_rec.table_type;&#10;                l_tab_info_REC.parent_table :&#61; l_rec.parent_table;&#10;                l_tab_info_REC.hier_level   :&#61; l_rec.hier_level;&#10;                l_tab_info_REC.pk_fld_lst   :&#61; CASE WHEN l_rec.table_type IN ( &#39;M&#39; )&#10;                                                   THEN l_rec.pk_col_name&#10;                                                   ELSE PKG_Lookups.funcGetTabPkFields(p_table_name&#61;&gt;l_rec.table_name, p_delim&#61;&gt;&#39;,&#39; )&#10;                                               END;&#10;                l_tab_info_REC.fk_fld_lst   :&#61; l_rec.fk_fld_lst;&#10;                l_tab_info_REC.fld_lst      :&#61; CASE WHEN l_rec.table_type IN ( &#39;M&#39; ) THEN&#10;                                                    -- Will be used to construct the SQL SELECT&#10;                                                    PKG_Lookups.funcgetTabRecord_CACHED(&#10;                                                        p_data_fld  &#61;&gt; &#39;DECODE(SUBSTR(target_table, -1), &#39;&#39;*&#39;&#39;, &#39;&#39;*&#39;&#39;) || UPPER(source_table) || &#39;&#39;.&#39;&#39; || LOWER(source_column) || &#39;&#39; AS &quot;&#39;&#39; || xml_field_name || &#39;&#39;&quot;&#39;&#39;&#39;,&#10;                                                        p_table     &#61;&gt; &#39;business_int_xml_detail&#39;,&#10;                                                        p_ref_col   &#61;&gt; &#39;xml_message_id&#39;,&#10;                                                        p_ref_val   &#61;&gt; TO_CHAR(PKG_DynSQL.get_xml_message_id(l_rec.table_name)),&#10;                                                        p_all_records &#61;&gt; &#39;Y&#39;,&#10;                                                        p_delim       &#61;&gt; &#39;,&#39;,&#10;                                                        p_where       &#61;&gt; &#39;xsd_number &#61; :p_xsd_number&#39;,&#10;                                                        p_bind_var1   &#61;&gt; PKG_DYNSQL.get_xsd_number(l_rec.table_name),&#10;                                                        p_order_by    &#61;&gt; &#39;xml_message_id, xml_field_id&#39; )&#10;                                               ELSE&#10;                                                   PKG_Lookups.funcgetTabRecord_CACHED(&#10;                                                       p_data_fld  &#61;&gt; &#39;column_name&#39;,&#10;                                                       p_table     &#61;&gt; &#39;user_tab_columns&#39;,&#10;                                                       p_ref_col   &#61;&gt; &#39;table_name&#39;,&#10;                                                       p_ref_val   &#61;&gt; l_rec.table_name,&#10;                                                       p_all_records &#61;&gt; &#39;Y&#39;,&#10;                                                       p_delim       &#61;&gt; &#39;,&#39;,&#10;                                                       p_where       &#61;&gt; &#39;column_name NOT IN (&#39;&#39;ROWID&#39;&#39;, &#39;&#39;ROW_ID&#39;&#39;)&#39; )&#10;                                               END;&#10;                l_tab_info_REC.fld_lst_1    :&#61; CASE WHEN l_rec.table_type IN ( &#39;M&#39; ) THEN&#10;                                                    -- Will be used to construct the SQL SELECT&#10;                                                    PKG_Lookups.funcgetTabRecord_CACHED(&#10;                                                        p_data_fld  &#61;&gt; &#39;DECODE(SUBSTR(target_table, -1), &#39;&#39;*&#39;&#39;, &#39;&#39;*&#39;&#39;) || UPPER(source_table) || &#39;&#39;.&#39;&#39; || LOWER(source_column) || &#39;&#39; AS &quot;&#39;&#39; || xml_field_name || &#39;&#39;&quot;&#39;&#39;&#39;,&#10;                                                        p_table     &#61;&gt; &#39;business_int_xml_detail&#39;,&#10;                                                        p_ref_col   &#61;&gt; &#39;xml_message_id&#39;,&#10;                                                        p_ref_val   &#61;&gt; TO_CHAR(PKG_DynSQL.get_xml_message_id(l_rec.table_name)),&#10;                                                        p_all_records &#61;&gt; &#39;Y&#39;,&#10;                                                        p_delim       &#61;&gt; &#39;,&#39;,&#10;                                                        p_where       &#61;&gt; &#39;include_in_delete_flag &#61; &#39;&#39;Y&#39;&#39; AND xsd_number &#61; :p_xsd_number&#39;,&#10;                                                        p_bind_var1   &#61;&gt; PKG_DYNSQL.get_xsd_number(l_rec.table_name),&#10;                                                        p_order_by    &#61;&gt; &#39;xml_message_id, xml_field_id&#39; )&#10;                                               ELSE&#10;                                                   PKG_Lookups.funcgetTabRecord_CACHED(&#10;                                                       p_data_fld  &#61;&gt;&#10;                                                          &#39;CASE&#10;                                                             WHEN column_name IN (&#39;&#39;ORGANISATIONS&#39;&#39;) THEN &#39;&#39;NULL AS &#39;&#39; || column_name&#10;                                                             --WHEN data_type IN (&#39;&#39;BLOB&#39;&#39;) AND nullable &#61; &#39;&#39;N&#39;&#39; THEN &#39;&#39;EMPTY_BLOB() AS &#39;&#39; || column_name&#10;                                                             ELSE column_name&#10;                                                           END&#39;,&#10;                                                       p_table     &#61;&gt; &#39;user_tab_columns&#39;,&#10;                                                       p_ref_col   &#61;&gt; &#39;table_name&#39;,&#10;                                                       p_ref_val   &#61;&gt; l_rec.table_name,&#10;                                                       p_all_records &#61;&gt; &#39;Y&#39;,&#10;                                                       p_delim       &#61;&gt; &#39;,&#39;,&#10;                                                       p_where       &#61;&gt; &#39;column_name NOT IN (&#39;&#39;ROWID&#39;&#39;, &#39;&#39;ROW_ID&#39;&#39;)&#39; )&#10;                                               END;&#10;                --&#10;                --IF l_tab_info_REC.table_name NOT IN ( &#39;CASELOAD&#39;, &#39;COHORT_DIARY&#39;, &#39;CONTACT_ALERT&#39;, &#39;ORGANISATION_OFFENDER&#39;, &#39;CONTACT&#39; ) THEN&#10;                    l_tab_info_REC.child_tables :&#61; get_tab_child_tables_priv(l_rec.table_name, l_rec.table_type);&#10;                --END IF;&#10;                -- crcD specific&#10;                --l_tab_info_REC.vpd_broad_flag :&#61; l_rec.vpd_broad_flag;&#10;                --l_tab_info_REC.local_flag :&#61; l_rec.local_flag;&#10;                --&#10;                g_tab_info(l_rec.table_name) :&#61; l_tab_info_REC;&#10;                --&#10;            END LOOP;&#10;            --&#10;            procDebug(&#39;PKG_DynSQL.init_tab_info_PRIV.do_populate_tab1: (3)&#39;);&#10;            --&#10;            --IF PKG_Global.GC_PG_MEMCACHE_FLAG &#61; &#39;Y&#39; THEN&#10;            --    set_tab_info_encoded;&#10;            --END IF;&#10;            --&#10;        ELSE -- p_table IS NOT NULL&#10;            --&#10;            BEGIN&#10;                l_table_name :&#61; PKG_LstUtl.list_num_tail(UPPER(TRIM(p_table_name)), &#39;.&#39;, 1);&#10;            EXCEPTION WHEN OTHERS THEN&#10;                raise_error(&#10;                    p_err_msg &#61;&gt; &#39;FAILED: (table_name&#61;&#39; || p_table_name || &#39;) -  &#39; || SQLERRM,&#10;                    p_proc    &#61;&gt; &#39;PKG_DynSQL.init_tab_info_PRIV&#39;,&#10;                    p_label   &#61;&gt; g_label );&#10;                --RAISE;&#10;            END;&#10;            IF NOT g_tab_info.EXISTS(l_table_name) THEN&#10;                -- Initialise G_TAB_INFO for the one-off table&#10;                l_tab_info_REC.table_name     :&#61; l_table_name;&#10;                l_tab_info_REC.parent_table   :&#61; &#39;XXX_NOT_AVAILABLE&#39;;&#10;                l_tab_info_REC.pk_fld_lst     :&#61; PKG_Lookups.funcGetTabPkFields(p_table_name &#61;&gt; l_table_name, p_delim &#61;&gt; &#39;,&#39; );&#10;                l_tab_info_REC.fld_lst        :&#61; &#39;XXX_NOT_AVAILABLE&#39;;&#10;                l_tab_info_REC.fld_lst_1      :&#61; &#39;XXX_NOT_AVAILABLE&#39;;&#10;                l_tab_info_REC.child_tables   :&#61; t_hier_tab_TYP();&#10;                --&#10;                g_tab_info(p_table_name) :&#61; l_tab_info_REC;&#10;            END IF;&#10;            --&#10;        END IF;&#10;        --&#10;    END do_populate_tab1;&#10;    --&#10;        BEGIN&#10;        --&#10;    IF empty2null(p_table_name) IS NULL THEN&#10;        --&#10;        IF NOT G_TAB_INFO_INIT_FLAG THEN&#10;            --&#10;            procDebug(&#39;PKG_DynSQL.init_tab_info_PRIV.do_populate_tab1: START&#39; || CHR(10) || &#39;[&#39; || DBMS_UTILITY.format_error_backtrace || &#39;]&#39;);&#10;            do_populate_tab1;&#10;--            procDebug(&#39;PKG_DynSQL.init_tab_info_PRIV.do_populate_tab2: START&#39;);&#10;--            do_populate_tab2;&#10;            procDebug(&#39;PKG_DynSQL.init_tab_info_PRIV: FINISHED&#39;);&#10;            --&#10;            --print_tab_hier_priv(&#39;OFFENDER&#39;);&#10;            G_TAB_INFO_INIT_FLAG :&#61; TRUE;&#10;            --&#10;        END IF;&#10;    ELSE&#10;        --&#10;        do_populate_tab1;&#10;        --&#10;    END IF;&#10;    --&#10;END init_tab_info_PRIV;&#10;--&#10;PROCEDURE init_tab_info(p_reset_flag VARCHAR2 DEFAULT &#39;N&#39;)&#10;IS&#10;    --&#10;    l_entry_is_cached BOOLEAN;&#10;    --l_tab_info_CLOB   VARCHAR2(32767);&#10;    --&#10;BEGIN&#10;    IF p_reset_flag &#61; &#39;Y&#39; THEN&#10;        --procDebug(&#39;PKG_DynSQL.init_tab_info(P_RESET_FLAG&#61;Y)&#39;);&#10;        g_tab_info.DELETE; --NULL;&#10;--        g_tab2_info.DELETE;&#10;        G_TAB_INFO_INIT_FLAG :&#61; FALSE;&#10;        --&#10;        init_tab_info_PRIV;&#10;        --&#10;    ELSE&#10;        --&#10;--        IF PKG_Global.GC_PG_MEMCACHE_FLAG &#61; &#39;Y&#39; THEN&#10;--            --&#10;--            l_tab_info_CLOB :&#61; get_tab_info_encoded(p_global_cache_flag&#61;&gt;&#39;Y&#39;);&#10;--            IF (EMPTY2NULL(l_tab_info_CLOB) IS NULL)&#10;--               --OR&#10;--               --(l_tab_info_CLOB LIKE &#39;INVALID&#39; || PKG_Mem_Cache.GC_CACHE_DELIM || &#39;%&#39;)&#10;--            THEN&#10;--                l_entry_is_cached :&#61; FALSE;&#10;--            ELSE&#10;--                l_entry_is_cached :&#61; TRUE;&#10;--            END IF;&#10;--        ELSE&#10;            l_entry_is_cached :&#61; FALSE;&#10;--        END IF;&#10;        --&#10;--        IF l_entry_is_cached AND PKG_Global.GC_PG_MEMCACHE_FLAG &#61; &#39;Y&#39; THEN&#10;--            set_tab_info_decoded(l_tab_info_CLOB);&#10;--        ELSE&#10;            init_tab_info_PRIV;&#10;--        END IF;&#10;        --&#10;    END IF;&#10;    --&#10;    PKG_hier_support.init_tab_info(p_reset_flag);&#10;    --&#10;END init_tab_info;&#10;--&#10;--&#10;PROCEDURE add_elem(&#10;    p_table_name        VARCHAR2,&#10;    p_table_type        VARCHAR2,&#10;    p_order_by          NUMBER,&#10;    p_parent_table      VARCHAR2 DEFAULT NULL,&#10;    p_hier_level        NUMBER  DEFAULT NULL,&#10;    p_hier_order_by     NUMBER  DEFAULT NULL,&#10;    p_pk_col_name       VARCHAR2 DEFAULT NULL,&#10;    p_fk_col_name       VARCHAR2 DEFAULT NULL,&#10;    p_not_null_col_name VARCHAR2 DEFAULT NULL,&#10;    p_from_clause       VARCHAR2 DEFAULT NULL,&#10;    p_where_clause      VARCHAR2 DEFAULT NULL,&#10;    p_where_clause1     VARCHAR2 DEFAULT NULL,&#10;    --p_vpd_broad_flag    VARCHAR2 DEFAULT &#39;N&#39;,&#10;    --p_local_flag        VARCHAR2 DEFAULT &#39;N&#39;,&#10;    --&#10;    x_TAB               IN OUT ttabTablesHierarchy )&#10;IS&#10;    l_idx NUMBER;&#10;    l_rec trecTablesHierarchy;&#10;BEGIN&#10;    l_idx :&#61; NVL(x_TAB.COUNT, 0);&#10;    l_rec.table_name        :&#61; p_table_name;&#10;    l_rec.table_type        :&#61; p_table_type;&#10;    l_rec.order_by          :&#61; p_order_by;&#10;    l_rec.hier_level        :&#61; p_hier_level;&#10;    l_rec.hier_order_by     :&#61; p_hier_order_by;&#10;    l_rec.parent_table      :&#61; p_parent_table;&#10;    l_rec.pk_col_name       :&#61; p_pk_col_name;&#10;    l_rec.fk_col_name       :&#61; NVLSTR(&#10;                                  p_fk_col_name,&#10;                                  CASE WHEN empty2null(p_parent_table) IS NULL THEN&#10;                                      NULL&#10;                                  ELSE&#10;                                      CASE WHEN p_parent_table &#61; &#39;INSTITUTIONAL_REPORT_TRANSFER&#39; THEN&#10;                                          &#39;INSTITUTIONAL_REP_TRANSFER&#39;&#10;                                      ELSE&#10;                                          p_parent_table&#10;                                      END&#10;                                      || &#39;_ID&#39;&#10;                                  END );&#10;    l_rec.not_null_col_name :&#61; p_not_null_col_name;&#10;    l_rec.from_clause       :&#61; p_from_clause;&#10;    l_rec.where_clause      :&#61; p_where_clause;&#10;    l_rec.where_clause1     :&#61; p_where_clause1;&#10;    -- crcD specific&#10;    --l_rec.vpd_broad_flag    :&#61; NVLSTR(p_vpd_broad_flag, &#39;N&#39;);&#10;    --l_rec.local_flag        :&#61; NVLSTR(p_local_flag, &#39;N&#39;);&#10;    --&#10;    x_TAB.EXTEND;&#10;    x_TAB(l_idx + 1) :&#61; l_rec;&#10;EXCEPTION WHEN OTHERS THEN&#10;    raise_error(&#39;ERROR: &#39; || SQLERRM ||&#10;        &#39;(table&#61;&#39;         || p_table_name         || &#39;)&#39; ||&#10;        &#39;(tab_type&#61;&#39;      || p_table_type         || &#39;)&#39; ||&#10;        &#39;(order_by&#61;&#39;      || p_order_by           || &#39;)&#39; ||&#10;        &#39;(parent_table&#61;&#39;  || p_parent_table       || &#39;)&#39; ||&#10;        &#39;(hier_level&#61;&#39;    || p_hier_level         || &#39;)&#39; ||&#10;        &#39;(hier_order_by&#61;&#39; || p_hier_order_by      || &#39;)&#39; ||&#10;        &#39;(pk_col&#61;&#39;        || p_pk_col_name        || &#39;)&#39; ||&#10;        &#39;(fk_col&#61;&#39;        || p_fk_col_name        || &#39;)&#39; ||&#10;        &#39;(not_null_col&#61;&#39;  || p_not_null_col_name  || &#39;)&#39; ||&#10;        &#39;(from_clause&#61;&#39;   || p_from_clause        || &#39;)&#39; ||&#10;        &#39;(where_clause&#61;&#39;  || p_where_clause       || &#39;)&#39; ||&#10;        &#39;(where_clause1&#61;&#39; || p_where_clause1      || &#39;)&#39; ||&#10;        --&#39;(vpd_broad_flag&#61;&#39;|| p_vpd_broad_flag     || &#39;)&#39; ||&#10;        --&#39;(local_flag&#61;&#39;    || p_local_flag         || &#39;)&#39; ||&#10;        &#39;PKG_DynSQL.add_elem&#39; );&#10;    RAISE;&#10;END add_elem;&#10;--&#10;PROCEDURE add_elem_R(&#10;    p_table_name        VARCHAR2,&#10;    p_parent_table      VARCHAR2 DEFAULT NULL,&#10;    p_hier_level        NUMBER  DEFAULT -1,&#10;    p_hier_order_by     NUMBER  DEFAULT NULL,&#10;    p_fk_col_name       VARCHAR2 DEFAULT NULL,&#10;    p_not_null_col_name VARCHAR2 DEFAULT NULL,&#10;    p_where_clause      VARCHAR2 DEFAULT NULL,&#10;    p_where_clause1     VARCHAR2 DEFAULT NULL,&#10;    --&#10;    x_TAB               IN OUT ttabTablesHierarchy,&#10;    x_R_cnt             IN OUT NUMBER )&#10;IS&#10;    lc_offset CONSTANT NUMBER :&#61; 912;&#10;BEGIN&#10;    x_R_cnt :&#61; x_R_cnt + 1;&#10;    add_elem(&#10;        p_table_name        &#61;&gt; p_table_name,&#10;        p_table_type        &#61;&gt; &#39;R&#39;,&#10;        p_order_by          &#61;&gt; x_R_cnt,&#10;        p_parent_table      &#61;&gt; &#39;&#39;,&#10;        p_hier_level        &#61;&gt; p_hier_level,&#10;        p_hier_order_by     &#61;&gt; lc_offset + x_R_cnt,&#10;        p_fk_col_name       &#61;&gt; p_fk_col_name,&#10;        p_not_null_col_name &#61;&gt; p_not_null_col_name,&#10;        p_where_clause      &#61;&gt; p_where_clause,&#10;        p_where_clause1     &#61;&gt; p_where_clause1,&#10;        --&#10;        x_TAB               &#61;&gt; x_TAB );&#10;END add_elem_R;&#10;--&#10;PROCEDURE add_elem_O(&#10;    p_table_name        VARCHAR2,&#10;    p_parent_table      VARCHAR2 DEFAULT NULL,&#10;    p_hier_level        NUMBER  DEFAULT NULL,&#10;    p_hier_order_by     NUMBER  DEFAULT NULL,&#10;    p_fk_col_name       VARCHAR2 DEFAULT NULL,&#10;    p_not_null_col_name VARCHAR2 DEFAULT NULL,&#10;    p_where_clause      VARCHAR2 DEFAULT NULL,&#10;    p_where_clause1     VARCHAR2 DEFAULT NULL,&#10;    --p_vpd_broad_flag    VARCHAR2 DEFAULT &#39;N&#39;,&#10;    --p_local_flag        VARCHAR2 DEFAULT &#39;N&#39;,&#10;    --&#10;    x_TAB               IN OUT ttabTablesHierarchy,&#10;    x_O_cnt             IN OUT NUMBER )&#10;IS&#10;BEGIN&#10;    x_O_cnt :&#61; x_O_cnt + 1;&#10;    add_elem(&#10;        p_table_name        &#61;&gt; p_table_name,&#10;        p_table_type        &#61;&gt; &#39;O&#39;,&#10;        p_order_by          &#61;&gt; x_O_cnt,&#10;        p_parent_table      &#61;&gt; p_parent_table,&#10;        p_hier_level        &#61;&gt; p_hier_level,&#10;        p_hier_order_by     &#61;&gt; p_hier_order_by,&#10;        p_fk_col_name       &#61;&gt; p_fk_col_name,&#10;        p_not_null_col_name &#61;&gt; p_not_null_col_name,&#10;        p_where_clause      &#61;&gt; p_where_clause,&#10;        p_where_clause1     &#61;&gt; p_where_clause1,&#10;        -- crcD specific&#10;        --p_vpd_broad_flag    &#61;&gt; p_vpd_broad_flag,&#10;        --p_local_flag        &#61;&gt; p_local_flag,&#10;        --&#10;        x_TAB               &#61;&gt; x_TAB );&#10;END add_elem_O;&#10;--&#10;PROCEDURE add_elem_M(&#10;    p_table_name        VARCHAR2,&#10;    p_parent_table      VARCHAR2 DEFAULT NULL,&#10;    p_hier_level        NUMBER  DEFAULT NULL,&#10;    p_hier_order_by     NUMBER  DEFAULT NULL,&#10;    p_pk_col_name       VARCHAR2 DEFAULT NULL,&#10;    p_fk_col_name       VARCHAR2 DEFAULT NULL,&#10;    p_not_null_col_name VARCHAR2 DEFAULT NULL,&#10;    p_from_clause       VARCHAR2 DEFAULT NULL,&#10;    p_where_clause      VARCHAR2 DEFAULT NULL,&#10;    p_where_clause1     VARCHAR2 DEFAULT NULL,&#10;    --&#10;    p_xsd_number        NUMBER DEFAULT 1,&#10;    --&#10;    x_TAB               IN OUT ttabTablesHierarchy,&#10;    x_M_cnt             IN OUT NUMBER )&#10;IS&#10;    l_WHERE1_lst            BUSINESS_INT_XML_SUMMARY.where_clause1%TYPE;&#10;    l_WHERE1                VARCHAR2(4000);&#10;    l_line                  VARCHAR2(4000);&#10;    l_parent_xml_message_id NUMBER;&#10;    l_parent_table          VARCHAR2(30);&#10;    l_hier_level            NUMBER;&#10;    l_hier_order_by         NUMBER;&#10;    l_fk_col_name           VARCHAR2(30);&#10;BEGIN&#10;    --&#10;    l_WHERE1_lst :&#61; TRIM(REPLACE(REPLACE(p_where_clause1, CHR(13), &#39;&#39;), CHR(9), &#39; &#39;));&#10;    --&#10;    IF EMPTY2NULL(TRIM(REPLACE(l_WHERE1_lst, CHR(10), &#39; &#39;))) IS NULL THEN&#10;        x_M_cnt :&#61; x_M_cnt + 1;&#10;        add_elem(&#10;            p_table_name        &#61;&gt; p_table_name,&#10;            p_table_type        &#61;&gt; &#39;M&#39;,&#10;            p_order_by          &#61;&gt; x_M_cnt,&#10;            p_parent_table      &#61;&gt; p_parent_table,&#10;            p_hier_level        &#61;&gt; p_hier_level,&#10;            p_hier_order_by     &#61;&gt; p_hier_order_by,&#10;            p_pk_col_name       &#61;&gt; p_pk_col_name,&#10;            p_fk_col_name       &#61;&gt; p_fk_col_name,&#10;            p_not_null_col_name &#61;&gt; p_not_null_col_name,&#10;            p_from_clause       &#61;&gt; p_from_clause,&#10;            p_where_clause      &#61;&gt; NULL,&#10;            p_where_clause1     &#61;&gt; p_where_clause,&#10;            --&#10;            x_TAB               &#61;&gt; x_TAB );&#10;--        procDebug(&#39;PKG_DynSQL.add_elem_M: &#39; ||&#10;--            &#39;(p_table_name&#61;&#39;        || p_table_name        || &#39;)&#39; ||&#10;--            &#39;(p_table_type&#61;&#39;        || &#39;M&#39;                 || &#39;)&#39; ||&#10;--            &#39;(p_order_by&#61;&#39;          || x_M_cnt             || &#39;)&#39; ||&#10;--            &#39;(p_parent_table&#61;&#39;      || p_parent_table      || &#39;)&#39; ||&#10;--            &#39;(p_hier_level&#61;&#39;        || p_hier_level        || &#39;)&#39; ||&#10;--            &#39;(p_hier_order_by&#61;&#39;     || p_hier_order_by     || &#39;)&#39; ||&#10;--            &#39;(p_pk_col_name&#61;&#39;       || p_pk_col_name       || &#39;)&#39; ||&#10;--            &#39;(p_fk_col_name&#61;&#39;       || p_fk_col_name       || &#39;)&#39; ||&#10;--            &#39;(p_not_null_col_name&#61;&#39; || p_not_null_col_name || &#39;)&#39; ||&#10;--            &#39;(p_from_clause&#61;&#39;       || p_from_clause       || &#39;)&#39; ||&#10;--            &#39;(p_where_clause&#61;&#39;      || &#39;&#39;                  || &#39;)&#39; ||&#10;--            &#39;(p_where_clause1&#61;&#39;     || p_where_clause      || &#39;)&#39; ||&#10;--            &#39;(x_CNT&#61;&#39;               || x_TAB.COUNT         || &#39;)&#39; );&#10;    ELSE&#10;        LOOP&#10;            l_line       :&#61; TRIM(PKG_LstUtl.list_next_elem(l_WHERE1_lst, CHR(10)));&#10;            l_line       :&#61; TRIM(LTRIM(TRIM(RTRIM(l_line, CHR(10))), CHR(10)));&#10;            l_WHERE1_lst :&#61; TRIM(LTRIM(TRIM(RTRIM(l_WHERE1_lst, CHR(10))), CHR(10)));&#10;            --&#10;            EXIT WHEN EMPTY2NULL(l_line) IS NULL AND EMPTY2NULL(l_WHERE1_lst) IS NULL;&#10;            --&#10;            --procDebug(&#39;PKG_DynSQL.add_elem_M: &#39; || &#39;(l_LINE&#61;&#39; || l_line || &#39;)&#39;);&#10;            --&#10;            l_hier_level            :&#61; TRIM(PKG_LstUtl.list_next_elem(l_line, &#39;|&#39;));&#10;            l_hier_order_by         :&#61; TRIM(PKG_LstUtl.list_next_elem(l_line, &#39;|&#39;));&#10;            l_parent_xml_message_id :&#61; (TRIM(PKG_LstUtl.list_next_elem(l_line, &#39;|&#39;)));&#10;            l_parent_table          :&#61; get_xml_view_name(p_xml_message_id &#61;&gt; l_parent_xml_message_id, p_xsd_number &#61;&gt; p_xsd_number);&#10;            l_fk_col_name           :&#61; TRIM(PKG_LstUtl.list_next_elem(l_line, &#39;|&#39;));&#10;            l_WHERE1                :&#61; TRIM(RTRIM(l_line, CHR(10)));&#10;            --&#10;            x_M_cnt :&#61; x_M_cnt + 1;&#10;            add_elem(&#10;                p_table_name        &#61;&gt; p_table_name,&#10;                p_table_type        &#61;&gt; &#39;M&#39;,&#10;                p_order_by          &#61;&gt; x_M_cnt,&#10;                p_parent_table      &#61;&gt; l_parent_table,&#10;                p_hier_level        &#61;&gt; l_hier_level,&#10;                p_hier_order_by     &#61;&gt; l_hier_order_by,&#10;                p_pk_col_name       &#61;&gt; p_pk_col_name,&#10;                p_fk_col_name       &#61;&gt; l_fk_col_name,&#10;                p_not_null_col_name &#61;&gt; p_not_null_col_name,&#10;                p_from_clause       &#61;&gt; p_from_clause,&#10;                p_where_clause      &#61;&gt; l_WHERE1,&#10;                p_where_clause1     &#61;&gt; p_where_clause,&#10;                --&#10;                x_TAB               &#61;&gt; x_TAB );&#10;            --&#10;--            procDebug(&#39;PKG_DynSQL.add_elem_M(1): &#39; ||&#10;--                &#39;(p_table_name&#61;&#39;        || p_table_name        || &#39;)&#39; ||&#10;--                &#39;(p_table_type&#61;&#39;        || &#39;M&#39;                 || &#39;)&#39; ||&#10;--                &#39;(p_order_by&#61;&#39;          || x_M_cnt             || &#39;)&#39; ||&#10;--                &#39;(p_parent_table&#61;&#39;      || L_parent_table      || &#39;)&#39; ||&#10;--                &#39;(p_hier_level&#61;&#39;        || l_hier_level        || &#39;)&#39; ||&#10;--                &#39;(p_hier_order_by&#61;&#39;     || l_hier_order_by     || &#39;)&#39; ||&#10;--                &#39;(p_pk_col_name&#61;&#39;       || p_pk_col_name       || &#39;)&#39; ||&#10;--                &#39;(p_fk_col_name&#61;&#39;       || l_fk_col_name       || &#39;)&#39; ||&#10;--                &#39;(p_not_null_col_name&#61;&#39; || p_not_null_col_name || &#39;)&#39; ||&#10;--                &#39;(p_from_clause&#61;&#39;       || p_from_clause       || &#39;)&#39; ||&#10;--                &#39;(p_where_clause&#61;&#39;      || l_WHERE1            || &#39;)&#39; ||&#10;--                &#39;(p_where_clause1&#61;&#39;     || p_where_clause      || &#39;)&#39; ||&#10;--                &#39;(x_CNT&#61;&#39;               || x_TAB.COUNT         || &#39;)&#39; );&#10;        END LOOP;&#10;    END IF;&#10;    --&#10;END add_elem_M;&#10;--&#10;FUNCTION get_tab_list(p_reverse_order_flag VARCHAR2 DEFAULT &#39;N&#39;) RETURN ttabTablesHierarchy PIPELINED&#10;IS&#10;    l_proc CONSTANT VARCHAR2(30) :&#61; &#39;PKG_DynSQL.get_tab_list&#39;;&#10;    --&#10;    l_row     NUMBER;&#10;    l_R_cnt   NUMBER :&#61; 0;&#10;    l_O_cnt   NUMBER :&#61; 0;&#10;    l_M_cnt   NUMBER :&#61; 0;&#10;    l_EOF     BOOLEAN :&#61; FALSE;&#10;    l_i       NUMBER;&#10;    --&#10;    l_TAB     ttabTablesHierarchy :&#61; ttabTablesHierarchy();&#10;    l_TAB1    ttabTablesHierarchy :&#61; ttabTablesHierarchy();&#10;    --&#10;BEGIN&#10;    --&#10;    IF NOT g_TAB_HIER_FLAG THEN&#10;        l_EOF :&#61; FALSE;&#10;        --&#10;        -- Current default PDM v.2.02&#10;        --&#10;        -- 1. Reference Tables&#10;        --&#10;        add_elem_R(&#39;ND_PARAMETER&#39;           , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;CONTACT_TYPE_ICON&#39;      , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;PARTITION_AREA&#39;         , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;TRAINING_SESSION&#39;       , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;ADDRESS&#39;                , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 301 THEN&#10;            add_elem_R(&#39;ORGANISATION&#39;       , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        add_elem_R(&#39;USER_&#39;, x_TAB&#61;&gt;l_TAB    , x_R_cnt&#61;&gt;l_R_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 1808 THEN&#10;            add_elem_R(&#39;USER_NOTE&#39;          , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        -- YF: added in PDM v2.02&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 202 THEN&#10;            add_elem_R(&#39;FORM_20_30&#39;           , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;USER_TRAINING_SESSION&#39;, x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        -- end of change&#10;        --&#10;        add_elem_R(&#39;R_REFERENCE_DATA_MASTER&#39;  , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_STANDARD_REFERENCE_LIST&#39;, x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;BUSINESS_INTERACTION&#39;     , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;PROBATION_AREA&#39;           , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 503 THEN&#10;            add_elem_R(&#39;TRAINING_PROVIDER_USER&#39;, x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 301 THEN&#10;            add_elem_R(&#39;SC_PROVIDER&#39;          , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        add_elem_R(&#39;BOROUGH&#39;                  , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;DISTRICT&#39;                 , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;LOCAL_DELIVERY_UNIT&#39;      , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;STAFF&#39;                    , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;TEAM&#39;                     , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_TRANSFER_REASON&#39;        , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_OFFENCE&#39;                , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;COURT&#39;                    , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_COURT_REPORT_TYPE&#39;      , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 1302 THEN&#10;            add_elem_R(&#39;R_COURT_TEAM&#39;         , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;R_TEAM_SHORT_POSTCODE&#39;, x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;R_TEAM_LONG_POSTCODE&#39; , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        add_elem_R(&#39;R_COURT_REJECTION_REASON&#39;, x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_COURT_TRANSFER_REASON&#39; , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2811 THEN&#10;            add_elem_R(&#39;R_DETAILED_OFFENCE&#39;  , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        add_elem_R(&#39;R_DISPOSAL_TYPE&#39;         , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        --&#10;        add_elem_R(&#39;R_LIC_COND_TYPE_MAIN_CAT&#39;  , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2822 THEN&#10;            add_elem_R(&#39;R_CVL_LIC_COND_MAPPING&#39;, x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 501 THEN&#10;            add_elem_R(&#39;R_LIC_COND_REJECTION_REASON&#39;, x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;R_LIC_COND_TRANSFER_REASON&#39; , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        add_elem_R(&#39;R_RQMNT_TYPE_MAIN_CATEGORY&#39;   , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_AD_RQMNT_TYPE_MAIN_CATEGORY&#39;, x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_DRUG_TYPE&#39;                  , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_ASSESSMENT_OUTCOME&#39;         , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;UPW_DAY&#39;                      , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_CONTACT_TYPE&#39;               , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 908 THEN&#10;            add_elem_R(&#39;R_CONTACT_TYPE_NOMIS_TYPE&#39;, x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 301 THEN&#10;            add_elem_R(&#39;R_NSI_TYPE&#39;               , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;R_NSI_STATUS&#39;             , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;R_NSI_TYPE_OUTCOME&#39;       , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;R_NSI_TYPE_STATUS&#39;        , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;R_NSI_TYPE_SUB_TYPE&#39;      , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 701 THEN&#10;            add_elem_R(&#39;R_RQMNT_NSI_TYPE&#39;         , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 501 THEN&#10;            add_elem_R(&#39;R_PSS_RQMNT_TYPE_MAIN_CATEGORY&#39;, x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;R_PSS_RQMNT_TYPE_SUB_CATEGORY&#39; , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;R_PSS_RQMNT_TYPE&#39;              , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;R_PSS_RQMNT_TYPE_TERMINATION&#39;  , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;R_PSS_RQMNT_REJECTION_REASON&#39;  , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;R_PSS_RQMNT_TRANSFER_REASON&#39;   , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 501 THEN&#10;            add_elem_R(&#39;R_NSI_REJECTION_REASON&#39;        , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;R_NSI_TRANSFER_REASON&#39;         , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;R_NSI_TYPE_PROBATION_AREA&#39;     , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        add_elem_R(&#39;R_REFERRAL_SOURCE&#39;                 , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_REFERRAL_TYPE&#39;                   , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        -- YF: obsolete in PDMv2.02&#10;        --add_elem(&#39;R_REFERRAL_OUTCOME&#39;, x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        -- end of change&#10;        add_elem_R(&#39;R_APPROVED_PREMISES&#39;               , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;AP_AUDIT_REGISTER&#39;                 , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        -- YF: added in PDMv2.02&#10;        add_elem_R(&#39;LOST_BEDS&#39;                         , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_APPROVED_PREMISES_STAFF&#39;         , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        -- end of change&#10;        add_elem_R(&#39;R_INSTITUTION&#39;                     , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        -- YF: added in PDMv9.01&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 901 THEN&#10;            add_elem_R(&#39;R_HOST&#39;                        , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        --&#10;        add_elem_R(&#39;R_CONTACT_OUTCOME_TYPE&#39;            , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_ASSESSMENT_TYPE&#39;                 , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        --YF: obsolete in PDMv2.02&#10;        --add_elem(&#39;R_CONTACT_TEMPLATE_LOCATION&#39;, x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        --add_elem(&#39;R_CONTACT_TEMPLATE_NAME&#39;, x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        -- end of change&#10;        add_elem_R(&#39;R_ENFORCEMENT_ACTION&#39;              , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_EXPLANATION&#39;                     , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;EXTERNAL_PROVIDER&#39;                 , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_MOVE_ON_CATEGORY&#39;                , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;OFFICE_LOCATION&#39;                   , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 501 THEN&#10;            add_elem_R(&#39;R_OFFICE_LOCATION_LINK&#39;        , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        add_elem_R(&#39;PROVIDER_EMPLOYEE&#39;                 , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;PROVIDER_LOCATION&#39;                 , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;PROVIDER_TEAM&#39;                     , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_RECALL_REASON&#39;                   , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_REGISTER_TYPE&#39;                   , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 806 THEN&#10;            add_elem_R(&#39;R_REGISTER_TYPE_CATEGORY&#39;      , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;R_REGISTER_TYPE_LEVEL&#39;         , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;R_REGISTER_TYPE_PROVIDER&#39;      , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 807 THEN&#10;            add_elem_R(&#39;R_REGISTER_DUPLICATE_GROUP&#39;    , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;R_REGISTER_TYPE_DUP_GRP&#39;       , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        add_elem_R(&#39;R_CIRCUMSTANCE_SUB_TYPE&#39;           , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_CIRCUMSTANCE_TYPE&#39;               , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 806 THEN&#10;            add_elem_R(&#39;R_CIRCUMSTANCE_TYPE_PROVIDER&#39;  , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        --YF: Obsolete in PDM 2.02&#10;        --add_elem(&#39;SECTION_SCORE&#39;, x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        -- end of the change&#10;        add_elem_R(&#39;UPW_PROJECT&#39;                       , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;UPW_PROJECT_AVAILABILITY&#39;          , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;UPW_PROJECT_TIMESCALES_GROUP&#39;      , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;UPW_WORK_NATURE_QUALIFICATIONS&#39;    , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2921 THEN&#10;            add_elem_R(&#39;INFORMATION_TEXT&#39;              , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;&#10;        --&#10;        -- Linked Lists&#10;        --&#10;        --YF: Obsolete in PDM 2.02&#10;        -- add_elem(&#39;OASYS_ASSESSMENT_PURPOSE&#39;, x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        -- end of the change&#10;        add_elem_R(&#39;R_GEN_REF_OUTCOME_REF_TYPE&#39;        , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_LINKED_LIST&#39;                     , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;DISABILITY_PROVISION_TYPE&#39;         , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;DISPOSAL_TYPE_AD_SENT_TYPE&#39;        , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;PROBATION_AREA_USER&#39;               , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;STAFF_TEAM&#39;                        , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;TEAM_OFFICE_LOCATION&#39;              , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;PROVIDER_TEAM_EMPLOYEE&#39;            , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;PROVIDER_TEAM_LOCATION&#39;            , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_AP_AP_PROVISION&#39;                 , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_AP_AP_TYPE&#39;                      , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_POST_CJA_LIC_CONDITION_TYPE&#39;     , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_RQMNT_TYPE&#39;                      , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 501 THEN&#10;            add_elem_R(&#39;R_RQMNT_REJECTION_REASON&#39;      , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;R_RQMNT_TRANSFER_REASON&#39;       , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        add_elem_R(&#39;R_AD_RQMNT_TYPE&#39;                   , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_CJALICENCE_COND_TERMINATION&#39;     , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_RQMNT_TYPE_TERMINATION&#39;          , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_AD_RQMNT_TYPE_TERMINATION&#39;       , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_ASSMNT_TYPE_ASSMNT_OUTCOME&#39;      , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_ASSMNT_TYPE_REFERRAL_TYPE&#39;       , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_AP_REFERRAL_GROUP&#39;               , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_DISPOSAL_TYPE_TERMINATION&#39;       , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;DISPOSAL_TYPE_AD_RQMNT_TYPE&#39;       , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;DISPOSAL_TYPE_RQMNT_TYPE&#39;          , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;DISPOSAL_TYPE_LIC_COND_TYPE&#39;       , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_CONTACT_TYPECONTACT_CATEGORY&#39;    , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_CONTACT_TYPE_OUTCOME&#39;            , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;PROPOSAL_TYPE_COURTREPORT_TYPE&#39;    , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_CIRCUMSTANCE_TYPE_SUBTYPE&#39;       , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;TRIGGER_OFFENCE&#39;                   , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_ENF_ACT_CONTACT_OUT_TYPE&#39;        , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_CON_OUT_TYPE_CONTACT_TYPE&#39;       , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_CONTACT_TYPE_DISPOSAL_TYPE&#39;      , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_CON_TYPE_LIC_CON_TYPEMAINCAT&#39;    , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        -- YF: obsolete in PDMv2.02&#10;        --add_elem(&#39;R_CON_OUT_TYPE_ENFORMNT_ACTION&#39;, x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        -- end of change&#10;        add_elem_R(&#39;R_CON_TYPE_REQ_TYPE_MAINCAT&#39;       , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;R_CON_TYPE_AD_REQ_TYPE_MAINCAT&#39;    , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 301 THEN&#10;            add_elem_R(&#39;R_CONTACT_TYPE_NSI_TYPE&#39;       , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        --&#10;        add_elem_R(&#39;BUSINESS_INT_XML_DETAIL&#39;           , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;BUSINESS_INT_XML_SUMMARY&#39;          , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        add_elem_R(&#39;BUSINESS_INT_XML_MAP&#39;              , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 904 THEN&#10;            add_elem_R(&#39;SPG_XSD&#39;                       , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;R_SPG_XSD_PROBATION_AREA&#39;      , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 1007 THEN&#10;            add_elem_R(&#39;R_NOMIS_TYPE_NSI_TYPE&#39;         , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 911 THEN&#10;            add_elem_R(&#39;R_TIER_ALLOC_QUESTION_TIER&#39;    , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2302 THEN&#10;            add_elem_R(&#39;R_DRUG_CONTEXT_DRUG_TYPE&#39;      , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2403 THEN&#10;            add_elem_R(&#39;R_DRUG_CONTEXT_CONTACT_TYPE&#39;   , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2504 THEN&#10;            add_elem_R(&#39;R_LEVEL_2_HEAD_OF_LEVEL_2&#39;     , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2709 THEN&#10;            add_elem_R(&#39;R_APPROVED_PREMISES_TEAM&#39;      , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2804 THEN&#10;            add_elem_R(&#39;R_DISABILITY_TYPE_CONDITION&#39;   , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2805 THEN&#10;            add_elem_R(&#39;R_PROVISION_CATEGORY_TYPE&#39;     , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2807 THEN&#10;            add_elem_R(&#39;R_CONTACT_OUTCOME_UPW_REASON&#39;  , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2824 THEN&#10;            add_elem_R(&#39;R_INSTITUTION_NOMIS_HOSPITAL&#39;  , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;        -- Document Template reference tables&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2925 THEN&#10;            add_elem_R(&#39;DOCUMENT_TEMPLATE&#39;             , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;DOCUMENT_TEMPLATE_AREA&#39;        , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;            add_elem_R(&#39;OBJECT_TYPE_DOCUMENT_TEMPLATE&#39; , x_TAB&#61;&gt;l_TAB, x_R_cnt&#61;&gt;l_R_cnt);&#10;        END IF;&#10;&#10;        --&#10;        -- 2. Offender based Tables&#10;        --&#10;        add_elem_O(&#39;OFFENDER&#39;                      , &#39;&#39;                              , 0, -1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --&#10;        add_elem_O(&#39;OFFLOC&#39;                        , &#39;&#39;                              , 0, 4, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;SPG_SEARCH_REQUEST&#39;            , &#39;&#39;                              , 0, 7, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --&#10;        --&#10;        -- LEVEL 1&#10;        --&#10;&#10;        --&#10;        -- Offender based Tables with parent table other than OFFENDER&#10;        --&#10;        add_elem_O(&#39;DSS_SEARCH_OFFENDER&#39;             , &#39;OFFLOC&#39;                      , 1, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;PNC_NUMBER&#39;                      , &#39;OFFLOC&#39;                      , 1, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --&#10;        --&#10;        add_elem_O(&#39;SPG_SEARCH_OFFENDER&#39;             , &#39;SPG_SEARCH_REQUEST&#39;          , 1, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --&#10;        -- Offender L1 tables&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 805 THEN&#10;            add_elem_O(&#39;MASTER_TRANSFER&#39;           , &#39;OFFENDER&#39;                      , 1, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        add_elem_O(&#39;EVENT&#39;                         , &#39;OFFENDER&#39;                      , 1, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;ADDITIONAL_IDENTIFIER&#39;         , &#39;OFFENDER&#39;                      , 1, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;OFFENDER_ADDRESS&#39;              , &#39;OFFENDER&#39;                      , 1, 4, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --YF: OFFENDER_ADDRESS_ID is not NULL-able&#10;        --add_elem_O(&#39;ADDRESS_ASSESSMENT&#39;            , &#39;OFFENDER&#39;                      , 1, 5, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause &#61;&gt; &#39;offender_address_id IS NULL&#39;);&#10;        add_elem_O(&#39;ALIAS&#39;                         , &#39;OFFENDER&#39;                      , 1, 6, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;PERSONAL_CIRCUMSTANCE&#39;         , &#39;OFFENDER&#39;                      , 1, 7, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;DISABILITY&#39;                    , &#39;OFFENDER&#39;                      , 1, 8, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;MANAGEMENT_TIER&#39;               , &#39;OFFENDER&#39;                      , 1, 9, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2105 THEN&#10;            add_elem_O(&#39;MANAGEMENT_TIER_EVENT&#39;     , &#39;OFFENDER&#39;                      , 1, 10, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        add_elem_O(&#39;OFFENDER_TRANSFER&#39;             , &#39;OFFENDER&#39;                      , 1, 11, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;OFFENDER_MANAGER&#39;              , &#39;OFFENDER&#39;                      , 1, 12, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;PERSONAL_CONTACT&#39;              , &#39;OFFENDER&#39;                      , 1, 13, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;REGISTRATION&#39;                  , &#39;OFFENDER&#39;                      , 1, 14, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        -- DST-16837: Leave OFFENDER as the only Parent table for the OASYS_ASSESSMENT table (same as ASSESSMENT)&#10;        add_elem_O(&#39;OASYS_ASSESSMENT&#39;              , &#39;OFFENDER&#39;                      , 1, 15, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt/*, p_where_clause &#61;&gt; &#39;contact_id IS NULL&#39;*/);&#10;        --&#10;        add_elem_O(&#39;CONTACT&#39;                       , &#39;OFFENDER&#39;                      , 1, 17, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause&#61;&gt;&#39;event_id IS NULL AND table_name IS NULL&#39;);&#10;--        -- new entry&#10;--        add_elem_O(&#39;CONTACT&#39;                       , &#39;CONTACT&#39;                       , 1, 18,&#10;--            p_fk_col_name       &#61;&gt; &#39;LINKED_CONTACT_ID&#39;,&#10;--            p_not_null_col_name &#61;&gt; &#39;OFFENDER_ID&#39;, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt,&#10;--            p_where_clause      &#61;&gt; &#39;event_id IS NULL&#39; );&#10;        --&#10;        add_elem_O(&#39;DOCUMENT&#39;                      , &#39;OFFENDER&#39;                      , 1, 19, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause&#61;&gt;&#39;table_name IS NULL&#39;);&#10;        add_elem_O(&#39;DOCUMENT&#39;                      , &#39;OFFENDER&#39;                      , 1, 20, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;OFFENDER&#39;&#39;&#39;);&#10;        add_elem_O(&#39;EXCLUSION&#39;                     , &#39;OFFENDER&#39;                      , 1, 21, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;RESTRICTION&#39;                   , &#39;OFFENDER&#39;                      , 1, 22, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        -- new entry&#10;        add_elem_O(&#39;SUBJECT_ACCESS_REPORT&#39;         , &#39;OFFENDER&#39;                      , 1, 23, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;OFFENDER_PRISONER&#39;             , &#39;OFFENDER&#39;                      , 1, 24, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;MOST_RECENTLY_VIEWED_OFFENDERS&#39;, &#39;OFFENDER&#39;                      , 1, 25, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --add_elem_O(&#39;RISK_ASSESSMENT&#39;               , &#39;OFFENDER&#39;                      , 1, 25, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --&#10;        -- new entry&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 301 THEN&#10;            add_elem_O(&#39;NSI&#39;                       , &#39;OFFENDER&#39;                      , 1, 26, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause &#61;&gt; &#39;event_id IS NULL&#39;);&#10;--            add_elem_O(&#39;CONTACT&#39;                   , &#39;OFFENDER&#39;                      , 1, 27, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt,&#10;--               p_where_clause &#61;&gt; &#39;event_id IS NULL AND lic_condition_id IS NULL AND rqmnt_id IS NULL AND nsi_id IS NOT NULL AND pss_rqmnt_id IS NULL&#39;&#10;--            );&#10;        END IF;&#10;        --&#10;        add_elem_O(&#39;CASELOAD&#39;                      , &#39;OFFENDER&#39;                      , 1, 28, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 504 THEN&#10;            add_elem_O(&#39;COHORT_DIARY&#39;              , &#39;OFFENDER&#39;                      , 1, 29, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        add_elem_O(&#39;CONTACT_ALERT&#39;                 , &#39;OFFENDER&#39;                      , 1, 30, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 1008 THEN&#10;            --YF: CONTACT_ID is not NULL-able&#10;            --add_elem_O(&#39;CONTACT_ALERT_CLEAR&#39;       , &#39;OFFENDER&#39;                      , 1, 31, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;            NULL;&#10;        END IF;&#10;        -- DST-1814: exclude OFFENDER_DELTA from cascade delete&#10;        --IF PKG_Global.get_PDM_VERSION &gt;&#61; 1011 THEN&#10;        --    add_elem_O(&#39;OFFENDER_DELTA&#39;            , &#39;OFFENDER&#39;                      , 1, 32, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --END IF;&#10;        --&#10;        --  REJECTED_TRANSFER_DIARY hierrchy details&#10;        --  ----------------------------------------&#10;        --  OFFENDER                    1, 30&#10;        --  EVENT                       2, 21&#10;        --  MASTER_TRANSFER             2, 8&#10;        --  OFFENDER_TRANSFER           2, 1&#10;        --  NSI                         2, 11&#10;        --  NSI                         3, 3&#10;        --  COURT_REPORT                4, 4&#10;        --  LIC_CONDITION               4, 5&#10;        --  RQMNT                       4, 10&#10;        --  NSI_TRANSFER                4, 1&#10;        --  ORDER_TRANSFER              4, 1&#10;        --  INSTITUTIONAL_REPORT        5, 5&#10;        --  PSS_RQMNT                   5, 8&#10;        --  RQMNT_TRANSFER              5, 1&#10;        --  LIC_CONDITION_TRANSFER      5, 1&#10;        --  PSS_RQMNT_TRANSFER          6, 1&#10;        --  COURT_REPORT_TRANSFER       6, 1&#10;        --  INSTITUTIONAL_REP_TRANSFER  7, 1&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 808 THEN&#10;            --YF: MASTER_TRANSFER_ID is not NULL-able&#10;            --add_elem_O(&#39;REJECTED_TRANSFER_DIARY&#39;   , &#39;OFFENDER&#39;                      , 1, 33, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;            NULL;&#10;        END IF;&#10;        --&#10;        add_elem_O(&#39;ORGANISATION_OFFENDER&#39;         , &#39;OFFENDER&#39;                      , 1, 34, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 806 THEN&#10;           add_elem_O(&#39;PROVIDER_LAO&#39;               , &#39;OFFENDER&#39;                      , 1, 36, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 805 THEN&#10;            add_elem_O(&#39;OFFENDER_CRC_EXPORT&#39;       , &#39;OFFENDER&#39;                      , 1, 37, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 801 THEN&#10;            add_elem_O(&#39;SPG_NOTIFICATION&#39;          , &#39;OFFENDER&#39;                      , 1, 38, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 802 THEN&#10;            add_elem_O(&#39;SPG_VERSION_ENTRY&#39;         , &#39;OFFENDER&#39;                      , 1, 39, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 806 THEN&#10;            add_elem_O(&#39;SPG_EXCEPTION&#39;             , &#39;OFFENDER&#39;                      , 1, 40, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 905 THEN&#10;            add_elem_O(&#39;PRISON_OFFENDER_MANAGER&#39;   , &#39;OFFENDER&#39;                      , 1, 41, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;--        IF PKG_Global.get_PDM_VERSION &gt;&#61; 907 THEN&#10;--            add_elem_O(&#39;RESPONSIBLE_OFFICER&#39;       , &#39;OFFENDER&#39;                      , 1, 42, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;--        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 1302 THEN&#10;            add_elem_O(&#39;CRC_INACTIVE_OFFENDER&#39;     , &#39;OFFENDER&#39;                      , 1, 43, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 1401 THEN&#10;            add_elem_O(&#39;DATA_SCRIPT_MESSAGE&#39;       , &#39;OFFENDER&#39;                      , 1, 44, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 904 THEN&#10;            add_elem_O(&#39;DSS_SEARCH_REQUEST&#39;        , &#39;OFFENDER&#39;                      , 1, 45, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 1018 THEN&#10;            add_elem_O(&#39;SPG_DOCUMENT_REQUEST&#39;      , &#39;OFFENDER&#39;                      , 1, 46, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 904 THEN&#10;            add_elem_O(&#39;SPG_SEARCH_OFFENDER&#39;       , &#39;OFFENDER&#39;                      , 1, 47, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 1503 THEN&#10;            add_elem_O(&#39;DYNAMIC_RSR_HISTORY&#39;       , &#39;OFFENDER&#39;                      , 1, 48, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2107 THEN&#10;            add_elem_O(&#39;OFFENDER_MERGE_DETAILS&#39;    , &#39;OFFENDER&#39;                      , 1, 49, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;source_offender_id&#39;);&#10;            add_elem_O(&#39;OFFENDER_MERGE_DETAILS&#39;    , &#39;OFFENDER&#39;                      , 1, 50, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;target_offender_id&#39;);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2206 THEN&#10;            add_elem_O(&#39;EQUALITY&#39;                  , &#39;OFFENDER&#39;                      , 1, 51, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2302 THEN&#10;            add_elem_O(&#39;OFFENDER_DRUG_PROFILE&#39;     , &#39;OFFENDER&#39;                      , 1, 52, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2804 THEN&#10;            add_elem_O(&#39;PROVISION&#39;                  , &#39;OFFENDER&#39;                     , 1, 53, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause &#61;&gt; &#39;disability_id IS NULL&#39;);&#10;        END IF;&#10;        --&#10;        -- LEVEL 2&#10;        --&#10;&#10;        --&#10;        -- Offender based Tables with parent table other than OFFENDER&#10;        --&#10;        add_elem_O(&#39;DSS_SEARCH_OFFENDER&#39;           , &#39;DSS_SEARCH_REQUEST&#39;            , 2, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;&#10;        --&#10;        -- Offender L2 tables&#10;        --&#10;        add_elem_O(&#39;ENFORCEMENT&#39;                   , &#39;CONTACT&#39;                       , 2, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause &#61;&gt; &#39;upw_appointment_id IS NULL&#39;);&#10;--        add_elem_O(&#39;CONTACT&#39;                       , &#39;CONTACT&#39;                       , 2, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt,&#10;--            p_fk_col_name       &#61;&gt; &#39;LINKED_CONTACT_ID&#39;,&#10;--            p_not_null_col_name &#61;&gt; &#39;EVENT_ID&#39;,&#10;--            p_where_clause      &#61;&gt; &#39;lic_condition_id IS NULL AND rqmnt_id IS NULL AND pss_rqmnt_id IS NULL&#39;&#10;--        );&#10;        -- DST-16837: Leave OFFENDER as the only Parent table for the OASYS_ASSESSMENT table (same as ASSESSMENT)&#10;        --add_elem_O(&#39;OASYS_ASSESSMENT&#39;              , &#39;CONTACT&#39;                       , 2, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause &#61;&gt; &#39;contact_id IS NOT NULL&#39;);&#10;        add_elem_O(&#39;CONTACT_UPLOAD_DOCUMENT&#39;       , &#39;CONTACT&#39;                       , 2, 4, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;DOCUMENT&#39;                      , &#39;CONTACT&#39;                       , 2, 5, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;CONTACT&#39;&#39;&#39;);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 1008 THEN&#10;            add_elem_O(&#39;CONTACT_ALERT_CLEAR&#39;       , &#39;CONTACT&#39;                       , 2, 6, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        --&#10;        add_elem_O(&#39;PROVISION&#39;                     , &#39;DISABILITY&#39;                    , 2, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause &#61;&gt; &#39;disability_id IS NOT NULL&#39;);&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 3002 THEN&#10;            add_elem_O(&#39;ARMED_SERVICE&#39;             , &#39;EQUALITY&#39;                      , 2, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        add_elem_O(&#39;DISPOSAL&#39;                      , &#39;EVENT&#39;                         , 2, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 805 THEN&#10;            add_elem_O(&#39;CASE_ALLOCATION&#39;           , &#39;EVENT&#39;                         , 2, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        add_elem_O(&#39;DRUG_TEST_PROFILE&#39;             , &#39;EVENT&#39;                         , 2, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;ADDITIONAL_OFFENCE&#39;            , &#39;EVENT&#39;                         , 2, 4, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;ADDITIONAL_SENTENCE&#39;           , &#39;EVENT&#39;                         , 2, 5, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;MAIN_OFFENCE&#39;                  , &#39;EVENT&#39;                         , 2, 6, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;APPROVED_PREMISES_REFERRAL&#39;    , &#39;EVENT&#39;                         , 2, 7, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 301 THEN&#10;            add_elem_O(&#39;ORDER_TRANSFER&#39;            , &#39;EVENT&#39;                         , 2, 8, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        add_elem_O(&#39;ORDER_MANAGER&#39;                 , &#39;EVENT&#39;                         , 2, 9, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;REFERRAL&#39;                      , &#39;EVENT&#39;                         , 2, 10, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;COURT_APPEARANCE&#39;              , &#39;EVENT&#39;                         , 2, 11, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;REPORT_MANAGER&#39;                , &#39;EVENT&#39;                         , 2, 12, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt,&#10;            p_where_clause &#61;&gt; &#39;court_report_id IS NULL AND institutional_report_id IS NULL AND institutional_rep_transfer_id IS NULL AND court_report_transfer_id IS NULL&#39;&#10;        );&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 301 THEN&#10;            add_elem_O(&#39;NSI&#39;                       , &#39;EVENT&#39;                         , 2, 13, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause &#61;&gt; &#39;event_id IS NOT NULL&#39;);&#10;        END IF;&#10;        add_elem_O(&#39;CONTACT&#39;                       , &#39;EVENT&#39;                         , 2, 14, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause &#61;&gt;&#10;            &#39;event_id IS NOT NULL AND lic_condition_id IS NULL AND rqmnt_id IS NULL AND nsi_id IS NULL AND pss_rqmnt_id IS NULL AND table_name IS NULL&#39;&#10;        );&#10;        add_elem_O(&#39;OGRS_ASSESSMENT&#39;               , &#39;EVENT&#39;                         , 2, 15, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;DRUGS_TEST&#39;                    , &#39;EVENT&#39;                         , 2, 16, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 501 THEN&#10;            add_elem_O(&#39;COHORT&#39;                    , &#39;EVENT&#39;                         , 2, 17, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;            add_elem_O(&#39;COHORT_HISTORY&#39;            , &#39;EVENT&#39;                         , 2, 18, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        add_elem_O(&#39;CASELOAD&#39;                      , &#39;EVENT&#39;                         , 2, 19, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 504 THEN&#10;            add_elem_O(&#39;COHORT_DIARY&#39;              , &#39;EVENT&#39;                         , 2, 20, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 808 THEN&#10;            add_elem_O(&#39;REJECTED_TRANSFER_DIARY&#39;   , &#39;EVENT&#39;                         , 2, 21, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 902 THEN&#10;            add_elem_O(&#39;TIER_ALLOCATION&#39;           , &#39;EVENT&#39;                         , 2, 22, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        add_elem_O(&#39;DOCUMENT&#39;                      , &#39;EVENT&#39;                         , 2, 23, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;EVENT&#39;&#39;&#39;);&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 1019 THEN&#10;            add_elem_O(&#39;SPG_DOCUMENT_REQUEST&#39;      , &#39;EVENT&#39;                         , 2, 24, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 1401 THEN&#10;            add_elem_O(&#39;DATA_SCRIPT_MESSAGE&#39;       , &#39;EVENT&#39;                         , 2, 25, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2305 THEN&#10;            add_elem_O(&#39;ASSESSMENT&#39;                , &#39;EVENT&#39;                         , 2, 26, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause &#61;&gt; &#39;referral_id IS NULL&#39;);&#10;        END IF;&#10;        --&#10;        add_elem_O(&#39;OASYS_ASSMNT_SECTION_SCORE&#39;    , &#39;OASYS_ASSESSMENT&#39;              , 2, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;OASYS_SENTENCE_PLAN&#39;           , &#39;OASYS_ASSESSMENT&#39;              , 2, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --&#10;        --YF: OFFENDER_ADDRESS_ID is not NULL-able&#10;        add_elem_O(&#39;ADDRESS_ASSESSMENT&#39;            , &#39;OFFENDER_ADDRESS&#39;              , 2, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;PERSONAL_CIRCUMSTANCE&#39;         , &#39;OFFENDER_ADDRESS&#39;              , 2, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --&#10;        add_elem_O(&#39;DEREGISTRATION&#39;                , &#39;REGISTRATION&#39;                  , 2, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;REGISTRATION_REVIEW&#39;           , &#39;REGISTRATION&#39;                  , 2, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2601 THEN&#10;            add_elem_O(&#39;DOCUMENT&#39;                  , &#39;REGISTRATION&#39;                  , 2, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;REGISTRATION&#39;&#39;&#39;);&#10;        END IF;&#10;        --&#10;        add_elem_O(&#39;CASELOAD&#39;                      , &#39;OFFENDER_MANAGER&#39;              , 2, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 504 THEN&#10;            add_elem_O(&#39;COHORT_DIARY&#39;              , &#39;OFFENDER_MANAGER&#39;              , 2, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        add_elem_O(&#39;CONTACT_ALERT&#39;                 , &#39;CONTACT&#39;                       , 2, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --&#10;        add_elem_O(&#39;SUBJECT_ACCESS_REPORT_CONTACT&#39; , &#39;SUBJECT_ACCESS_REPORT&#39;         , 2, 4, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 504 THEN&#10;            add_elem_O(&#39;COHORT_DIARY&#39;              , &#39;MAIN_OFFENCE&#39;                  , 2, 5, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 806 THEN&#10;            add_elem_O(&#39;SPG_ERROR&#39;                 , &#39;SPG_NOTIFICATION&#39;              , 2, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 1301 THEN&#10;            add_elem_O(&#39;SPG_ERROR_CLEAR_REQUEST&#39;   , &#39;SPG_NOTIFICATION&#39;              , 2, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        add_elem_O(&#39;COURT_REPORT_TRANSFER&#39;        , &#39;MASTER_TRANSFER&#39;                , 2, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;INSTITUTIONAL_REPORT_TRANSFER&#39;, &#39;MASTER_TRANSFER&#39;                , 2, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;LIC_CONDITION_TRANSFER&#39;       , &#39;MASTER_TRANSFER&#39;                , 2, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;NSI_TRANSFER&#39;                 , &#39;MASTER_TRANSFER&#39;                , 2, 4, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;OFFENDER_TRANSFER&#39;            , &#39;MASTER_TRANSFER&#39;                , 2, 5, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;ORDER_TRANSFER&#39;               , &#39;MASTER_TRANSFER&#39;                , 2, 6, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;PSS_RQMNT_TRANSFER&#39;           , &#39;MASTER_TRANSFER&#39;                , 2, 7, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;RQMNT_TRANSFER&#39;               , &#39;MASTER_TRANSFER&#39;                , 2, 8, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 808 THEN&#10;            add_elem_O(&#39;REJECTED_TRANSFER_DIARY&#39;  , &#39;MASTER_TRANSFER&#39;                , 2, 10, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 808 THEN&#10;            add_elem_O(&#39;REJECTED_TRANSFER_DIARY&#39;  , &#39;NSI&#39;                            , 2,  1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2201 THEN&#10;            add_elem_O(&#39;NSI_STATUS_HISTORY&#39;       , &#39;NSI&#39;                            , 2, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        add_elem_O(&#39;DOCUMENT&#39;                     , &#39;NSI&#39;                            , 2,  3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;NSI&#39;&#39;&#39;);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2601 THEN&#10;            add_elem_O(&#39;DOCUMENT&#39;                 , &#39;OFFENDER_ADDRESS&#39;               , 2,  4, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;OFFENDER_ADDRESS&#39;&#39;&#39;);&#10;        END IF;&#10;        add_elem_O(&#39;DOCUMENT&#39;                     , &#39;PERSONAL_CONTACT&#39;               , 2,  5, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;PERSONALCONTACT&#39;&#39;&#39;);&#10;        add_elem_O(&#39;DOCUMENT&#39;                     , &#39;PERSONAL_CIRCUMSTANCE&#39;          , 2,  6, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;PERSONAL_CIRCUMSTANCE&#39;&#39;&#39;);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2206 THEN&#10;            add_elem_O(&#39;DOCUMENT&#39;                 , &#39;EQUALITY&#39;                       , 2,  7, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;EQUALITY&#39;&#39;&#39;);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2107 THEN&#10;            add_elem_O(&#39;OFFENDER_MERGE_DETAILS_HIST&#39;, &#39;OFFENDER_MERGE_DETAILS&#39;       , 2, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2302 THEN&#10;            add_elem_O(&#39;OFFENDER_DRUG_PROFILE_MEDS&#39; , &#39;OFFENDER_DRUG_PROFILE&#39;        , 2, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2307 THEN&#10;            add_elem_O(&#39;OFFENDER_DRUG_PROFILE_DRUG&#39; , &#39;OFFENDER_DRUG_PROFILE&#39;        , 2, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        --&#10;        --&#10;        -- 3rd LEVEL&#10;        --&#10;        add_elem_O(&#39;APPROVED_PREMISES_RESIDENCE&#39;   , &#39;APPROVED_PREMISES_REFERRAL&#39;    , 3, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 1604 THEN&#10;           add_elem_O(&#39;APPROVED_PREMISES_PREFERRED&#39;, &#39;APPROVED_PREMISES_REFERRAL&#39;    , 3, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        add_elem_O(&#39;DOCUMENT&#39;                      , &#39;APPROVED_PREMISES_REFERRAL&#39;    , 3, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;APPROVED_PREMISES_REFERRAL&#39;&#39;&#39;);&#10;        add_elem_O(&#39;CONTACT&#39;                       , &#39;APPROVED_PREMISES_REFERRAL&#39;    , 3, 4, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause &#61;&gt; &#39;table_name &#61; &#39;&#39;APPROVED_PREMISES_REFERRAL&#39;&#39;&#39;);&#10;        --&#10;        add_elem_O(&#39;COURT_REPORT&#39;                  , &#39;COURT_APPEARANCE&#39;              , 3, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --&#10;        add_elem_O(&#39;CUSTODY&#39;                       , &#39;DISPOSAL&#39;                      , 3, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;LIC_CONDITION&#39;                 , &#39;DISPOSAL&#39;                      , 3, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;RQMNT&#39;                         , &#39;DISPOSAL&#39;                      , 3, 4, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;UPW_DETAILS&#39;                   , &#39;DISPOSAL&#39;                      , 3, 5, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;CASELOAD&#39;                      , &#39;DISPOSAL&#39;                      , 3, 6, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 504 THEN&#10;            add_elem_O(&#39;COHORT_DIARY&#39;              , &#39;DISPOSAL&#39;                      , 3, 7, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        add_elem_O(&#39;DRUG_TEST_RESULT&#39;              , &#39;DRUGS_TEST&#39;                    , 3, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2312 THEN&#10;            add_elem_O(&#39;DOCUMENT&#39;                  , &#39;DRUGS_TEST&#39;                    , 3, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;DRUGS_TEST&#39;&#39;&#39;);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2307 THEN&#10;            add_elem_O(&#39;CONTACT&#39;                   , &#39;DRUGS_TEST&#39;                    , 3, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause &#61;&gt; &#39;table_name &#61; &#39;&#39;DRUGS_TEST&#39;&#39;&#39;);&#10;        END IF;&#10;        --&#10;        add_elem_O(&#39;DRUGS_TEST_PROFILE_DRUG_TYPE&#39;  , &#39;DRUG_TEST_PROFILE&#39;             , 3, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;DRUG_USAGE&#39;                    , &#39;DRUG_TEST_PROFILE&#39;             , 3, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --&#10;        add_elem_O(&#39;OASYS_SP_NEED&#39;                 , &#39;OASYS_SENTENCE_PLAN&#39;           , 3, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;OASYS_SP_TEXT&#39;                 , &#39;OASYS_SENTENCE_PLAN&#39;           , 3, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;OASYS_SP_WORK_SUMMARY&#39;         , &#39;OASYS_SENTENCE_PLAN&#39;           , 3, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --&#10;        add_elem_O(&#39;ASSESSMENT&#39;                    , &#39;REFERRAL&#39;                      , 3, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;DOCUMENT&#39;                      , &#39;REFERRAL&#39;                      , 3, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;REFERRAL&#39;&#39;&#39;);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2307 THEN&#10;            add_elem_O(&#39;CONTACT&#39;                   , &#39;REFERRAL&#39;                      , 3, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause &#61;&gt; &#39;table_name &#61; &#39;&#39;REFERRAL&#39;&#39;&#39;);&#10;        END IF;&#10;        --&#10;        add_elem_O(&#39;ENFORCEMENT&#39;                   , &#39;CONTACT&#39;                       , 3, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause &#61;&gt; &#39;upw_appointment_id IS NULL&#39;);&#10;        add_elem_O(&#39;CONTACT_ALERT&#39;                 , &#39;CONTACT&#39;                       , 3, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;CONTACT_UPLOAD_DOCUMENT&#39;       , &#39;CONTACT&#39;                       , 3, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;DOCUMENT&#39;                      , &#39;CONTACT&#39;                       , 3, 4, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;CONTACT&#39;&#39;&#39;);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 1008 THEN&#10;            add_elem_O(&#39;CONTACT_ALERT_CLEAR&#39;       , &#39;CONTACT&#39;                       , 3, 5, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 301 THEN&#10;            add_elem_O(&#39;NSI_TRANSFER&#39;              , &#39;NSI&#39;                           , 3, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;            add_elem_O(&#39;NSI_MANAGER&#39;               , &#39;NSI&#39;                           , 3, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 808 THEN&#10;            add_elem_O(&#39;REJECTED_TRANSFER_DIARY&#39;   , &#39;NSI&#39;                           , 3, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        add_elem_O(&#39;DOCUMENT&#39;                      , &#39;NSI&#39;                           , 3, 4, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;NSI&#39;&#39;&#39;);&#10;        add_elem_O(&#39;CONTACT&#39;                       , &#39;NSI&#39;                           , 3, 5, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause &#61;&gt; &#39;nsi_id IS NOT NULL&#39;);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2201 THEN&#10;            add_elem_O(&#39;NSI_STATUS_HISTORY&#39;        , &#39;NSI&#39;                           , 3, 6, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 803 THEN&#10;            add_elem_O(&#39;CASE_ALLOCATION_QUESTION&#39;  , &#39;CASE_ALLOCATION&#39;               , 3, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 806 THEN&#10;            add_elem_O(&#39;CASE_ALLOCATION_LINK&#39;      , &#39;CASE_ALLOCATION&#39;               , 3, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        add_elem_O(&#39;DOCUMENT&#39;                      , &#39;CASE_ALLOCATION&#39;               , 3, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;CASE_ALLOCATION&#39;&#39;&#39;);&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 902 THEN&#10;            add_elem_O(&#39;TIER_ALLOCATION_QUESTION&#39;  , &#39;TIER_ALLOCATION&#39;               , 3,  1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 907 THEN&#10;            add_elem_O(&#39;RESPONSIBLE_OFFICER&#39;       , &#39;OFFENDER_MANAGER&#39;              , 3, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;            add_elem_O(&#39;RESPONSIBLE_OFFICER&#39;       , &#39;PRISON_OFFENDER_MANAGER&#39;       , 3, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        add_elem_O(&#39;DOCUMENT&#39;                     , &#39;ADDRESS_ASSESSMENT&#39;             , 3, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;ADDRESSASSESSMENT&#39;&#39;&#39;);&#10;        --&#10;        --&#10;        -- LEVEL 4&#10;        --&#10;        add_elem_O(&#39;ENFORCEMENT&#39;                   , &#39;CONTACT&#39;                       , 4, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause &#61;&gt; &#39;upw_appointment_id IS NULL&#39;);&#10;        add_elem_O(&#39;DOCUMENT&#39;                      , &#39;CONTACT&#39;                       , 4, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;CONTACT&#39;&#39;&#39;);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 1008 THEN&#10;            add_elem_O(&#39;CONTACT_ALERT_CLEAR&#39;       , &#39;CONTACT&#39;                       , 4, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2302 THEN&#10;            add_elem_O(&#39;ASSESSMENT&#39;                , &#39;CONTACT&#39;                       , 4, 4, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;ENFORCEABLE_CONTACT_ID&#39;);&#10;        END IF;&#10;        --&#10;        add_elem_O(&#39;REPORT_MANAGER&#39;                , &#39;COURT_REPORT&#39;                  , 4, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt,&#10;            p_where_clause &#61;&gt; &#39;court_report_id IS NOT NULL AND court_report_transfer_id IS NULL AND institutional_report_id IS NULL AND institutional_rep_transfer_id IS NULL&#39;);&#10;        add_elem_O(&#39;PROPOSAL&#39;                      , &#39;COURT_REPORT&#39;                  , 4, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 805 THEN&#10;            add_elem_O(&#39;COURT_REPORT_TRANSFER&#39;     , &#39;COURT_REPORT&#39;                  , 4, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 808 THEN&#10;            add_elem_O(&#39;REJECTED_TRANSFER_DIARY&#39;   , &#39;COURT_REPORT&#39;                  , 4, 4, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        add_elem_O(&#39;DOCUMENT&#39;                      , &#39;COURT_REPORT&#39;                  , 4, 5, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;COURT_REPORT&#39;&#39;&#39;);&#10;        add_elem_O(&#39;CONTACT&#39;                       , &#39;COURT_REPORT&#39;                  , 4, 6, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause &#61;&gt; &#39;table_name &#61; &#39;&#39;COURT_REPORT&#39;&#39;&#39;);&#10;        --&#10;        add_elem_O(&#39;KEY_DATE&#39;                      , &#39;CUSTODY&#39;                       , 4, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;RELEASE&#39;                       , &#39;CUSTODY&#39;                       , 4, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;INSTITUTIONAL_REPORT&#39;          , &#39;CUSTODY&#39;                       , 4, 4, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 501 THEN&#10;            add_elem_O(&#39;PSS_RQMNT&#39;                 , &#39;CUSTODY&#39;                       , 4, 5, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        add_elem_O(&#39;CUSTODY_HISTORY&#39;               , &#39;CUSTODY&#39;                       , 4, 6, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 301 THEN&#10;            add_elem_O(&#39;LIC_CONDITION_TRANSFER&#39;    , &#39;LIC_CONDITION&#39;                 , 4, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        add_elem_O(&#39;LIC_CONDITION_MANAGER&#39;         , &#39;LIC_CONDITION&#39;                 , 4, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;CONTACT&#39;                       , &#39;LIC_CONDITION&#39;                 , 4, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause &#61;&gt; &#39;lic_condition_id IS NOT NULL&#39;);&#10;        add_elem_O(&#39;CASELOAD&#39;                      , &#39;LIC_CONDITION&#39;                 , 4, 4, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 808 THEN&#10;            add_elem_O(&#39;REJECTED_TRANSFER_DIARY&#39;   , &#39;LIC_CONDITION&#39;                 , 4, 5, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;--        -- new entry&#10;--        add_elem_O(&#39;CONTACT&#39;                       , &#39;CONTACT&#39;                       , 4, 5, p_fk_col_name&#61;&gt;&#39;LINKED_CONTACT_ID&#39;, p_not_null_col_name&#61;&gt;&#39;LIC_CONDITION_ID&#39;, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 301 THEN&#10;            add_elem_O(&#39;RQMNT_TRANSFER&#39;            , &#39;RQMNT&#39;                         , 4, 6, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        add_elem_O(&#39;RQMNT_MANAGER&#39;                 , &#39;RQMNT&#39;                         , 4, 7, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;CONTACT&#39;                       , &#39;RQMNT&#39;                         , 4, 8, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause &#61;&gt; &#39;rqmnt_id IS NOT NULL&#39;);&#10;        add_elem_O(&#39;CASELOAD&#39;                      , &#39;RQMNT&#39;                         , 4, 9, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 808 THEN&#10;            add_elem_O(&#39;REJECTED_TRANSFER_DIARY&#39;   , &#39;RQMNT&#39;                         , 4, 10, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;--        -- new entry&#10;--        add_elem_O(&#39;CONTACT&#39;                       , &#39;CONTACT&#39;                       , 4, 19, p_fk_col_name&#61;&gt;&#39;LINKED_CONTACT_ID&#39;, p_not_null_col_name&#61;&gt;&#39;RQMNT_ID&#39;, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --&#10;        add_elem_O(&#39;UPW_ADJUSTMENT&#39;                , &#39;UPW_DETAILS&#39;                   , 4, 11, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;UPW_ALLOCATION&#39;                , &#39;UPW_DETAILS&#39;                   , 4, 12, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;UPW_APPOINTMENT&#39;               , &#39;UPW_DETAILS&#39;                   , 4, 13, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2001 THEN&#10;            add_elem_O(&#39;UPW_STATUS_HISTORY&#39;        , &#39;UPW_DETAILS&#39;                   , 4, 14, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 808 THEN&#10;            add_elem_O(&#39;REJECTED_TRANSFER_DIARY&#39;  , &#39;NSI_TRANSFER&#39;                   , 4, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 808 THEN&#10;            add_elem_O(&#39;REJECTED_TRANSFER_DIARY&#39;  , &#39;ORDER_TRANSFER&#39;                 , 4, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 806 THEN&#10;            add_elem_O(&#39;SPG_ERROR_ELEMENT&#39;         , &#39;SPG_ERROR&#39;                     , 4, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;            add_elem_O(&#39;SPG_ERROR_DETAIL&#39;          , &#39;SPG_ERROR&#39;                     , 4, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        add_elem_O(&#39;DOCUMENT&#39;                      , &#39;ASSESSMENT&#39;                    , 4, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;ASSESSMENT&#39;&#39;&#39;);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2307 THEN&#10;            add_elem_O(&#39;CONTACT&#39;                   , &#39;ASSESSMENT&#39;                    , 4, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause &#61;&gt; &#39;table_name &#61; &#39;&#39;ASSESSMENT&#39;&#39;&#39;);&#10;        END IF;&#10;        --&#10;        add_elem_O(&#39;CONTACT&#39;                       , &#39;APPROVED_PREMISES_RESIDENCE&#39;   , 4, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause &#61;&gt; &#39;table_name &#61; &#39;&#39;APPROVED_PREMISES_RESIDENCE&#39;&#39;&#39;);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2604 THEN&#10;            add_elem_O(&#39;OFFENDER_ADDRESS&#39;          , &#39;APPROVED_PREMISES_RESIDENCE&#39;   , 4, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        --&#10;        -- LEVEL 5&#10;        --&#10;        add_elem_O(&#39;ENFORCEMENT&#39;                   , &#39;CONTACT&#39;                       , 5, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause &#61;&gt; &#39;upw_appointment_id IS NULL&#39;);&#10;        add_elem_O(&#39;CONTACT_ALERT&#39;                 , &#39;CONTACT&#39;                       , 5, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;CONTACT_UPLOAD_DOCUMENT&#39;       , &#39;CONTACT&#39;                       , 5, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;DOCUMENT&#39;                      , &#39;CONTACT&#39;                       , 5, 4, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;CONTACT&#39;&#39;&#39;);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 1008 THEN&#10;            add_elem_O(&#39;CONTACT_ALERT_CLEAR&#39;       , &#39;CONTACT&#39;                       , 5, 5, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2302 THEN&#10;            add_elem_O(&#39;ASSESSMENT&#39;                , &#39;CONTACT&#39;                       , 5, 6, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;ENFORCEABLE_CONTACT_ID&#39;);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 501 THEN&#10;            add_elem_O(&#39;INSTITUTIONAL_REPORT_TRANSFER&#39;, &#39;INSTITUTIONAL_REPORT&#39;       , 5, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        add_elem_O(&#39;REPORT_MANAGER&#39;                , &#39;INSTITUTIONAL_REPORT&#39;          , 5, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt,&#10;            p_where_clause &#61;&gt; &#39;institutional_report_id IS NOT NULL AND institutional_rep_transfer_id IS NULL AND court_report_transfer_id IS NULL&#39;);&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 808 THEN&#10;            add_elem_O(&#39;REJECTED_TRANSFER_DIARY&#39;  , &#39;INSTITUTIONAL_REPORT&#39;           , 5, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        add_elem_O(&#39;DOCUMENT&#39;                      , &#39;INSTITUTIONAL_REPORT&#39;          , 5, 4, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;INSTITUTIONAL_REPORT&#39;&#39;&#39;);&#10;        add_elem_O(&#39;CONTACT&#39;                       , &#39;INSTITUTIONAL_REPORT&#39;          , 5, 5, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause &#61;&gt; &#39;table_name &#61; &#39;&#39;INSTITUTIONAL_REPORT&#39;&#39;&#39;);&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 501 THEN&#10;            add_elem_O(&#39;PSS_RQMNT_TRANSFER&#39;        , &#39;PSS_RQMNT&#39;                     , 5, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;            add_elem_O(&#39;PSS_RQMNT_MANAGER&#39;         , &#39;PSS_RQMNT&#39;                     , 5, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 808 THEN&#10;            add_elem_O(&#39;REJECTED_TRANSFER_DIARY&#39;  , &#39;PSS_RQMNT&#39;                      , 5, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        add_elem_O(&#39;CASELOAD&#39;                      , &#39;LIC_CONDITION_MANAGER&#39;         , 5, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --&#10;        add_elem_O(&#39;PROPOSED_RQMNT&#39;                , &#39;PROPOSAL&#39;                      , 5, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --&#10;        add_elem_O(&#39;RECALL&#39;                        , &#39;RELEASE&#39;                       , 5, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 901 THEN&#10;            add_elem_O(&#39;HOST_AT_RELEASE&#39;           , &#39;RELEASE&#39;                       , 5, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        add_elem_O(&#39;CASELOAD&#39;                      , &#39;RQMNT_MANAGER&#39;                 , 5, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        --&#10;        add_elem_O(&#39;ENFORCEMENT&#39;                   , &#39;UPW_APPOINTMENT&#39;               , 5, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause &#61;&gt; &#39;upw_appointment_id IS NOT NULL&#39;);&#10;        add_elem_O(&#39;DOCUMENT&#39;                      , &#39;UPW_APPOINTMENT&#39;               , 5, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;UPW_APPOINTMENT&#39;&#39;&#39;);&#10;        --&#10;        add_elem_O(&#39;CONTACT&#39;                       , &#39;PSS_RQMNT&#39;                     , 5, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause &#61;&gt; &#39;pss_rqmnt_id IS NOT NULL&#39;);&#10;--        add_elem_O(&#39;CONTACT&#39;                       , &#39;CONTACT&#39;                       , 4, 16, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt,&#10;--            p_fk_col_name       &#61;&gt; &#39;LINKED_CONTACT_ID&#39;,&#10;--            p_not_null_col_name &#61;&gt; &#39;PSS_RQMNT_ID&#39;&#10;--        );&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 806 THEN&#10;            add_elem_O(&#39;SPG_ERROR_DETAIL&#39;          , &#39;SPG_ERROR_ELEMENT&#39;             , 5, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 808 THEN&#10;            add_elem_O(&#39;REJECTED_TRANSFER_DIARY&#39;  , &#39;RQMNT_TRANSFER&#39;                 , 5, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 808 THEN&#10;            add_elem_O(&#39;REJECTED_TRANSFER_DIARY&#39;  , &#39;LIC_CONDITION_TRANSFER&#39;         , 5, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        -- LEVEL 6&#10;        --&#10;        add_elem_O(&#39;REPORT_MANAGER&#39;                , &#39;INSTITUTIONAL_REPORT_TRANSFER&#39; , 6, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt,&#10;            p_where_clause &#61;&gt; &#39;institutional_rep_transfer_id IS NOT NULL AND court_report_transfer_id IS NULL&#39;);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 805 THEN&#10;            add_elem_O(&#39;REPORT_MANAGER&#39;            , &#39;COURT_REPORT_TRANSFER&#39;         , 6, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt,&#10;                p_where_clause &#61;&gt; &#39;institutional_rep_transfer_id IS NULL AND court_report_transfer_id IS NOT NULL&#39;);&#10;        END IF;&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 808 THEN&#10;            add_elem_O(&#39;REJECTED_TRANSFER_DIARY&#39;  , &#39;PSS_RQMNT_TRANSFER&#39;             , 6, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 808 THEN&#10;            add_elem_O(&#39;REJECTED_TRANSFER_DIARY&#39;  , &#39;COURT_REPORT_TRANSFER&#39;          , 6, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        add_elem_O(&#39;ENFORCEMENT&#39;                   , &#39;CONTACT&#39;                       , 6, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_where_clause &#61;&gt; &#39;upw_appointment_id IS NULL&#39;);&#10;        add_elem_O(&#39;CONTACT_ALERT&#39;                 , &#39;CONTACT&#39;                       , 6, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;CONTACT_UPLOAD_DOCUMENT&#39;       , &#39;CONTACT&#39;                       , 6, 3, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        add_elem_O(&#39;DOCUMENT&#39;                      , &#39;CONTACT&#39;                       , 6, 4, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;PRIMARY_KEY_ID&#39;, p_where_clause&#61;&gt;&#39;table_name &#61; &#39;&#39;CONTACT&#39;&#39;&#39;);&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 1008 THEN&#10;            add_elem_O(&#39;CONTACT_ALERT_CLEAR&#39;       , &#39;CONTACT&#39;                       , 6, 5, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2302 THEN&#10;            add_elem_O(&#39;ASSESSMENT&#39;                , &#39;CONTACT&#39;                       , 6, 6, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt, p_fk_col_name&#61;&gt;&#39;ENFORCEABLE_CONTACT_ID&#39;);&#10;        END IF;&#10;        --&#10;&#10;        --&#10;        --&#10;        -- LEVEL 7&#10;        --&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 808 THEN&#10;            add_elem_O(&#39;REJECTED_TRANSFER_DIARY&#39;       , &#39;INSTITUTIONAL_REPORT_TRANSFER&#39;, 7, 1, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        IF PKG_Global.get_PDM_VERSION &gt;&#61; 2604 THEN&#10;            add_elem_O(&#39;SUBJECT_ACCESS_REPORT_DOCUMENT&#39;, &#39;DOCUMENT&#39;                     , 7, 2, x_TAB&#61;&gt;l_TAB, x_O_cnt&#61;&gt;l_O_cnt);&#10;        END IF;&#10;        --&#10;        DECLARE&#10;            CURSOR cs IS&#10;              SELECT /*+ RESULT_CACHE */&#10;                xml_message_id,&#10;                xsd_number,&#10;                source_tables,&#10;                where_clause    AS where_clause,&#10;                where_clause1   AS where_clause1,&#10;                hierarchy_level AS hier_level,&#10;                level_order_by,&#10;                unique_key,&#10;                fk_key,&#10;                parent_xml_message_id&#10;                --Notes&#10;              FROM business_int_xml_summary&#10;              ORDER BY hier_level, level_order_by&#10;            ;&#10;            TYPE l_rec_TYP IS RECORD(&#10;              xml_message_id        BUSINESS_INT_XML_SUMMARY.xml_message_id%TYPE,&#10;              xsd_number            BUSINESS_INT_XML_SUMMARY.xsd_number%TYPE,&#10;              source_tables         BUSINESS_INT_XML_SUMMARY.source_tables%TYPE,&#10;              where_clause          BUSINESS_INT_XML_SUMMARY.where_clause%TYPE,&#10;              where_clause1         BUSINESS_INT_XML_SUMMARY.where_clause1%TYPE,&#10;              hier_level            BUSINESS_INT_XML_SUMMARY.hierarchy_level%TYPE,&#10;              level_order_by        BUSINESS_INT_XML_SUMMARY.level_order_by%TYPE,&#10;              unique_key            BUSINESS_INT_XML_SUMMARY.unique_key%TYPE,&#10;              fk_key                BUSINESS_INT_XML_SUMMARY.fk_key%TYPE,&#10;              parent_xml_message_id BUSINESS_INT_XML_SUMMARY.parent_xml_message_id%TYPE&#10;              --Notes                 BUSINESS_INT_XML_SUMMARY.%TYPE&#10;            );&#10;            TYPE l_tab_TYP IS TABLE OF l_rec_TYP;&#10;            --&#10;            l_rec2 l_rec_TYP;&#10;            l_tab2 l_tab_TYP;&#10;            --&#10;        BEGIN&#10;            --procDebug(&#39;PKG_DynSQL: RESULT_CACHE 3&#39;);&#10;            OPEN cs;&#10;            FETCH cs BULK COLLECT INTO l_tab2;&#10;            CLOSE cs;&#10;            --procDebug(&#39;PKG_DynSQL: RESULT_CACHE 3 (end)&#39;);&#10;            FOR l_idx IN 1..l_tab2.COUNT LOOP&#10;                l_rec2 :&#61; l_tab2(l_idx);&#10;                --&#10;                --procDebug(&#39;add_elem_M START: &#39; || l_M_cnt);&#10;                add_elem_M(&#10;                    p_table_name        &#61;&gt; get_xml_view_name(p_xml_message_id &#61;&gt; l_rec2.xml_message_id, p_xsd_number &#61;&gt; l_rec2.xsd_number),&#10;                    p_parent_table      &#61;&gt; get_xml_view_name(p_xml_message_id &#61;&gt; l_rec2.parent_xml_message_id, p_xsd_number &#61;&gt; l_rec2.xsd_number),&#10;                    p_hier_level        &#61;&gt; l_rec2.hier_level,&#10;                    p_hier_order_by     &#61;&gt; l_rec2.level_order_by,&#10;                    p_pk_col_name       &#61;&gt; l_rec2.unique_key,&#10;                    p_fk_col_name       &#61;&gt; l_rec2.fk_key,&#10;                    p_not_null_col_name &#61;&gt; NULL,&#10;                    p_from_clause       &#61;&gt; l_rec2.source_tables,&#10;                    p_where_clause      &#61;&gt; l_rec2.where_clause,&#10;                    p_where_clause1     &#61;&gt; l_rec2.where_clause1,&#10;                    --&#10;                    p_xsd_number        &#61;&gt; l_rec2.xsd_number,&#10;                    --&#10;                    x_TAB               &#61;&gt; l_TAB,&#10;                    x_M_cnt             &#61;&gt; l_M_cnt );&#10;                --procDebug(&#39;add_elem_M END: &#39; || l_M_cnt);&#10;            END LOOP;&#10;        END;&#10;        --&#10;        l_row :&#61; 0;&#10;        FOR l_i IN REVERSE 1 .. l_TAB.COUNT LOOP&#10;            l_row :&#61; l_row + 1;&#10;            l_tab1.EXTEND;&#10;            l_tab1(l_row) :&#61; l_tab(l_i);&#10;        END LOOP;&#10;        --&#10;        g_TAB_HIER :&#61; l_tab;&#10;        g_TAB1_HIER :&#61; l_tab1;&#10;        g_TAB_HIER_FLAG :&#61; TRUE;&#10;        --&#10;    END IF; --IF NOT g_TAB_HIER_FLAG&#10;    --&#10;    IF p_reverse_order_flag &#61; &#39;Y&#39; THEN&#10;        FOR l_i IN 1 .. g_TAB1_HIER.COUNT LOOP&#10;            PIPE ROW(g_TAB1_HIER(l_i));&#10;        END LOOP;&#10;        --RETURN g_TAB1_HIER;&#10;    ELSE&#10;        FOR l_i IN 1 .. g_TAB_HIER.COUNT LOOP&#10;            PIPE ROW(g_TAB_HIER(l_i));&#10;        END LOOP;&#10;        --RETURN g_TAB_HIER;&#10;    END IF;&#10;    --&#10;END get_tab_list;&#10;--&#10;-- G_TAB_INFO subroutines&#10;--&#10;PROCEDURE print_tab_hier_priv(p_table VARCHAR2, p_level NUMBER DEFAULT 0, p_order_by NUMBER DEFAULT -1)&#10;IS&#10;    l_idx   NUMBER;&#10;    l_tab   PKG_DynSQL.t_hier_tab_TYP;&#10;BEGIN&#10;    IF p_level &gt; 10 THEN&#10;        message(&#39;ERROR in print_tab_hier_priv: recursive level is &gt; than 10!&#39;);&#10;        RETURN;&#10;    END IF;&#10;    --&#10;    message(&#10;        &#39;[&#39; || p_level || &#39;]&#39; ||&#10;        LPAD(&#39; &#39;, p_level * 2) || RPAD(p_table, 30+4) ||&#10;        &#39;[&#39; || p_order_by || &#39;]&#39;&#10;    );&#10;    l_tab :&#61; PKG_DynSQL.get_tab_child_tables(p_table);&#10;    FOR l_idx IN 1..l_tab.COUNT LOOP&#10;        print_tab_hier_priv(l_tab(l_idx).table_name, p_level + 1, l_tab(l_idx).order_by);&#10;    END LOOP;&#10;END print_tab_hier_priv;&#10;--&#10;FUNCTION get_tab_info_CNT RETURN NUMBER IS&#10;BEGIN&#10;    init_tab_info_PRIV;&#10;    RETURN g_tab_info.COUNT;&#10;END get_tab_info_CNT;&#10;--&#10;FUNCTION get_tab_pk_fld_lst(p_table VARCHAR2, p_delim VARCHAR2 DEFAULT &#39;,&#39;, p_num_fld INTEGER DEFAULT 1) RETURN VARCHAR2 IS&#10;BEGIN&#10;    init_tab_info_PRIV;&#10;    --&#10;    IF NOT g_tab_info.EXISTS(UPPER(TRIM(p_table))) THEN&#10;        init_tab_info_PRIV( UPPER(TRIM(p_table)) );&#10;    END IF;&#10;    --&#10;    RETURN&#10;        CASE&#10;            WHEN p_num_fld &#61; -1 THEN&#10;                CASE WHEN NVLSTR(p_delim, &#39;,&#39;) &#61; &#39;,&#39; THEN&#10;                    g_tab_info(UPPER(TRIM(p_table))).pk_fld_lst&#10;                ELSE&#10;                    REPLACE(g_tab_info(UPPER(TRIM(p_table))).pk_fld_lst, &#39;,&#39;, p_delim)&#10;                END&#10;            ELSE&#10;                PKG_LstUtl.list_num_elem(&#10;                    CASE WHEN NVLSTR(p_delim, &#39;,&#39;) &#61; &#39;,&#39; THEN&#10;                        g_tab_info(UPPER(TRIM(p_table))).pk_fld_lst&#10;                    ELSE&#10;                        REPLACE(g_tab_info(UPPER(TRIM(p_table))).pk_fld_lst, &#39;,&#39;, p_delim)&#10;                    END,&#10;                    p_delim,&#10;                    NVL(p_num_fld, 1) )&#10;        END;&#10;EXCEPTION WHEN OTHERS THEN&#10;    raise_application_error(-20001, &#39;ERROR in PKG_DynSQL.get_tab_pk_fld_lst(&#39; || p_table || &#39;, &#39; || p_delim || p_table || &#39;, &#39; || p_num_fld  || p_table || &#39;): &#39; || SQLERRM);&#10;END get_tab_pk_fld_lst;&#10;--&#10;FUNCTION get_tab_fk_fld_lst(p_table VARCHAR2, p_delim VARCHAR2 DEFAULT &#39;,&#39;, p_num_fld INTEGER DEFAULT 1) RETURN VARCHAR2 IS&#10;BEGIN&#10;    init_tab_info_PRIV;&#10;    --&#10;    IF NOT g_tab_info.EXISTS(UPPER(TRIM(p_table))) THEN&#10;        init_tab_info_PRIV( UPPER(TRIM(p_table)) );&#10;    END IF;&#10;    --&#10;    RETURN&#10;        PKG_LstUtl.list_num_elem(&#10;            CASE WHEN NVLSTR(p_delim, &#39;,&#39;) &#61; &#39;,&#39; THEN&#10;                g_tab_info(UPPER(TRIM(p_table))).fk_fld_lst&#10;            ELSE&#10;                REPLACE(g_tab_info(UPPER(TRIM(p_table))).fk_fld_lst, &#39;,&#39;, p_delim)&#10;            END,&#10;            p_delim,&#10;            NVL(p_num_fld, 1)&#10;        );&#10;END get_tab_fk_fld_lst;&#10;--&#10;FUNCTION get_tab_details_PRIV(p_table VARCHAR2, p_hier_level NUMBER, p_ret_fld_name VARCHAR2, p_default_val VARCHAR2) RETURN VARCHAR2&#10;IS&#10;    l_SQL VARCHAR2(4000);&#10;    l_ret VARCHAR2(4000);&#10;BEGIN&#10;    BEGIN&#10;        l_SQL :&#61;&#10;           &#39;SELECT /*+ RESULT_CACHE */ &#39; || p_ret_fld_name || &#39;&#10;            FROM TABLE(PKG_DynSQL.get_tab_list )&#10;            WHERE table_name &#61; :p_table&#10;              AND hier_level &#61; :p_hier_level&#39;;&#10;        --&#10;        --procDebug(&#39;PKG_DynSQL: RESULT_CACHE 4&#39;);&#10;        EXECUTE IMMEDIATE l_SQL&#10;        INTO l_ret&#10;        USING p_table, p_hier_level;&#10;        --procDebug(&#39;PKG_DynSQL: RESULT_CACHE 4 (end)&#39;);&#10;        --&#10;    EXCEPTION WHEN NO_DATA_FOUND THEN&#10;        l_ret :&#61; p_default_val;&#10;    END;&#10;    --&#10;    RETURN l_ret;&#10;EXCEPTION WHEN OTHERS THEN&#10;    raise_application_error( -20001,&#10;        &#39;ERROR in PKG_DynSQL.get_tab_details_PRIV(&#39; ||&#10;        p_table        || &#39;, &#39;  ||&#10;        p_hier_level   || &#39;, &#39;  ||&#10;        p_ret_fld_name || &#39;, &#39;  ||&#10;        p_default_val  || &#39;): &#39; ||&#10;        SQLERRM );&#10;END get_tab_details_PRIV;&#10;--&#10;FUNCTION get_tab_parent_table(p_table VARCHAR2, p_hier_level NUMBER DEFAULT -1) RETURN VARCHAR2&#10;IS&#10;    l_ret VARCHAR2(30);&#10;BEGIN&#10;    init_tab_info_PRIV;&#10;    IF NVL(p_hier_level, -1) &gt; 0 THEN&#10;        l_ret :&#61; get_tab_details_PRIV(p_table, p_hier_level, &#39;PARENT_TABLE&#39;, g_tab_info(UPPER(TRIM(p_table))).parent_table);&#10;    ELSE&#10;        l_ret :&#61; g_tab_info(UPPER(TRIM(p_table))).parent_table;&#10;    END IF;&#10;    --&#10;    RETURN l_ret;&#10;END get_tab_parent_table;&#10;--&#10;FUNCTION get_tab_hier_level(p_table VARCHAR2) RETURN VARCHAR2 IS&#10;BEGIN&#10;    init_tab_info_PRIV;&#10;    RETURN g_tab_info(UPPER(TRIM(p_table))).hier_level;&#10;END get_tab_hier_level;&#10;--&#10;FUNCTION get_tab_from_clause(p_table VARCHAR2) RETURN VARCHAR2 IS&#10;BEGIN&#10;    init_tab_info_PRIV;&#10;    RETURN g_tab_info(UPPER(TRIM(p_table))).from_clause;&#10;END get_tab_from_clause;&#10;--&#10;FUNCTION get_tab_fk_fld_name(p_table VARCHAR2, p_hier_level NUMBER DEFAULT -1) RETURN VARCHAR2&#10;IS&#10;    l_ret VARCHAR2(4000);&#10;BEGIN&#10;    init_tab_info_PRIV;&#10;    IF NVL(p_hier_level, -1) &gt; 0 THEN&#10;        l_ret :&#61; get_tab_details_PRIV(p_table, p_hier_level, &#39;FK_COL_NAME&#39;, g_tab_info(UPPER(TRIM(p_table))).fk_fld_lst);&#10;        IF INSTR(l_ret, &#39;#&#39;) &gt; 0 THEN&#10;            l_ret :&#61; REPLACE(PKG_LstUtl.list_last_elem(l_ret, &#39;.&#39;), &#39;#&#39;, &#39;.&#39;);&#10;        ELSIF INSTR(l_ret, &#39;.&#39;) &gt; 0 THEN&#10;            l_ret :&#61; PKG_LstUtl.list_last_elem(l_ret, &#39;.&#39;);&#10;        END IF;&#10;        --&#10;        --procDebug(&#39;PKG_DynSQL.get_tab_fk_fld_name(&#39; || p_table || &#39;, &#39; || p_hier_level || &#39;): L_RET&#61;&#39; || l_ret);&#10;        --&#10;    ELSE&#10;        l_ret :&#61; g_tab_info(UPPER(TRIM(p_table))).fk_fld_lst;&#10;        --&#10;        --procDebug(&#39;PKG_DynSQL.get_tab_fk_fld_name(1)(&#39; || p_table || &#39;, &#39; || p_hier_level || &#39;): L_RET&#61;&#39; || l_ret);&#10;        --&#10;    END IF;&#10;    --&#10;    RETURN l_ret;&#10;END get_tab_fk_fld_name;&#10;--&#10;FUNCTION get_tab_where_clause(p_table VARCHAR2, p_hier_level NUMBER DEFAULT -1) RETURN VARCHAR2&#10;IS&#10;    l_ret VARCHAR2(4000);&#10;BEGIN&#10;    init_tab_info_PRIV;&#10;    IF NVL(p_hier_level, -1) &gt; 0 THEN&#10;        l_ret :&#61; get_tab_details_PRIV(p_table, p_hier_level, &#39;WHERE_CLAUSE&#39;, g_tab_info(UPPER(TRIM(p_table))).where_clause);&#10;    ELSE&#10;        l_ret :&#61; g_tab_info(UPPER(TRIM(p_table))).where_clause;&#10;    END IF;&#10;    --&#10;    RETURN l_ret;&#10;END get_tab_where_clause;&#10;--&#10;FUNCTION get_tab_where_clause1(p_table VARCHAR2, p_hier_level NUMBER DEFAULT -1) RETURN VARCHAR2&#10;IS&#10;    l_ret VARCHAR2(4000);&#10;BEGIN&#10;    init_tab_info_PRIV;&#10;    IF NVL(p_hier_level, -1) &gt; 0 THEN&#10;        l_ret :&#61; get_tab_details_PRIV(p_table, p_hier_level, &#39;WHERE_CLAUSE1&#39;, g_tab_info(UPPER(TRIM(p_table))).where_clause1);&#10;    ELSE&#10;        l_ret :&#61; g_tab_info(UPPER(TRIM(p_table))).where_clause1;&#10;    END IF;&#10;    --&#10;    RETURN l_ret;&#10;END get_tab_where_clause1;&#10;--&#10;FUNCTION get_tab_child_tables(p_table VARCHAR2) RETURN t_hier_tab_TYP IS&#10;BEGIN&#10;    init_tab_info_PRIV;&#10;    RETURN g_tab_info(UPPER(TRIM(p_table))).child_tables;&#10;EXCEPTION WHEN OTHERS THEN&#10;    raise_application_error(-20001, &#39;ERROR in PKG_DynSQL.get_tab_child_tables([&#39; || p_table || &#39;]): &#39; || SQLERRM);&#10;    --RAISE;&#10;END get_tab_child_tables;&#10;--&#10;FUNCTION get_tab_child_tables1(p_table VARCHAR2) RETURN t_hier_tab_TYP PIPELINED&#10;IS&#10;    l_TAB t_hier_tab_TYP;&#10;BEGIN&#10;    init_tab_info_PRIV;&#10;    l_TAB :&#61; get_tab_child_tables(p_table);&#10;    FOR l_i IN 1 .. l_TAB.COUNT LOOP&#10;        PIPE ROW ( l_TAB(l_i) );&#10;    END LOOP;&#10;END get_tab_child_tables1;&#10;--&#10;FUNCTION get_tab_fld_lst(p_table VARCHAR2) RETURN VARCHAR2 IS&#10;BEGIN&#10;    init_tab_info_PRIV;&#10;    RETURN g_tab_info(UPPER(TRIM(p_table))).fld_lst;&#10;END get_tab_fld_lst;&#10;--&#10;FUNCTION get_tab_fld_lst_1(p_table VARCHAR2) RETURN VARCHAR2 IS&#10;BEGIN&#10;    init_tab_info_PRIV;&#10;    RETURN g_tab_info(UPPER(TRIM(p_table))).fld_lst_1;&#10;END get_tab_fld_lst_1;&#10;&#10;FUNCTION get_rowid_col_name(p_schema VARCHAR2 DEFAULT NULL) RETURN VARCHAR2 IS&#10;BEGIN&#10;    RETURN&#10;        CASE WHEN SUBSTR(NVLSTR(p_schema, &#39;DELIUS_APP_SCHEMA&#39;), 1, 1) &#61; &#39;@&#39; THEN&#10;            &#39;ROW_ID&#39;&#10;        ELSE&#10;            &#39;ROWID&#39;&#10;        END;&#10;END get_rowid_col_name;&#10;--&#10;PROCEDURE convert_tab_column(p_table VARCHAR2, p_col VARCHAR2, p_target_data_type VARCHAR2 DEFAULT &#39;NUMBER&#39;)&#10;IS&#10;    l_SQL VARCHAR2(1024);&#10;BEGIN&#10;    l_SQL :&#61; &#39;ALTER TABLE &#39; || p_table || &#39; ALTER &#39; || p_col || &#39; SET DATA TYPE NUMBER&#39;;&#10;    exec_SQL(l_SQL, p_ignore_err_flag &#61;&gt; &#39;N&#39;, p_print_SQL &#61;&gt; &#39;Y&#39;);&#10;    COMMIT;&#10;END convert_tab_column;&#10;--&#10;-- Database Sequence helpers&#10;--&#10;FUNCTION get_tab_seq_name(p_table VARCHAR2) RETURN VARCHAR2 IS&#10;BEGIN&#10;    RETURN&#10;        CASE&#10;            WHEN p_table &#61; &#39;ADDITIONAL_OFFENCE&#39;             THEN &#39;ADDITIONAL_OFFENCE_SEQ&#39;&#10;            WHEN p_table &#61; &#39;ADDITIONAL_SENTENCE&#39;            THEN &#39;ADDITIONAL_SENTENCE_SEQ&#39;&#10;            WHEN p_table &#61; &#39;APPROVED_PREMISES_PREFERRED&#39;    THEN &#39;AP_PREFERRED_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;APPROVED_PREMISES_REFERRAL&#39;     THEN &#39;AP_REFERRAL_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;APPROVED_PREMISES_RESIDENCE&#39;    THEN &#39;AP_RESIDENCE_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;CASE_ALLOCATION_QUESTION&#39;       THEN &#39;CASE_ALLOCATION_QUEST_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;CATEGORIES&#39;                     THEN &#39;CATEGORIES_CATEGORY_SEQ&#39;&#10;            WHEN p_table &#61; &#39;OBJECT_TYPE_DOCUMENT_TEMPLATE&#39;  THEN &#39;OBJECT_TYPE_DOC_TEMP_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;OFFENDER_DRUG_PROFILE_DRUG&#39;     THEN &#39;OFFENDER_DRUG_PROF_DRUG_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;OFFENDER_DRUG_PROFILE_MEDS&#39;     THEN &#39;OFFENDER_DRUG_PROF_MEDS_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;INSTITUTIONAL_REPORT_TRANSFER&#39;  THEN &#39;INSTITUTIONAL_REP_TRANS_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;SUBJECT_ACCESS_REPORT_CONTACT&#39;  THEN &#39;SUBJECT_ACCESS_REPORT_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;SUBJECT_ACCESS_REPORT_DOCUMENT&#39; THEN &#39;SAR_DOCUMENT_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;PARTITION_AREA&#39;                 THEN &#39;PARTITION_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;TIER_ALLOCATION_QUESTION&#39;       THEN &#39;TIER_ALLOCATION_QUEST_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;UNPAID_WORK_PROJECT&#39;            THEN &#39;UPW_PROJECT_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;UPW_PROJECT_AVAILABILITY&#39;       THEN &#39;UPW_PROJECT_AVAILABILITY_IDSEQ&#39;&#10;            WHEN p_table &#61; &#39;USER_&#39;                          THEN &#39;USER_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;R_ASSESSMENT_TYPE&#39;              THEN &#39;ASSESSMENT_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;R_RQMNT_TYPE_MAIN_CATEGORY&#39;     THEN &#39;RQMNT_TYPE_MAIN_CATEGORY_IDSEQ&#39;&#10;            WHEN p_table &#61; &#39;R_AD_RQMNT_TYPE_MAIN_CATEGORY&#39;  THEN &#39;AD_RQMNT_TYPE_MAIN_CAT_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;R_PSS_RQMNT_TYPE_MAIN_CATEGORY&#39; THEN &#39;PSS_RQMNT_TYPE_MAIN_CAT_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;R_PSS_RQMNT_TYPE_SUB_CATEGORY&#39;  THEN &#39;PSS_RQMNT_TYPE_SUB_CAT_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;R_REGISTER_DUPLICATE_GROUP&#39;     THEN &#39;REGISTER_GROUP_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;R_REGISTER_TYPE_DUP_GRP&#39;        THEN &#39;REGISTER_TYPE_DUP_GRP_SEQ&#39;&#10;            WHEN p_table &#61; &#39;R_POST_CJA_LIC_CONDITION_TYPE&#39;  THEN &#39;POST_CJA_LIC_COND_TYPE_ID_SEQ&#39;&#10;            WHEN p_table &#61; &#39;R_TIER_ALLOC_QUESTION_TIER&#39;     THEN &#39;TIER_ALLOC_QUESTION_TIER_IDSEQ&#39;&#10;            WHEN SUBSTR(p_table, 1, 2) &#61; &#39;R_&#39;               THEN SUBSTR(p_table, 3) || &#39;_ID_SEQ&#39;&#10;&#10;            --WHEN p_table &#61; &#39;&#39;                     THEN &#39;&#39;&#10;        ELSE&#10;            p_table || &#39;_ID_SEQ&#39;&#10;        END;&#10;END get_tab_seq_name;&#10;--&#10;FUNCTION get_seq_tab_name(p_seq VARCHAR2) RETURN VARCHAR2&#10;IS&#10;    --&#10;    CURSOR cs IS&#10;      WITH T0 AS (&#10;        SELECT DISTINCT table_name&#10;        FROM TABLE( PKG_DynSQL.get_tab_list ) ),&#10;      T AS (&#10;        SELECT table_name, PKG_DynSQL.get_tab_seq_name(table_name) AS seq_name&#10;        FROM T0 )&#10;      SELECT table_name&#10;      FROM T&#10;      WHERE seq_name &#61; p_seq;&#10;    --&#10;    l_table VARCHAR2(100);&#10;    l_dummy VARCHAR2(1);&#10;    l_found BOOLEAN;&#10;    --&#10;BEGIN&#10;    --&#10;    OPEN cs;&#10;    FETCH cs INTO l_table;&#10;    l_found :&#61; cs%FOUND;&#10;    CLOSE cs;&#10;    --&#10;    IF NOT l_found THEN&#10;        --&#10;        l_table :&#61; RTRIM(RTRIM(p_seq, &#39;SEQ&#39;), &#39;ID_&#39;);&#10;        --&#10;        IF SUBSTR(l_table, -1, 1) &#61; &#39;_&#39; AND l_table NOT IN (&#39;USER_&#39;)THEN&#10;            l_table :&#61; SUBSTR(l_table, -2);&#10;        END IF;&#10;        --&#10;        BEGIN&#10;            SELECT &#39;Y&#39; INTO l_dummy&#10;            FROM user_tables&#10;            WHERE table_name &#61; &#39;R_&#39; || l_table;&#10;            l_table :&#61; &#39;R_&#39; || l_table;&#10;        EXCEPTION WHEN NO_DATA_FOUND THEN&#10;            NULL;&#10;        END;&#10;        --&#10;    END IF;&#10;    --&#10;    RETURN l_table;&#10;END get_seq_tab_name;&#10;--&#10;PROCEDURE set_tab_seq_value(&#10;    p_name       VARCHAR2,&#10;    p_val        NUMBER,&#10;    p_debug_flag VARCHAR2 DEFAULT &#39;Y&#39;)&#10;IS&#10;    --&#10;    l_sql         VARCHAR2(500);&#10;    l_curr_id     NUMBER;&#10;    l_inc_by      NUMBER;&#10;    l_inc_by_CHAR VARCHAR2(100);&#10;    l_new_id      NUMBER;&#10;    l_min_value   NUMBER;&#10;    l_max_value   NUMBER :&#61; 900000000000000000;&#10;    l_cache_size  NUMBER;&#10;    --&#10;    l_debug       BOOLEAN :&#61; ( NVLSTR(p_debug_flag, &#39;N&#39;) &#61; &#39;Y&#39; );&#10;    --&#10;BEGIN&#10;    --&#10;    SELECT NVL(min_value, 0), NVL(cache_size, 1), last_number INTO l_min_value, l_cache_size, l_curr_id&#10;    FROM user_sequences&#10;    WHERE sequence_name &#61; p_name;&#10;    --&#10;    l_sql :&#61; &#39;ALTER SEQUENCE &#39; || p_name || &#39; INCREMENT BY 1 /*CACHE 1*/&#39;;&#10;    IF l_debug THEN&#10;        message(l_SQL);&#10;    ELSE&#10;        EXECUTE IMMEDIATE l_sql;&#10;    END IF;&#10;    --&#10;    l_curr_id :&#61; TO_NUMBER(&#10;        PKG_Lookups.funcgetTabRecord(&#10;            p_data_fld  &#61;&gt; p_name || &#39;.NEXTVAL&#39;,&#10;            p_table     &#61;&gt; &#39;dual&#39;,&#10;            p_ref_col   &#61;&gt; &#39;1&#39;,&#10;            p_ref_val   &#61;&gt; &#39;1&#39; ) );&#10;    --&#10;    IF p_val &lt;&gt; l_curr_id THEN&#10;        --&#10;        l_inc_by :&#61; GREATEST(p_val, l_min_value) - l_curr_id;&#10;        l_inc_by_CHAR :&#61; TO_CHAR(l_inc_by);&#10;        IF SUBSTR(l_inc_by_CHAR, -2) &#61; &#39;.0&#39; THEN&#10;            l_inc_by_CHAR :&#61; SUBSTR(l_inc_by_CHAR, 1, LENGTH(l_inc_by_CHAR) - 2);&#10;        END IF;&#10;        --&#10;        message(&#39;Sequence &#39; || p_name || &#39;: NEXTVAL is &#39; || l_curr_id || &#39;; Incrementing value BY &#39; || l_inc_by_CHAR);&#10;        --&#10;        IF l_inc_by &lt;&gt; 0 THEN&#10;            l_sql :&#61; &#39;ALTER SEQUENCE &#39; || p_name || &#39; INCREMENT BY &#39; || l_inc_by_CHAR || &#39; /*CACHE 1*/&#39;;&#10;            IF l_debug THEN&#10;                message(l_SQL);&#10;            ELSE&#10;                EXECUTE IMMEDIATE l_sql;&#10;            END IF;&#10;            --&#10;            l_new_id :&#61; TO_NUMBER(&#10;                PKG_Lookups.funcgetTabRecord(&#10;                    p_data_fld  &#61;&gt; p_name || &#39;.NEXTVAL&#39;,&#10;                    p_table     &#61;&gt; &#39;dual&#39;,&#10;                    p_ref_col   &#61;&gt; &#39;1&#39;,&#10;                    p_ref_val   &#61;&gt; &#39;1&#39; ) );&#10;            --&#10;            message(&#39;Sequence &#39; || p_name || &#39; IS NOW AT &#39; || l_new_id);&#10;        END IF;&#10;    ELSE&#10;        message(&#39;Sequence &#39; || p_name || &#39; IS LEFT AT &#39; || l_curr_id);&#10;    END IF;&#10;    --&#10;    l_sql :&#61; &#39;ALTER SEQUENCE &#39; || p_name ||  &#39; INCREMENT BY 1 MAXVALUE &#39; || l_max_value || &#39; CACHE &#39; || l_cache_size;&#10;    IF l_debug THEN&#10;        message(l_SQL);&#10;    ELSE&#10;        EXECUTE IMMEDIATE l_sql;&#10;    END IF;&#10;    --&#10;EXCEPTION WHEN OTHERS THEN&#10;    raise_error(&#39;ERROR in PKG_DynSQL.set_tab_seq_value &#39; ||&#10;        &#39;(seq_name&#61;&#39; || p_name      || &#39;)&#39; ||&#10;        &#39;(seq_val&#61;&#39;  || p_val       || &#39;)&#39; ||&#10;        &#39;(curr_val&#61;&#39; || l_curr_id   || &#39;)&#39; ||&#10;        &#39;(inc_by&#61;&#39;   || l_new_id    || &#39;)&#39; ||&#10;        &#39;(min_val&#61;&#39;  || l_min_value || &#39;): &#39; ||&#10;        SQLERRM,&#10;        &#39;PKG_DynSQL.set_tab_seq_value&#39; );&#10;    RAISE;&#10;END set_tab_seq_value;&#10;--&#10;PROCEDURE fix_tab_seq_values&#10;IS&#10;    --&#10;    TYPE l_rec_TYP IS RECORD(&#10;      table_name    VARCHAR2(30),&#10;      seq_name      VARCHAR2(30),&#10;      pk_col        VARCHAR2(30),&#10;      pk_col_FULL   VARCHAR2(1024),&#10;      pk_max_val    NUMBER,&#10;      seq_curr_val  NUMBER );&#10;    TYPE l_tab_TYP IS TABLE OF l_rec_TYP;&#10;    l_tab l_tab_TYP;&#10;    --&#10;    CURSOR cs IS&#10;      WITH T AS (&#10;        SELECT&#10;          T.table_name,&#10;          PKG_DynSQL.get_tab_seq_name(T.table_name)    AS seq_name,&#10;          PKG_DynSQL.get_tab_pk_fld_lst(T.table_name)  AS pk_col,&#10;          PKG_Lookups.funcGetTabPkFields(T.table_name) AS pk_col_FULL,&#10;          PKG_Lookups.funcgetTabRecord(&#10;              p_data_fld    &#61;&gt; &#39;MAX(&#39; || PKG_DynSQL.get_tab_pk_fld_lst(T.table_name) || &#39;)&#39;,&#10;              p_default_val &#61;&gt; &#39;0&#39;,&#10;              p_table       &#61;&gt; T.table_name,&#10;              p_ref_col     &#61;&gt; &#39;1&#39;,&#10;              p_ref_val     &#61;&gt; &#39;1&#39; )                  AS pk_max_val,&#10;          S.last_number                               AS seq_curr_val&#10;        FROM&#10;          ( SELECT DISTINCT table_type, table_name FROM TABLE( PKG_DynSQL.get_tab_list ) WHERE table_type IN (&#39;O&#39;, &#39;R&#39;) ORDER BY table_type, table_name ) T&#10;            INNER JOIN user_sequences S ON sequence_name &#61; PKG_DynSQL.get_tab_seq_name(T.table_name)&#10;        WHERE 1&#61;1&#10;          AND EXISTS(&#10;              SELECT 1&#10;              FROM user_sequences&#10;              WHERE sequence_name &#61; PKG_DynSQL.get_tab_seq_name(T.table_name) )&#10;          AND EXISTS(&#10;              SELECT 1&#10;              FROM user_tab_columns&#10;              WHERE table_name &#61; T.table_name&#10;                AND column_name &#61; PKG_DynSQL.get_tab_pk_fld_lst(T.table_name) )&#10;          AND T.table_name NOT IN (&#39;R_ASSESSMENT_TYPE&#39;)&#10;        ORDER BY T.table_type, T.table_name )&#10;      SELECT *&#10;      FROM T&#10;      WHERE pk_max_val &gt; seq_curr_val&#10;        AND pk_col_FULL NOT LIKE &#39;%:%&#39;;&#10;    --&#10;BEGIN&#10;    OPEN cs;&#10;    FETCH cs BULK COLLECT INTO l_tab;&#10;    CLOSE cs;&#10;    --&#10;    FOR l_i IN 1 .. l_tab.COUNT LOOP&#10;        --&#10;        message(&#10;            RPAD(&#39;TABLE&#61;&#39;        || l_tab(l_i).table_name, 40) ||&#10;            RPAD(&#39;SEQ_NAME&#61;&#39;     || l_tab(l_i).seq_name  , 40) ||&#10;            RPAD(&#39;PK_COL&#61;&#39;       || l_tab(l_i).pk_col    , 40) ||&#10;            RPAD(&#39;PK_VAL&#61;&#39;       || l_tab(l_i).pk_max_val, 40) ||&#10;            RPAD(&#39;SEQ_CURR_VAL&#61;&#39; || l_tab(l_i).seq_curr_val, 40) );&#10;        --&#10;        IF l_tab(l_i).pk_max_val &gt; 0 THEN&#10;            set_tab_seq_value(&#10;                p_name       &#61;&gt; l_tab(l_i).seq_name,&#10;                p_val        &#61;&gt; l_tab(l_i).pk_max_val,&#10;                p_debug_flag &#61;&gt; &#39;N&#39; );&#10;        END IF;&#10;        --&#10;    END LOOP;&#10;    --&#10;END fix_tab_seq_values;&#10;--&#10;PROCEDURE offender_records_iterator(&#10;    p_offender_id            NUMBER,&#10;    p_tab_name               VARCHAR2,&#10;    p_row_id                 ROWID,&#10;    p_dyn_SQL                VARCHAR2,&#10;    p_when_to_execute        VARCHAR2 DEFAULT &#39;POST&#39;,&#10;    p_debug_message          VARCHAR2 DEFAULT NULL,&#10;    p_recursive_level        INTEGER  DEFAULT 1,&#10;    p_parent_table           VARCHAR2 DEFAULT NULL,&#10;    p_parent_row_id          ROWID    DEFAULT NULL,&#10;    p_skip_subtrees          VARCHAR2 DEFAULT NULL,&#10;    p_check_offender_id_flag VARCHAR2 DEFAULT &#39;N&#39;,&#10;    p_actual_offender_id     NUMBER   DEFAULT NULL,&#10;    p_ignore_where_clause    VARCHAR2 DEFAULT &#39;N&#39; )&#10;IS&#10;    l_proc VARCHAR2(32) :&#61; &#39;OFFENDER_RECORDS_ITERATOR&#39;;&#10;    --&#10;BEGIN&#10;    --&#10;    PKG_hier_support.offender_records_iterator(&#10;        p_offender_id            &#61;&gt; p_offender_id,&#10;        p_tab_name               &#61;&gt; p_tab_name,&#10;        p_row_id                 &#61;&gt; p_row_id,&#10;        p_dyn_SQL                &#61;&gt; p_dyn_SQL,&#10;        p_when_to_execute        &#61;&gt; p_when_to_execute,&#10;        p_debug_message          &#61;&gt; p_debug_message,&#10;        p_recursive_level        &#61;&gt; p_recursive_level,&#10;        p_parent_table           &#61;&gt; p_parent_table,&#10;        p_parent_row_id          &#61;&gt; p_parent_row_id,&#10;        p_skip_subtrees          &#61;&gt; p_skip_subtrees,&#10;        p_check_offender_id_flag &#61;&gt; p_check_offender_id_flag,&#10;        p_actual_offender_id     &#61;&gt; p_actual_offender_id,&#10;        p_ignore_where_clause    &#61;&gt; p_ignore_where_clause );&#10;    --&#10;END offender_records_iterator;&#10;--&#10;PROCEDURE seed_tab_hierarchy IS&#10;BEGIN&#10;    --&#10;    PKG_hier_support.seed_tab_hierarchy;&#10;    --&#10;END seed_tab_hierarchy;&#10;--&#10;FUNCTION get_offender_hierarchy_tab RETURN PKG_hier_support.g_tab2_hier_TAB_TYP PIPELINED&#10;IS&#10;    --&#10;    CURSOR cs IS&#10;      SELECT *&#10;      FROM TABLE( PKG_hier_support.get_offender_hierarchy_tab );&#10;    --&#10;    l_rec cs%ROWTYPE;&#10;    --&#10;BEGIN&#10;    --&#10;    OPEN cs;&#10;    LOOP&#10;        FETCH cs INTO l_rec;&#10;        EXIT WHEN cs%NOTFOUND;&#10;        --&#10;        PIPE ROW (l_rec);&#10;        END LOOP;&#10;        --&#10;END get_offender_hierarchy_tab;&#10;&#10;&#10;&#10;--&#10;--&#10;--&#10;PROCEDURE do_init IS&#10;BEGIN&#10;    -- Required for OPEN_CONN API&#10;    G_CONN_NAME :&#61; &#39;exec_sql_atnm&#39; || PKG_Common.get_session_name;&#10;    --&#10;END do_init;&#10;--&#10;--&#10;--&#10;BEGIN&#10;--&#10;--&#10;    PKG_Global.do_init;&#10;    do_init;&#10;--&#10;--&#10;END PKG_DynSQL;</textarea>
                        </div>
                    </div>
                </section>
            </div>
            <!-- /.content-wrapper -->
            <footer class="main-footer">
                <div>
                    <div class="pull-right hidden-xs">
                        <a href="https://github.com/schemaspy/schemaspy" title="GitHub for SchemaSpy"><i class="fa fa-github-square fa-2x"></i></a>
                        <a href="http://stackoverflow.com/questions/tagged/schemaspy" title="StackOverflow for SchemaSpy"><i class="fa fa-stack-overflow fa-2x"></i></a>
                    </div>
                    <strong>Generated by <a href="http://schemaspy.org/" class="logo-text"><i class="fa fa-database"></i> SchemaSpy 6.2.4</a></strong>
                </div>
                <!-- /.container -->
            </footer>
        </div>
        <!-- ./wrapper -->

        <!-- jQuery 2.2.3 -->
        <script src="../bower/admin-lte/plugins/jQuery/jquery-2.2.3.min.js"></script>
        <script src="../bower/admin-lte/plugins/jQueryUI/jquery-ui.min.js"></script>
        <!-- Bootstrap 3.3.5 -->
        <script src="../bower/admin-lte/bootstrap/js/bootstrap.min.js"></script>
        <!-- DataTables -->
        <script src="../bower/datatables.net/jquery.dataTables.min.js"></script>
        <script src="../bower/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
        <script src="../bower/datatables.net-buttons/dataTables.buttons.min.js"></script>
        <script src="../bower/datatables.net-buttons-bs/js/buttons.bootstrap.min.js"></script>
        <script src="../bower/datatables.net-buttons/buttons.html5.min.js"></script>
        <script src="../bower/datatables.net-buttons/buttons.print.min.js"></script>
        <script src="../bower/datatables.net-buttons/buttons.colVis.min.js"></script>
        <!-- SheetJS -->
        <script src="../bower/js-xlsx/xlsx.full.min.js"></script>
        <!-- pdfmake -->
        <script src="../bower/pdfmake/pdfmake.min.js"></script>
        <script src="../bower/pdfmake/vfs_fonts.js"></script>
        <!-- SlimScroll -->
        <script src="../bower/admin-lte/plugins/slimScroll/jquery.slimscroll.min.js"></script>
        <!-- FastClick -->
        <script src="../bower/admin-lte/plugins/fastclick/fastclick.js"></script>
        <!-- Salvattore -->
        <script src="../bower/salvattore/salvattore.min.js"></script>
        <!-- AnchorJS -->
        <script src="../bower/anchor-js/anchor.min.js"></script>
        <!-- CodeMirror -->
        <script src="../bower/codemirror/codemirror.js"></script>
        <script src="../bower/codemirror/sql.js"></script>
        <!-- AdminLTE App -->
        <script src="../bower/admin-lte/dist/js/app.min.js"></script>
        <script src="routine.js"></script>
        <script src="../schemaSpy.js"></script>
    </body>
</html>
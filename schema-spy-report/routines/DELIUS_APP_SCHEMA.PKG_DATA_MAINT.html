<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>TSTNDA.DELIUS_APP_SCHEMA</title>
        <!-- Tell the browser to be responsive to screen width -->
        <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
        <link rel="icon" type="image/png" sizes="16x16" href="../favicon.png">
        <!-- Bootstrap 3.3.5 -->
        <link rel="stylesheet" href="../bower/admin-lte/bootstrap/css/bootstrap.min.css">
        <!-- Font Awesome -->
        <link rel="stylesheet" href="../bower/font-awesome/css/font-awesome.min.css">
        <!-- Ionicons -->
        <link rel="stylesheet" href="../bower/ionicons/css/ionicons.min.css">
        <!-- DataTables -->
        <link rel="stylesheet" href="../bower/datatables.net-bs/css/dataTables.bootstrap.min.css">
        <link rel="stylesheet" href="../bower/datatables.net-buttons-bs/css/buttons.bootstrap.min.css">
        <!-- Code Mirror -->
        <link rel="stylesheet" href="../bower/codemirror/codemirror.css">
        <!-- Fonts -->
        <link href='../fonts/indieflower/indie-flower.css' rel='stylesheet' type='text/css'>
        <link href='../fonts/source-sans-pro/source-sans-pro.css' rel='stylesheet' type='text/css'>

        <!-- Theme style -->
        <link rel="stylesheet" href="../bower/admin-lte/dist/css/AdminLTE.min.css">
        <!-- Salvattore -->
        <link rel="stylesheet" href="../bower/salvattore/salvattore.css">
        <!-- AdminLTE Skins. Choose a skin from the css/skins
           folder instead of downloading all of them to reduce the load. -->
        <link rel="stylesheet" href="../bower/admin-lte/dist/css/skins/_all-skins.min.css">
        <!-- SchemaSpy -->
        <link rel="stylesheet" href="../schemaSpy.css">

        <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
        <script src="../bower/html5shiv/html5shiv.min.js"></script>
        <script src="../bower/respond/respond.min.js"></script>
        <![endif]-->
    </head>
    <!-- ADD THE CLASS layout-top-nav TO REMOVE THE SIDEBAR. -->
    <body class="hold-transition skin-blue layout-top-nav">
        <div class="wrapper">
            <header class="main-header">
                <nav class="navbar navbar-static-top">
                    <div class="container">
                        <div class="navbar-header">
                            <a href="../index.html" class="navbar-brand"><b>TSTNDA</b></a><span class="navbar-brand" style="padding-left: 0">.DELIUS_APP_SCHEMA</span>
                            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse"><i class="fa fa-bars"></i></button>
                        </div>

                        <!-- Collect the nav links, forms, and other content for toggling -->
                        <div class="collapse navbar-collapse pull-left" id="navbar-collapse">
                            <ul class="nav navbar-nav">
                                <li><a href="../index.html">Tables <span class="sr-only">(current)</span></a></li>
                                <li><a href="../columns.html" title="All of the columns in the schema">Columns</a></li>
                                <li><a href="../constraints.html" title="Useful for diagnosing error messages that just give constraint name or number">Constraints</a></li>
                                <li><a href="../relationships.html" title="Diagram of table relationships">Relationships</a></li>
                                <li><a href="../orphans.html" title="View of tables with neither parents nor children">Orphan&nbsp;Tables</a></li>
                                <li><a href="../anomalies.html" title="Things that might not be quite right">Anomalies</a></li>
                                <li><a href="../routines.html" title="Procedures and functions">Routines</a></li>
                            </ul>
                        </div>
                        <!-- /.navbar-collapse -->
                        <!-- Navbar Right Menu -->
                    </div>
                    <!-- /.container-fluid -->
                </nav>
            </header>
            <!-- Main content -->
            <!-- Full Width Column -->
            <div class="content-wrapper">
                <!-- Content Header (Page header) -->
                <section class="content-header">
                    <h1>DELIUS_APP_SCHEMA.PKG_DATA_MAINT</h1><br />
                </section>
                <!-- Main content -->
                <section class="content">
                    <div class="box box-primary">
                        <div class="box-header with-border">
                            <span class="glyphicon glyphicon-list-alt" aria-hidden="true"></span>
                            <h3 id="Columns" class="box-title">Parameters</h3>
                            <div class="box-tools pull-right">
                                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                                <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                            </div>
                        </div>
                        <div class="box-body">
                            <table id="standard_table" class="table table-bordered table-striped dataTable" role="grid">
                                <thead align='left'>
                                <tr>
                                    <th>Name</th>
                                    <th>Type</th>
                                    <th>Mode</th>
                                </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="box box-primary">
                        <div class="box-header with-border">
                            <i class="fa fa-file-code-o"></i>
                            <h3 id="RoutineDefinition" class="box-title">Definition</h3>
                            <div class="box-tools pull-right">
                                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                                <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                            </div>
                        </div>
                        <div class="box-body">
                            <textarea id="sql-script-codemirror" name="sql-script-codemirror" rows="" style="display: none;">PACKAGE BODY pkg_data_maint&#10;AS&#10;--&#10;--&#10;--&#10;&#10;-- Global Variables&#10;g_component_code  CONSTANT VARCHAR2(3)  :&#61; &#39;DMN&#39;;&#10;g_package_name    CONSTANT VARCHAR2(30) :&#61; &#39;PKG_DATA_MAINT&#39;;&#10;--&#10;g_procedure_name  VARCHAR2(30)  :&#61; &#39;initial_value&#39;;&#10;g_label           VARCHAR2(6)   :&#61; &#39;000000&#39;;&#10;--&#10;-- message type&#10;mt_information    CONSTANT NUMBER :&#61; 1;&#10;mt_warning        CONSTANT NUMBER :&#61; 2;&#10;mt_error          CONSTANT NUMBER :&#61; 3;&#10;mt_fatal_error    CONSTANT NUMBER :&#61; 4;&#10;&#10;GC_RUN_MODE VARCHAR2(1) :&#61; &#39;S&#39;;&#10;&#10;LC_TRANSFER_TABLES T_TAB_ORGANISATIONS :&#61;&#10;    T_TAB_ORGANISATIONS(&#10;        &#39;OFFENDER_TRANSFER&#39;,&#10;        &#39;ORDER_TRANSFER&#39;,&#10;        &#39;LIC_CONDITION_TRANSFER&#39;,&#10;        &#39;RQMNT_TRANSFER&#39;,&#10;        &#39;NSI_TRANSFER&#39;,&#10;        &#39;PSS_RQMNT_TRANSFER&#39;,&#10;        &#39;COURT_REPORT_TRANSFER&#39;,&#10;        &#39;INSTITUTIONAL_REPORT_TRANSFER&#39; );&#10;&#10;--&#10;--&#10;--&#10;--&#10;--***************************************************&#10;-- PKG_COMMON wrappers                              *&#10;--***************************************************&#10;--&#10;FUNCTION is_str_empty(p_str VARCHAR2, p_ignore_spaces_and_zeroes VARCHAR2 DEFAULT &#39;N&#39;) RETURN VARCHAR2 IS&#10;BEGIN&#10;    RETURN PKG_Common.is_str_empty( p_str, p_ignore_spaces_and_zeroes );&#10;END is_str_empty;&#10;--&#10;FUNCTION empty2null(p_str VARCHAR2) RETURN VARCHAR2 IS&#10;BEGIN&#10;    RETURN PKG_Common.empty2null(p_str);&#10;END empty2null;&#10;--&#10;FUNCTION nvlstr(p_str1 VARCHAR2, p_str2 VARCHAR2) RETURN VARCHAR2 IS&#10;BEGIN&#10;    RETURN PKG_Common.nvl2(empty2null(p_str1), empty2null(p_str2));&#10;END nvlstr;&#10;--&#10;PROCEDURE raise_error(p_err_msg VARCHAR2, p_proc VARCHAR2, p_label VARCHAR2 DEFAULT NULL) IS&#10;BEGIN&#10;    PKG_Common.raise_error( p_err_msg, p_proc, p_label );&#10;END raise_error;&#10;--&#10;PROCEDURE print_line(p_line VARCHAR2)&#10;IS&#10;BEGIN&#10;    PKG_Common.print_message(p_line, p_log_output_flag&#61;&gt;&#39;R&#39;);&#10;END print_line;&#10;--&#10;--&#10;--***************************************************&#10;-- Helpers                                          *&#10;--***************************************************&#10;--&#10;-- Used to populate mtt_message_log with information type message&#10;PROCEDURE info(p_message VARCHAR2) IS&#10;BEGIN&#10;    SPGConfig.insert_message_log(&#10;        message_type_id_in  &#61;&gt; mt_information,&#10;        component_code_in   &#61;&gt; g_component_code,&#10;        package_name_in     &#61;&gt; g_package_name,&#10;        procedure_name_in   &#61;&gt; g_procedure_name,&#10;        label_in            &#61;&gt; g_label,&#10;        message_text_in     &#61;&gt; p_message );&#10;END info;&#10;--&#10;-- Will populate mtt_message_log with warning message - will populate mtt_error_log if result of exception&#10;PROCEDURE warn(p_message VARCHAR2) IS&#10;BEGIN&#10;    SPGConfig.record_error(&#10;        message_type_id_in    &#61;&gt; mt_warning,&#10;        component_code_in     &#61;&gt; g_component_code,&#10;        package_name_in       &#61;&gt; g_package_name,&#10;        procedure_name_in     &#61;&gt; g_procedure_name,&#10;        label_in              &#61;&gt; g_label,&#10;        message_text_in       &#61;&gt; p_message );&#10;END warn;&#10;--&#10;-- Will populate mtt_message_log with error message and populate mtt_error_log with exception - used for log and continue&#10;PROCEDURE error(p_message VARCHAR2) IS&#10;BEGIN&#10;    SPGConfig.record_error(&#10;        message_type_id_in    &#61;&gt; mt_error,&#10;        component_code_in     &#61;&gt; g_component_code,&#10;        package_name_in       &#61;&gt; g_package_name,&#10;        procedure_name_in     &#61;&gt; g_procedure_name,&#10;        label_in              &#61;&gt; g_label,&#10;        message_text_in       &#61;&gt; p_message );&#10;END error;&#10;--&#10;-- Will populate mtt_message_log, mtt_error_log with error message and raise exception - used for log and halt&#10;PROCEDURE fatal(p_message VARCHAR2) IS&#10;BEGIN&#10;    SPGConfig.record_error(&#10;        message_type_id_in    &#61;&gt; mt_fatal_error,&#10;        component_code_in     &#61;&gt; g_component_code,&#10;        package_name_in       &#61;&gt; g_package_name,&#10;        procedure_name_in     &#61;&gt; g_procedure_name,&#10;        label_in              &#61;&gt; g_label,&#10;        message_text_in       &#61;&gt; p_message,&#10;        raise_error_in        &#61;&gt; TRUE );&#10;END fatal;&#10;--&#10;PROCEDURE debug_message(p_msg VARCHAR2, p_trace_level INTEGER DEFAULT 0) IS&#10;BEGIN&#10;    --&#10;    IF GC_RUN_MODE &#61; &#39;S&#39; THEN&#10;        PKG_Common.print_message(&#10;            p_msg         &#61;&gt; p_msg,&#10;            p_trace_level &#61;&gt; NVL(p_trace_level, PKG_Common.GC_TRACE_LEVEL),&#10;            p_label       &#61;&gt; g_label );&#10;    END IF;&#10;    --&#10;    warn(&#39;[&#39; || g_label || &#39;] &#39; || p_msg);&#10;    --&#10;END debug_message;&#10;--&#10;--&#10;--&#10;/*-----------------------------------------------------------------------------------------&#10;|&#10;| Generic report routines&#10;|&#10;-------------------------------------------------------------------------------------------&#10;*/&#10;PROCEDURE init_report(p_rows INTEGER, p_cols INTEGER) IS&#10;BEGIN&#10;    PKG_CRC_RPT.init_report(p_rows, p_cols);&#10;END init_report;&#10;--&#10;FUNCTION get_txt(p_text VARCHAR2, p_align_flag VARCHAR2, p_line_len INTEGER, p_what_to_print VARCHAR2 DEFAULT NULL) RETURN VARCHAR2 IS&#10;BEGIN&#10;    RETURN PKG_CRC_RPT.get_txt(p_text, p_align_flag, p_line_len, p_what_to_print);&#10;END get_txt;&#10;--&#10;PROCEDURE do_add_col_def(&#10;    p_cols_tab  IN OUT  PKG_CRC_RPT.rpt_cols_TAB_TYP,&#10;    p_col_num           INTEGER,&#10;    p_val_type          VARCHAR2,&#10;    p_max_size          INTEGER,&#10;    p_align_flag        VARCHAR2,&#10;    p_wrap_flag         VARCHAR2,&#10;    p_name              VARCHAR2,&#10;    p_title             VARCHAR2,&#10;    p_value             VARCHAR2 DEFAULT &#39;&#39;) IS&#10;BEGIN&#10;    PKG_CRC_RPT.do_add_col_def(p_cols_tab, p_col_num, p_val_type, p_max_size, p_align_flag, p_wrap_flag, p_name, p_title, p_value);&#10;END do_add_col_def;&#10;--&#10;PROCEDURE do_print_line_buf(p_cols_tab  IN OUT PKG_CRC_RPT.rpt_cols_TAB_TYP, p_what_to_print VARCHAR2) IS&#10;BEGIN&#10;    PKG_CRC_RPT.do_print_line_buf(p_cols_tab, p_what_to_print);&#10;END do_print_line_buf;&#10;--&#10;PROCEDURE do_print_rpt_title(p_title VARCHAR2) IS&#10;BEGIN&#10;    PKG_CRC_RPT.do_print_rpt_title(p_title);&#10;END do_print_rpt_title;&#10;--&#10;&#10;--&#10;----------------------------------------------------------------------------------------------&#10;--&#10;-- DO_TERMINATE_PENDING_TRANSFERS&#10;--&#10;----------------------------------------------------------------------------------------------&#10;PROCEDURE do_terminate_pending_transfers(&#10;    p_area             VARCHAR2,&#10;    p_direction        VARCHAR2,&#10;    p_transfer_type    VARCHAR2,&#10;    --&#10;    p_offender_id      NUMBER,&#10;    --&#10;    p_event_id         NUMBER   DEFAULT NULL,&#10;    p_transfer_id      NUMBER   DEFAULT NULL,&#10;    p_excl_tr_id_lst   VARCHAR2 DEFAULT NULL,&#10;    p_termination_date DATE     DEFAULT NULL,&#10;    p_transfer_notes   VARCHAR2 DEFAULT NULL,&#10;    p_report_only_flag VARCHAR2 DEFAULT &#39;N&#39; )&#10;IS&#10;    --&#10;    TYPE l_rec_master_transfer_TYP IS RECORD(&#10;        master_transfer_id  NUMBER,&#10;        offender_id         NUMBER,&#10;        crn                 OFFENDER.crn%TYPE,&#10;        transfer_direction  VARCHAR2(1),&#10;        origin_provider_id  NUMBER,&#10;        target_provider_id  NUMBER,&#10;        interested_crc_list T_TAB_ORGANISATIONS );&#10;    TYPE l_tab_master_transfer_TYP IS TABLE OF l_rec_master_transfer_TYP INDEX BY BINARY_INTEGER;&#10;    --&#10;    LC_USER_ID          NUMBER :&#61; PKG_LOOKUPS.GetUserID(p_distinguished_name &#61;&gt; PKG_Common.NVLSTR(SYS_CONTEXT(&#39;USERENV&#39;, &#39;CLIENT_IDENTIFIER&#39;), &#39;[Data Maintenance]&#39;));&#10;    LC_UPDATED_DATETIME DATE   :&#61; SYSDATE;&#10;    --&#10;    l_termination_date DATE;&#10;    --&#10;    l_rec_master_transfer l_rec_master_transfer_TYP;&#10;    l_tab_master_transfer l_tab_master_transfer_TYP;&#10;    --&#10;    CURSOR csTransfers IS&#10;      WITH PT_0 AS (&#10;        --&#10;        -- OFFENDER_TRANSFER&#10;        --&#10;        SELECT&#10;          MT.master_transfer_id,&#10;          MT.transfer_date,&#10;          OT.offender_transfer_id                   AS transfer_id,&#10;          &#39;OFFENDER_TRANSFER&#39;                       AS source_table,&#10;          OT.origin_team_id,&#10;          OT.receiving_team_id,&#10;          OT.transfer_status_id,&#10;          --&#10;          OT.request_date                           AS transfer_request_date,&#10;          OT.receiving_staff_id,&#10;          OT.origin_staff_id,&#10;          OT.offender_id,&#10;          OT.offender_transfer_id,&#10;          NULL AS nsi_transfer_id,&#10;          NULL AS nsi_id,&#10;          NULL AS order_transfer_id,&#10;          NULL AS event_id,&#10;          NULL AS rqmnt_transfer_id,&#10;          NULL AS rqmnt_id,&#10;          NULL AS lic_condition_transfer_id,&#10;          NULL AS lic_condition_id,&#10;          NULL AS pss_rqmnt_transfer_id,&#10;          NULL AS pss_rqmnt_id,&#10;          NULL AS institutional_rep_transfer_id,&#10;          NULL AS institutional_report_id,&#10;          NULL AS court_report_transfer_id,&#10;          NULL AS court_report_id,&#10;          --&#10;          OT.allocation_reason_id,&#10;          OT.notes AS transfer_notes&#10;          --&#10;        FROM&#10;          offender_transfer OT&#10;            INNER JOIN r_standard_reference_list r1 ON OT.transfer_status_id &#61; R1.standard_reference_list_id AND R1.code_value &#61; &#39;PN&#39;&#10;            INNER JOIN offender O ON O.offender_id &#61; OT.offender_id&#10;            INNER JOIN offender_manager OM ON OM.offender_id  &#61; OT.offender_id AND OM.active_flag &#61; 1&#10;            LEFT OUTER JOIN master_transfer MT ON OT.master_transfer_id &#61; MT.master_transfer_id&#10;            --&#10;            --INNER JOIN z_transfer_batch_detail_0260 TBD ON TBD.transfer_type &#61; &#39;OFFENDER_TRANSFER&#39; AND TBD.transfer_id &#61; OT.offender_transfer_id&#10;            --&#10;        WHERE O.soft_deleted &#61; 0&#10;          AND p_transfer_type &#61; &#39;OFFENDER_TRANSFER&#39;&#10;          AND O.offender_id &#61; p_offender_id&#10;        --&#10;        UNION ALL&#10;        --&#10;        -- ORDER_TRANSFER&#10;        --&#10;        SELECT&#10;          MT.master_transfer_id,&#10;          MT.transfer_date,&#10;          OT.order_transfer_id                      AS transfer_id,&#10;          &#39;ORDER_TRANSFER&#39;                          AS source_table,&#10;          OT.origin_team_id,&#10;          OT.receiving_team_id,&#10;          OT.transfer_status_id,&#10;          --&#10;          OT.request_date                           AS transfer_request_date,&#10;          OT.receiving_staff_id,&#10;          OT.origin_staff_id,&#10;          OT.offender_id,&#10;          NULL AS offender_transfer_id,&#10;          NULL AS nsi_transfer_id,&#10;          NULL AS nsi_id,&#10;          OT.order_transfer_id,&#10;          OT.event_id,&#10;          NULL AS rqmnt_transfer_id,&#10;          NULL AS rqmnt_id,&#10;          NULL AS lic_condition_transfer_id,&#10;          NULL AS lic_condition_id,&#10;          NULL AS pss_rqmnt_transfer_id,&#10;          NULL AS pss_rqmnt_id,&#10;          NULL AS institutional_rep_transfer_id,&#10;          NULL AS institutional_report_id,&#10;          NULL AS court_report_transfer_id,&#10;          NULL AS court_report_id,&#10;          --&#10;          OT.allocation_reason_id,&#10;          OT.notes AS transfer_notes&#10;          --&#10;        FROM&#10;          order_transfer OT&#10;            INNER JOIN r_standard_reference_list r1 ON OT.transfer_status_id &#61; R1.standard_reference_list_id AND R1.code_value &#61; &#39;PN&#39;&#10;            INNER JOIN event E ON E.event_id &#61; OT.event_id&#10;              INNER JOIN offender O ON O.offender_id &#61; E.offender_id&#10;            INNER JOIN order_manager OM ON OM.event_id &#61; OT.event_id AND OM.active_flag &#61; 1&#10;            LEFT OUTER JOIN master_transfer mt ON OT.master_transfer_id &#61; MT.master_transfer_id&#10;            --&#10;            --INNER JOIN z_transfer_batch_detail_0260 TBD ON TBD.transfer_type &#61; &#39;ORDER_TRANSFER&#39; AND TBD.transfer_id &#61; OT.order_transfer_id&#10;            --&#10;        WHERE O.soft_deleted &#61; 0&#10;          AND E.soft_deleted &#61; 0&#10;          AND p_transfer_type &#61; &#39;ORDER_TRANSFER&#39;&#10;          AND O.offender_id &#61; p_offender_id&#10;        --&#10;        UNION ALL&#10;        --&#10;        -- RQMNT_TRANSFER&#10;        --&#10;        SELECT&#10;          MT.master_transfer_id,&#10;          MT.transfer_date,&#10;          RT.rqmnt_transfer_id                      AS transfer_id,&#10;          &#39;RQMNT_TRANSFER&#39;                          AS source_table,&#10;          RT.origin_team_id,&#10;          RT.receiving_team_id,&#10;          RT.transfer_status_id,&#10;          --&#10;          RT.request_date                           AS transfer_request_date,&#10;          RT.receiving_staff_id,&#10;          RT.origin_staff_id,&#10;          RT.offender_id,&#10;          NULL AS offender_transfer_id,&#10;          NULL AS nsi_transfer_id,&#10;          NULL AS nsi_id,&#10;          NULL AS order_transfer_id,&#10;          D.event_id,&#10;          RT.rqmnt_transfer_id,&#10;          RT.rqmnt_id,&#10;          NULL AS lic_condition_transfer_id,&#10;          NULL AS lic_condition_id,&#10;          NULL AS pss_rqmnt_transfer_id,&#10;          NULL AS pss_rqmnt_id,&#10;          NULL AS institutional_rep_transfer_id,&#10;          NULL AS institutional_report_id,&#10;          NULL AS court_report_transfer_id,&#10;          NULL AS court_report_id,&#10;          --&#10;          RT.allocation_reason_id,&#10;          RT.notes AS transfer_notes&#10;          --&#10;        FROM&#10;          rqmnt_transfer RT&#10;            INNER JOIN r_standard_reference_list r1 ON RT.transfer_status_id &#61; R1.standard_reference_list_id AND R1.code_value &#61; &#39;PN&#39;&#10;            INNER JOIN rqmnt R ON R.rqmnt_id &#61; RT.rqmnt_id&#10;              LEFT OUTER JOIN r_rqmnt_type_main_category    RCAT  ON RCAT.rqmnt_type_main_category_id     &#61; R.rqmnt_type_main_category_id&#10;              LEFT OUTER JOIN r_ad_rqmnt_type_main_category RCATA ON RCATA.ad_rqmnt_type_main_category_id &#61; R.ad_rqmnt_type_main_category_id&#10;              INNER JOIN disposal D ON D.disposal_id &#61; R.disposal_id&#10;                INNER JOIN event E ON E.event_id &#61; D.event_id&#10;                  INNER JOIN offender O ON O.offender_id &#61; E.offender_id&#10;              INNER JOIN rqmnt_manager OM ON OM.rqmnt_id &#61; R.rqmnt_id AND OM.active_flag &#61; 1&#10;            LEFT OUTER JOIN master_transfer mt ON RT.master_transfer_id &#61; MT.master_transfer_id&#10;            --&#10;            --INNER JOIN z_transfer_batch_detail_0260 TBD ON TBD.transfer_type &#61; &#39;RQMNT_TRANSFER&#39; AND TBD.transfer_id &#61; RT.rqmnt_transfer_id&#10;            --&#10;        WHERE O.soft_deleted &#61; 0&#10;          AND R.soft_deleted &#61; 0&#10;          AND p_transfer_type &#61; &#39;RQMNT_TRANSFER&#39;&#10;          AND O.offender_id &#61; p_offender_id&#10;        --&#10;        UNION ALL&#10;        --&#10;        -- LIC_CONDITION_TRANSFER&#10;        --&#10;        SELECT&#10;          MT.master_transfer_id,&#10;          MT.transfer_date,&#10;          LCT.lic_condition_transfer_id             AS transfer_id,&#10;          &#39;LIC_CONDITION_TRANSFER&#39;                  AS source_table,&#10;          LCT.origin_team_id,&#10;          LCT.receiving_team_id,&#10;          LCT.transfer_status_id,&#10;          --&#10;          LCT.request_date                          AS transfer_request_date,&#10;          LCT.receiving_staff_id,&#10;          LCT.origin_staff_id,&#10;          LCT.offender_id,&#10;          NULL AS offender_transfer_id,&#10;          NULL AS nsi_transfer_id,&#10;          NULL AS nsi_id,&#10;          NULL AS order_transfer_id,&#10;          D.event_id,&#10;          NULL AS rqmnt_transfer_id,&#10;          NULL AS rqmnt_id,&#10;          LCT.lic_condition_transfer_id,&#10;          LCT.lic_condition_id,&#10;          NULL AS pss_rqmnt_transfer_id,&#10;          NULL AS pss_rqmnt_id,&#10;          NULL AS institutional_rep_transfer_id,&#10;          NULL AS institutional_report_id,&#10;          NULL AS court_report_transfer_id,&#10;          NULL AS court_report_id,&#10;          --&#10;          LCT.allocation_reason_id,&#10;          LCT.notes AS transfer_notes&#10;          --&#10;        FROM&#10;          lic_condition_transfer LCT&#10;            INNER JOIN r_standard_reference_list r1 ON LCT.transfer_status_id &#61; R1.standard_reference_list_id AND R1.code_value &#61; &#39;PN&#39;&#10;            INNER JOIN lic_condition LC ON LC.lic_condition_id &#61; LCT.lic_condition_id&#10;              LEFT OUTER JOIN r_lic_cond_type_main_cat LCAT ON LCAT.lic_cond_type_main_cat_id &#61; LC.lic_cond_type_main_cat_id&#10;              INNER JOIN disposal D ON D.disposal_id &#61; LC.disposal_id&#10;                INNER JOIN event E ON E.event_id &#61; D.event_id&#10;                  INNER JOIN offender O ON O.offender_id &#61; E.offender_id&#10;              INNER JOIN lic_condition_manager OM ON OM.lic_condition_id &#61; LC.lic_condition_id AND OM.active_flag &#61; 1&#10;            LEFT OUTER JOIN master_transfer MT ON LCT.master_transfer_id &#61; MT.master_transfer_id&#10;            --&#10;            --INNER JOIN z_transfer_batch_detail_0260 TBD ON TBD.transfer_type &#61; &#39;LIC_CONDITION_TRANSFER&#39; AND TBD.transfer_id &#61; LCT.lic_condition_transfer_id&#10;            --&#10;        WHERE O.soft_deleted &#61; 0&#10;          AND LC.soft_deleted &#61; 0&#10;          AND p_transfer_type &#61; &#39;LIC_CONDITION_TRANSFER&#39;&#10;          AND O.offender_id &#61; p_offender_id&#10;        --&#10;        UNION ALL&#10;        --&#10;        -- NSI_TRANSFER&#10;        --&#10;        SELECT&#10;          MT.master_transfer_id,&#10;          MT.transfer_date,&#10;          NT.nsi_transfer_id                        AS transfer_id,&#10;          &#39;NSI_TRANSFER&#39;                            AS source_table,&#10;          NT.origin_team_id,&#10;          NT.target_team_id                         AS receiving_team_id,&#10;          NT.transfer_status_id,&#10;          --&#10;          NT.request_date                           AS transfer_request_date,&#10;          NT.target_staff_id,&#10;          NT.origin_staff_id,&#10;          NT.offender_id,&#10;          NULL AS offender_transfer_id,&#10;          NT.nsi_transfer_id,&#10;          NT.nsi_id,&#10;          NULL AS order_transfer_id,&#10;          N.event_id,&#10;          NULL AS rqmnt_transfer_id,&#10;          NULL AS rqmnt_id,&#10;          NULL AS lic_condition_transfer_id,&#10;          NULL AS lic_condition_id,&#10;          NULL AS pss_rqmnt_transfer_id,&#10;          NULL AS pss_rqmnt_id,&#10;          NULL AS institutional_rep_transfer_id,&#10;          NULL AS institutional_report_id,&#10;          NULL AS court_report_transfer_id,&#10;          NULL AS court_report_id,&#10;          --&#10;          NT.allocation_reason_id,&#10;          NT.notes AS transfer_notes&#10;          --&#10;        FROM&#10;          nsi_transfer NT&#10;            INNER JOIN r_standard_reference_list r1 ON NT.transfer_status_id &#61; R1.standard_reference_list_id AND R1.code_value &#61; &#39;PN&#39;&#10;            INNER JOIN nsi N ON N.nsi_id &#61; NT.nsi_id&#10;              INNER JOIN offender O ON O.offender_id &#61; N.offender_id&#10;              INNER JOIN nsi_manager OM ON OM.nsi_id &#61; N.nsi_id AND OM.active_flag &#61; 1&#10;            LEFT OUTER JOIN master_transfer MT ON NT.master_transfer_id &#61; MT.master_transfer_id&#10;            --&#10;            --INNER JOIN z_transfer_batch_detail_0260 TBD ON TBD.transfer_type &#61; &#39;NSI_TRANSFER&#39; AND TBD.transfer_id &#61; NT.nsi_transfer_id&#10;            --&#10;        WHERE O.soft_deleted &#61; 0&#10;          AND N.soft_deleted &#61; 0&#10;          AND p_transfer_type &#61; &#39;NSI_TRANSFER&#39;&#10;          AND O.offender_id &#61; p_offender_id&#10;        --&#10;        UNION ALL&#10;        --&#10;        -- PSS_RQMNT_TRANSFER&#10;        --&#10;        SELECT&#10;          MT.master_transfer_id,&#10;          MT.transfer_date,&#10;          PRT.pss_rqmnt_transfer_id                 AS transfer_id,&#10;          &#39;PSS_RQMNT_TRANSFER&#39;                      AS source_table,&#10;          PRT.origin_team_id,&#10;          PRT.receiving_team_id,&#10;          PRT.transfer_status_id,&#10;          --&#10;          PRT.request_date                          AS transfer_request_date,&#10;          PRT.receiving_staff_id,&#10;          PRT.origin_staff_id,&#10;          PRT.offender_id,&#10;          NULL AS offender_transfer_id,&#10;          NULL AS nsi_transfer_id,&#10;          NULL AS nsi_id,&#10;          NULL AS order_transfer_id,&#10;          D.event_id,&#10;          NULL AS rqmnt_transfer_id,&#10;          NULL AS rqmnt_id,&#10;          NULL AS lic_condition_transfer_id,&#10;          NULL AS lic_condition_id,&#10;          PRT.pss_rqmnt_transfer_id,&#10;          PRT.pss_rqmnt_id,&#10;          NULL AS institutional_rep_transfer_id,&#10;          NULL AS institutional_report_id,&#10;          NULL AS court_report_transfer_id,&#10;          NULL AS court_report_id,&#10;          --&#10;          PRT.allocation_reason_id,&#10;          PRT.notes AS transfer_notes&#10;          --&#10;        FROM&#10;          pss_rqmnt_transfer PRT&#10;            INNER JOIN r_standard_reference_list R1 ON PRT.transfer_status_id &#61; R1.standard_reference_list_id AND R1.code_value &#61; &#39;PN&#39;&#10;            INNER JOIN pss_rqmnt PR ON PR.pss_rqmnt_id &#61; PRT.pss_rqmnt_id&#10;              INNER JOIN custody CUS ON CUS.custody_id &#61; PR.custody_id&#10;                INNER JOIN disposal D ON D.disposal_id &#61; CUS.disposal_id&#10;                  INNER JOIN event E ON E.event_id &#61; D.event_id&#10;                    INNER JOIN offender O ON O.offender_id &#61; E.offender_id&#10;              INNER JOIN pss_rqmnt_manager OM ON OM.pss_rqmnt_id &#61; PR.pss_rqmnt_id AND OM.active_flag &#61; 1&#10;              LEFT OUTER JOIN master_transfer MT ON PRT.master_transfer_id &#61; MT.master_transfer_id&#10;            --&#10;            --INNER JOIN z_transfer_batch_detail_0260 TBD ON TBD.transfer_type &#61; &#39;PSS_RQMNT_TRANSFER&#39; AND TBD.transfer_id &#61; PRT.pss_rqmnt_transfer_id&#10;            --&#10;        WHERE O.soft_deleted &#61; 0&#10;          AND PR.soft_deleted &#61; 0&#10;          AND p_transfer_type &#61; &#39;PSS_RQMNT_TRANSFER&#39;&#10;          AND O.offender_id &#61; p_offender_id&#10;        --&#10;        UNION ALL&#10;        --&#10;        -- INSTITUTIONAL_REPORT_TRANSFER&#10;        --&#10;        SELECT&#10;          MT.master_transfer_id,&#10;          MT.transfer_date,&#10;          IRT.institutional_rep_transfer_id         AS transfer_id,&#10;          &#39;INSTITUTIONAL_REPORT_TRANSFER&#39;           AS source_table,&#10;          IRT.origin_team_id,&#10;          IRT.receiving_team_id,&#10;          IRT.transfer_status_id,&#10;          --&#10;          IRT.request_date                          AS transfer_request_date,&#10;          IRT.receiving_staff_id,&#10;          IRT.origin_staff_id,&#10;          IRT.offender_id,&#10;          NULL AS offender_transfer_id,&#10;          NULL AS nsi_transfer_id,&#10;          NULL AS nsi_id,&#10;          NULL AS order_transfer_id,&#10;          D.event_id,&#10;          NULL AS rqmnt_transfer_id,&#10;          NULL AS rqmnt_id,&#10;          NULL AS lic_condition_transfer_id,&#10;          NULL AS lic_condition_id,&#10;          NULL AS pss_rqmnt_transfer_id,&#10;          NULL AS pss_rqmnt_id,&#10;          IRT.institutional_rep_transfer_id,&#10;          IRT.institutional_report_id,&#10;          NULL AS court_report_transfer_id,&#10;          NULL AS court_report_id,&#10;          --&#10;          IRT.allocation_reason_id,&#10;          IRT.notes AS transfer_notes&#10;          --&#10;        FROM&#10;          institutional_report_transfer IRT&#10;            INNER JOIN r_standard_reference_list R1 ON IRT.transfer_status_id &#61; R1.standard_reference_list_id AND R1.code_value &#61; &#39;PN&#39;&#10;            INNER JOIN institutional_report IR ON IR.institutional_report_id &#61; IRT.institutional_report_id&#10;              INNER JOIN custody CUS ON CUS.custody_id &#61; IR.custody_id&#10;                INNER JOIN disposal D ON D.disposal_id &#61; CUS.disposal_id&#10;                  INNER JOIN event E ON E.event_id &#61; D.event_id&#10;                    INNER JOIN offender O ON O.offender_id &#61; E.offender_id&#10;            INNER JOIN report_manager OM ON OM.institutional_report_id &#61; IR.institutional_report_id AND OM.active_flag &#61; 1&#10;            LEFT OUTER JOIN master_transfer MT ON IRT.master_transfer_id &#61; MT.master_transfer_id&#10;            --&#10;            --INNER JOIN z_transfer_batch_detail_0260 TBD ON TBD.transfer_type &#61; &#39;INSTITUTIONAL_REPORT_TRANSFER&#39; AND TBD.transfer_id &#61; IRT.institutional_rep_transfer_id&#10;            --&#10;        WHERE O.soft_deleted &#61; 0&#10;          AND IR.soft_deleted &#61; 0&#10;          AND p_transfer_type &#61; &#39;INSTITUTIONAL_REPORT_TRANSFER&#39;&#10;          AND O.offender_id &#61; p_offender_id&#10;        --&#10;        UNION ALL&#10;        --&#10;        -- COURT_REPORT_TRANSFER&#10;        --&#10;        SELECT&#10;          MT.master_transfer_id,&#10;          MT.transfer_date,&#10;          CRT.court_report_transfer_id              AS transfer_id,&#10;          &#39;COURT_REPORT_TRANSFER&#39;                   AS source_table,&#10;          CRT.origin_team_id,&#10;          CRT.receiving_team_id,&#10;          CRT.transfer_status_id,&#10;          --&#10;          CRT.request_date                          AS transfer_request_date,&#10;          CRT.receiving_staff_id,&#10;          CRT.origin_staff_id,&#10;          CRT.offender_id,&#10;          NULL AS offender_transfer_id,&#10;          NULL AS nsi_transfer_id,&#10;          NULL AS nsi_id,&#10;          NULL AS order_transfer_id,&#10;          CA.event_id,&#10;          NULL AS rqmnt_transfer_id,&#10;          NULL AS rqmnt_id,&#10;          NULL AS lic_condition_transfer_id,&#10;          NULL AS lic_condition_id,&#10;          NULL AS pss_rqmnt_transfer_id,&#10;          NULL AS pss_rqmnt_id,&#10;          NULL AS institutional_rep_transfer_id,&#10;          NULL AS institutional_report_id,&#10;          CRT.court_report_transfer_id,&#10;          CRT.court_report_id,&#10;          --&#10;          CRT.allocation_reason_id,&#10;          CRT.notes AS transfer_notes&#10;          --&#10;        FROM&#10;          court_report_transfer CRT&#10;            INNER JOIN r_standard_reference_list R1 ON CRT.transfer_status_id &#61; R1.standard_reference_list_id AND R1.code_value &#61; &#39;PN&#39;&#10;            INNER JOIN court_report CR ON CR.court_report_id &#61; CRT.court_report_id&#10;              INNER JOIN court_appearance CA ON CA.court_appearance_id &#61; CR.court_appearance_id&#10;                INNER JOIN event E ON E.event_id &#61; CA.event_id&#10;                  INNER JOIN offender O ON O.offender_id &#61; E.offender_id&#10;              INNER JOIN report_manager OM ON OM.court_report_id &#61; CRT.court_report_id AND OM.active_flag &#61; 1&#10;            LEFT OUTER JOIN master_transfer MT ON CRT.master_transfer_id &#61; MT.master_transfer_id&#10;            --&#10;            --INNER JOIN z_transfer_batch_detail_0260 TBD ON TBD.transfer_type &#61; &#39;COURT_REPORT_TRANSFER&#39; AND TBD.transfer_id &#61; CRT.court_report_transfer_id&#10;            --&#10;        WHERE O.soft_deleted &#61; 0&#10;          AND CR.soft_deleted &#61; 0&#10;          AND p_transfer_type &#61; &#39;COURT_REPORT_TRANSFER&#39;&#10;          AND O.offender_id &#61; p_offender_id&#10;        --&#10;      )&#10;      --&#10;      SELECT&#10;        PT.master_transfer_id,&#10;        PT.transfer_id,&#10;        PT.source_table,&#10;        OTP.code        AS origin_probation_area_code,&#10;        OTP.description AS origin_probation_area_desc,&#10;        CASE WHEN OTP.trust_division_id !&#61; OTP.probation_area_id AND OTP.private &#61; 1 THEN 1 ELSE 0 END AS origin_private,&#10;        RTP.code        AS receiving_probation_area_code,&#10;        RTP.description AS receiving_probation_area_desc,&#10;        CASE WHEN RTP.trust_division_id !&#61; RTP.probation_area_id AND RTP.private &#61; 1 THEN 1 ELSE 0 END AS receiving_private,&#10;        R1.code_description,&#10;        --&#10;        RT.probation_area_id AS target_provider_id,&#10;        OT.probation_area_id AS origin_provider_id,&#10;        transfer_request_date,&#10;        receiving_team_id,&#10;        receiving_staff_id,&#10;        origin_team_id,&#10;        origin_staff_id,&#10;        O.offender_id,&#10;        offender_transfer_id,&#10;        nsi_transfer_id,&#10;        nsi_id,&#10;        order_transfer_id,&#10;        event_id,&#10;        rqmnt_transfer_id,&#10;        rqmnt_id,&#10;        lic_condition_transfer_id,&#10;        lic_condition_id,&#10;        pss_rqmnt_transfer_id,&#10;        pss_rqmnt_id,&#10;        institutional_rep_transfer_id,&#10;        institutional_report_id,&#10;        court_report_transfer_id,&#10;        court_report_id,&#10;        --&#10;        allocation_reason_id,&#10;        transfer_notes,&#10;        --&#10;        l_termination_date AS termination_date,&#10;        --&#10;        O.crn,&#10;        O.surname,&#10;        O.first_name,&#10;        PT.transfer_date&#10;        --&#10;      FROM&#10;        PT_0 PT&#10;          INNER JOIN offender O ON O.offender_id &#61; PT.offender_id&#10;          INNER JOIN r_standard_reference_list R1 ON PT.transfer_status_id &#61; R1.standard_reference_list_id AND R1.code_value &#61; &#39;PN&#39;&#10;          INNER JOIN team OT ON PT.origin_team_id &#61; OT.team_id&#10;            INNER JOIN probation_area OTP ON OT.probation_area_id &#61; OTP.probation_area_id&#10;          INNER JOIN team RT ON RT.team_id &#61; PT.receiving_team_id&#10;            INNER JOIN probation_area RTP ON RTP.probation_area_id &#61; RT.probation_area_id&#10;      WHERE 1&#61;1&#10;        /*AND NOT EXISTS(&#10;            SELECT 1&#10;            FROM z_transfer_0260&#10;            WHERE new_master_transfer_id &#61; PT.master_transfer_id&#10;              AND new_transfer_id &#61; PT.transfer_id&#10;              AND transfer_type &#61; PT.source_table )*/&#10;        AND ( ( NVL(p_area, &#39;ALL&#39;) &#61; &#39;ALL&#39; )&#10;              OR&#10;              ( ( CASE&#10;                    WHEN (p_direction &#61; &#39;I&#39; AND RTP.code &#61; p_area) THEN 1&#10;                    WHEN (p_direction &#61; &#39;O&#39; AND OTP.code &#61; p_area) THEN 1&#10;                    ELSE 0&#10;                END ) &#61; 1&#10;              )&#10;            )&#10;        AND ( p_transfer_id IS NULL OR PT.transfer_id &#61; p_transfer_id )&#10;        AND ( p_event_id    IS NULL OR PT.event_id    &#61; p_event_id    )&#10;        AND ( p_excl_tr_id_lst IS NULL OR&#10;              PT.transfer_id NOT IN (&#10;                SELECT *&#10;                FROM TABLE( PKG_LstUtl.get_list_2_array(p_excl_tr_id_lst) ) ) )&#10;      ORDER BY PT.master_transfer_id, PT.source_table, PT.transfer_id;&#10;    --&#10;    l_rec_transfer csTransfers%ROWTYPE;&#10;    --&#10;    l_cols_TAB PKG_CRC_RPT.rpt_cols_TAB_TYP;&#10;    --&#10;    l_rows INTEGER;&#10;    l_cols INTEGER;&#10;    --&#10;    PROCEDURE do_init IS&#10;    BEGIN&#10;        --&#10;        LC_USER_ID          :&#61; PKG_LOOKUPS.GetUserID(p_distinguished_name &#61;&gt; PKG_Common.NVLSTR(SYS_CONTEXT(&#39;USERENV&#39;, &#39;CLIENT_IDENTIFIER&#39;), &#39;[Data Maintenance]&#39;));&#10;        LC_UPDATED_DATETIME :&#61; SYSDATE;&#10;        --&#10;        l_termination_date :&#61; NVL(p_termination_date, TRUNC(LC_UPDATED_DATETIME));&#10;        --&#10;        IF p_offender_id IS NULL AND p_event_id IS NULL AND p_transfer_id IS NULl then&#10;            raise_application_error(-20001, &#39;ERROR in DO_TERMINATE_PENDING_TRANSFERS: at least one of the (P_OFFENDER_ID, P_EVENT_ID, P_TRANSFER_ID) parameter values must be specified&#39;);&#10;        END IF;&#10;        --&#10;    END do_init;&#10;    --&#10;    PROCEDURE do_init_report IS&#10;    BEGIN&#10;        init_report(l_rows, l_cols);&#10;        --&#10;        l_cols_TAB.DELETE;&#10;        --&#10;        do_add_col_def(l_cols_TAB, 1, &#39;C&#39;, 15, &#39;L&#39;, &#39;Y&#39;, &#39;master_transfer_id&#39;, &#39;Master Transfer ID&#39;);&#10;        do_add_col_def(l_cols_TAB, 2, &#39;C&#39;, 15, &#39;L&#39;, &#39;Y&#39;, &#39;transfer_id&#39;, &#39;Transfer ID&#39;);&#10;        do_add_col_def(l_cols_TAB, 3, &#39;C&#39;, 30, &#39;L&#39;, &#39;Y&#39;, &#39;source_table&#39;, &#39;Source Transfer&#39;);&#10;        do_add_col_def(l_cols_TAB, 4, &#39;C&#39;, 35, &#39;L&#39;, &#39;Y&#39;, &#39;origin_probation_area_code&#39;, &#39;Origin Provider&#39;);&#10;        do_add_col_def(l_cols_TAB, 5, &#39;C&#39;, 35, &#39;L&#39;, &#39;Y&#39;, &#39;receiving_probation_area_code&#39;, &#39;Receiving Provider&#39;);&#10;        do_add_col_def(l_cols_TAB, 6, &#39;C&#39;, 11, &#39;L&#39;, &#39;Y&#39;, &#39;transfer_date&#39;, &#39;Transfer    Date&#39;);&#10;        do_add_col_def(l_cols_TAB, 7, &#39;C&#39;,  8, &#39;L&#39;, &#39;Y&#39;, &#39;crn&#39;, &#39;Offender CRN&#39;);&#10;        do_add_col_def(l_cols_TAB, 8, &#39;C&#39;, 35, &#39;L&#39;, &#39;Y&#39;, &#39;surname&#39;, &#39;Offender Surname&#39;);&#10;        do_add_col_def(l_cols_TAB, 9, &#39;C&#39;, 35, &#39;L&#39;, &#39;Y&#39;, &#39;forename&#39;, &#39;Offender Forename&#39;);&#10;        --&#10;    END do_init_report;&#10;    --&#10;    PROCEDURE do_fetch_rec IS&#10;    BEGIN&#10;        --&#10;        l_cols_TAB(1).value :&#61; l_rec_transfer.master_transfer_id;&#10;        l_cols_TAB(2).value :&#61; l_rec_transfer.transfer_id;&#10;        l_cols_TAB(3).value :&#61; l_rec_transfer.source_table;&#10;        l_cols_TAB(4).value :&#61; l_rec_transfer.origin_probation_area_desc;&#10;        l_cols_TAB(5).value :&#61; l_rec_transfer.receiving_probation_area_desc;&#10;        --&#10;        l_cols_TAB(6).value :&#61; TO_CHAR(l_rec_transfer.transfer_date, &#39;DD-MON-YYYY&#39;);&#10;        l_cols_TAB(7).value :&#61; l_rec_transfer.crn;&#10;        l_cols_TAB(8).value :&#61; l_rec_transfer.surname;&#10;        l_cols_TAB(9).value :&#61; l_rec_transfer.first_name;&#10;        --&#10;    END do_fetch_rec;&#10;    --&#10;    PROCEDURE do_print_page_hdr(p_area VARCHAR2, p_direction VARCHAR2 DEFAULT NULL, p_start_date DATE DEFAULT NULL, p_end_date DATE DEFAULT NULL)&#10;    IS&#10;        CURSOR csArea IS&#10;          SELECT&#10;            TRUNC(LC_UPDATED_DATETIME) AS print_date,&#10;            description&#10;          FROM probation_area&#10;          WHERE code &#61; p_area;&#10;        l_rec_area csArea%ROWTYPE;&#10;    BEGIN&#10;        --&#10;        OPEN  csArea;&#10;        FETCH csArea INTO l_rec_area;&#10;        CLOSE csArea;&#10;        --&#10;        do_print_rpt_title(&#39;nDelius Pending Transfers Report&#39;);&#10;        print_line(&#39;&#39;);&#10;        print_line(&#39;&#39;);&#10;        print_line(&#39;&#39;);&#10;        --&#10;        print_line(&#39;TARGET PROVIDER    : &#39; || p_area || CASE WHEN p_area &lt;&gt; &#39;ALL&#39; THEN &#39; &#39; || l_rec_area.description END );&#10;        print_line(&#39;&#39;);&#10;        --&#10;        IF EMPTY2NULL(p_direction) IS NOT NULL THEN&#10;            print_line(&#39;TRANSFERS DIRECTION: &#39; || p_direction );&#10;            print_line(&#39;&#39;);&#10;        END IF;&#10;        --&#10;        IF EMPTY2NULL(p_start_date) IS NOT NULL THEN&#10;            print_line(&#39;PERIOD START DATE  : &#39; || TO_CHAR(TRUNC(p_start_date), &#39;DD-MON-YYYY&#39;) );&#10;            print_line(&#39;&#39;);&#10;        END IF;&#10;        --&#10;        IF EMPTY2NULL(p_end_date) IS NOT NULL THEN&#10;            print_line(&#39;PERIOD END DATE    : &#39; || TO_CHAR(TRUNC(p_end_date), &#39;DD-MON-YYYY&#39;) );&#10;            print_line(&#39;&#39;);&#10;        END IF;&#10;        --&#10;        print_line(&#39;PRINT DATE / TIME  : &#39; || TO_CHAR(l_rec_area.print_date, &#39;DD-MON-YYYY HH24:MI&#39;));&#10;        print_line(&#39;&#39;);&#10;        --&#10;        print_line(&#39;&#39;);&#10;        print_line(&#39;&#39;);&#10;        print_line(&#39;&#39;);&#10;        print_line(CHR(12));&#10;        --&#10;    END do_print_page_hdr;&#10;    --&#10;    FUNCTION get_transfer_rejection_reason(p_source_table VARCHAR2) RETURN NUMBER IS&#10;    BEGIN&#10;        RETURN&#10;            PKG_Lookups.funcgetStdRefListID(&#10;                CASE&#10;                    WHEN p_source_table &#61; &#39;OFFENDER_TRANSFER&#39;             THEN &#39;OFFENDER AREA TRANSFER REJECTION REASON&#39;&#10;                    WHEN p_source_table &#61; &#39;ORDER_TRANSFER&#39;                THEN &#39;ORDER AREA TRANSFER REJECTION REASON&#39;&#10;                    WHEN p_source_table &#61; &#39;LIC_CONDITION_TRANSFER&#39;        THEN &#39;LICENCE AREA TRANSFER REJECTION REASON&#39;&#10;                    WHEN p_source_table &#61; &#39;RQMNT_TRANSFER&#39;                THEN &#39;REQUIREMENT AREA TRANSFER REJECTION REASON&#39;&#10;                    WHEN p_source_table &#61; &#39;NSI_TRANSFER&#39;                  THEN &#39;NON STATUTORY INTERVENTION AREA TRANSFER REJECTION REASON&#39;&#10;                    WHEN p_source_table &#61; &#39;PSS_RQMNT_TRANSFER&#39;            THEN &#39;PSS AREA TRANSFER REJECTION REASON&#39;&#10;                    WHEN p_source_table &#61; &#39;COURT_REPORT_TRANSFER&#39;         THEN &#39;CR AREA TRANSFER REJECTION REASON&#39;&#10;                    WHEN p_source_table &#61; &#39;INSTITUTIONAL_REPORT_TRANSFER&#39; THEN &#39;IR AREA TRANSFER REJECTION REASON&#39;&#10;                END,&#10;                --&#10;                &#39;TE&#39; );&#10;    END get_transfer_rejection_reason;&#10;    --&#10;    FUNCTION get_transfer_accepted_decision(p_source_table VARCHAR2) RETURN NUMBER IS&#10;    BEGIN&#10;        RETURN PKG_Lookups.funcgetStdRefListID( &#39;ACCEPTED DECISION&#39;, &#39;R&#39; );&#10;    END get_transfer_accepted_decision;&#10;    --&#10;    FUNCTION get_transfer_withdrawal_reason(p_source_table VARCHAR2) RETURN NUMBER IS&#10;    BEGIN&#10;        RETURN PKG_Lookups.funcgetStdRefListID(&#39;TRANSFER WITHDRAWAL REASON&#39;, &#39;TERM&#39;); --UOM&#10;    END get_transfer_withdrawal_reason;&#10;    --&#10;    PROCEDURE do_check_ref_data(p_transfer_TYPE VARCHAR2 DEFAULT &#39;ALL&#39;)&#10;    IS&#10;        --&#10;        l_TAB T_TAB_ORGANISATIONS :&#61; T_TAB_ORGANISATIONS();&#10;        --&#10;        l_table_name VARCHAR2(30);&#10;        --&#10;    BEGIN&#10;        --&#10;        IF NVL(p_transfer_TYPE, &#39;ALL&#39;) &#61; &#39;ALL&#39; THEN&#10;            l_TAB :&#61; LC_TRANSFER_TABLES;&#10;        ELSE&#10;            l_TAB :&#61; PKG_Common.funcMultisetIntersect( T_TAB_ORGANISATIONS(UPPER(p_transfer_TYPE)), LC_TRANSFER_TABLES );&#10;        END IF;&#10;        --&#10;        FOR l_idx IN 1..l_TAB.COUNT LOOP&#10;            --&#10;            l_table_name :&#61; l_TAB(l_idx);&#10;            --&#10;            IF get_transfer_rejection_reason(l_table_name) IS NULL THEN&#10;                raise_application_error(-20001, &#39;ERROR in do_check_ref_data: the default Transfer Rejection Reason for [&#39; || l_table_name || &#39;] is missing in STD Ref table&#39;);&#10;            ELSIF get_transfer_withdrawal_reason(l_table_name) IS NULL THEN&#10;                raise_application_error(-20001, &#39;ERROR in do_check_ref_data: the default Transfer Withdrawal Reason for [&#39; || l_table_name || &#39;] is missing in STD Ref table&#39;);&#10;            END IF;&#10;            --&#10;        END LOOP;&#10;        --&#10;        --debug_message(&#39;Default Transfer Rejection Reason: &#39;  || get_transfer_rejection_reason (&#39;ORDER_TRANSFER&#39;));&#10;        --debug_message(&#39;Default Transfer Withdrawal Reason: &#39; || get_transfer_withdrawal_reason(&#39;ORDER_TRANSFER&#39;));&#10;        --&#10;    END do_check_ref_data;&#10;    --&#10;    PROCEDURE do_close_transfers&#10;    IS&#10;        --&#10;        l_SQL                        VARCHAR2(1024);&#10;        l_date                       DATE :&#61; NVL(l_rec_transfer.termination_date, LC_UPDATED_DATETIME);&#10;        l_base_table                 VARCHAR2(30);&#10;        l_base_table_pkey_id         NUMBER;&#10;        l_contact_type_code          VARCHAR2(30);&#10;        l_contact_type_id            NUMBER;&#10;        l_contact_alert_flag         R_CONTACT_TYPE.contact_alert_flag%TYPE;&#10;        l_transfer_status_id         NUMBER;&#10;        l_transfer_status_desc       VARCHAR2(200);&#10;        l_allocation_reason_desc     VARCHAR2(200);&#10;        l_rejection_reason_desc      VARCHAR2(200);&#10;        l_target_probation_area_code VARCHAR2(10);&#10;        l_staff_employee_id          NUMBER;&#10;        --&#10;        PROCEDURE do_init_transfer_ctx IS&#10;        BEGIN&#10;            l_transfer_status_id     :&#61; PKG_Lookups.funcgetStdRefListID(&#39;TRANSFER STATUS&#39;, CASE WHEN p_direction &#61; &#39;I&#39; THEN &#39;TR&#39; ELSE &#39;TW&#39; END);&#10;            l_transfer_status_desc   :&#61; PKG_Lookups.funcgetStdRefListCodeDesc(l_transfer_status_id);                --funcgetStdRefListCodeAndDesc(l_transfer_status_id, &#39; &#39;);&#10;            l_allocation_reason_desc :&#61; PKG_Lookups.funcgetStdRefListCodeDesc(l_rec_transfer.allocation_reason_id); --funcgetStdRefListCodeAndDesc(l_rec_transfer.allocation_reason_id, &#39; &#39;);&#10;            l_rejection_reason_desc  :&#61; PKG_Lookups.funcgetStdRefListCodeDesc(                                      --funcgetStdRefListCodeAndDesc(&#10;                                            CASE WHEN p_direction &#61; &#39;I&#39; THEN get_transfer_rejection_reason(l_rec_transfer.source_table)&#10;                                                 WHEN p_direction &#61; &#39;O&#39; THEN get_transfer_withdrawal_reason(l_rec_transfer.source_table)&#10;                                            END&#10;                                            --,  &#39; &#39;&#10;                                        );&#10;            --&#10;            l_target_probation_area_code :&#61;&#10;                PKG_Lookups.funcgetTabRecord_CACHED(&#10;                    p_table    &#61;&gt; &#39;PROBATION_AREA&#39;,&#10;                    p_ref_col  &#61;&gt; &#39;probation_area_id&#39;,&#10;                    p_ref_val  &#61;&gt; l_rec_transfer.target_provider_id,&#10;                    p_data_fld &#61;&gt; &#39;code&#39; );&#10;            --&#10;            l_staff_employee_id :&#61;&#10;                NVL(&#10;                    l_rec_transfer.receiving_staff_id,&#10;                    PKG_Lookups.funcgetTabRecord_CACHED(&#10;                        p_table    &#61;&gt; &#39;staff&#39;,&#10;                        p_data_fld &#61;&gt; &#39;staff_id&#39;,&#10;                        p_ref_col  &#61;&gt; &#39;officer_code&#39;,&#10;                        p_ref_val  &#61;&gt; l_target_probation_area_code || &#39;UATU&#39; )&#10;                );&#10;            --&#10;            IF l_staff_employee_id IS NULL THEN&#10;                raise_application_error(-20001,&#10;                    &#39;ERROR in DO_CLOSE_TRANSFERS &#39;                  ||&#10;                    &#39;[transfer_table&#61;&#39;      || l_rec_transfer.source_table             || &#39;]&#39; ||&#10;                    &#39;[transfer_id&#61;&#39;         || l_rec_transfer.transfer_id            || &#39;]&#39; ||&#10;                    &#39;[master_transfer_id&#61;&#39;  || l_rec_transfer.master_transfer_id     || &#39;]&#39; ||&#10;                    &#39;[target_provider&#61;&#39;     || l_target_probation_area_code || &#39;]: &#39; || CHR(10) ||&#10;                    &#39;FAILED to identify RECEIVING STAFF record&#39; );&#10;            --ELSE&#10;            --    raise_application_error(-20001, &#39;ERROR IN do_close_transfers: l_staff_employee_id&#61;&#39; || l_staff_employee_id);&#10;            END IF;&#10;            --&#10;            -- DST-1533: Witdrawal Contact Types&#10;            --INTER_PROVIDER_OFFENDER_TRANSFER_WITHDRAWN(&quot;ETOW&quot;),&#10;            --INTER_PROVIDER_ORDER_TRANSFER_WITHDRAWN(&quot;ETORW&quot;),&#10;            --INTER_PROVIDER_NSI_TRANSFER_WITHDRAWN(&quot;ETNW&quot;),&#10;            --INTER_PROVIDER_COMPONENT_TRANSFER_WITHDRAWN(&quot;ETCW&quot;),&#10;            --INTER_PROVIDER_PSS_TRANSFER_WITHDRAWN(&quot;ETPW&quot;),&#10;            --INTER_PROVIDER_COURT_REPORT_TRANSFER_WITHDRAWN(&quot;ETCRW&quot;),&#10;            --INTER_PROVIDER_INSTITUTIONAL_REPORT_TRANSFER_WITHDRAWN(&quot;ETIRW&quot;),&#10;            --&#10;            IF l_rec_transfer.source_table &#61; &#39;OFFENDER_TRANSFER&#39; THEN&#10;                l_base_table :&#61; &#39;OFFENDER&#39;;&#10;                l_contact_type_code :&#61; CASE WHEN p_direction &#61; &#39;I&#39; THEN &#39;ETTX&#39; ELSE &#39;ETOW&#39; END;&#10;            ELSIF l_rec_transfer.source_table &#61; &#39;ORDER_TRANSFER&#39; THEN&#10;                l_base_table :&#61; &#39;EVENT&#39;;&#10;                l_contact_type_code :&#61; CASE WHEN p_direction &#61; &#39;I&#39; THEN &#39;ETOX&#39; ELSE &#39;ETORW&#39; END;&#10;            ELSIF l_rec_transfer.source_table &#61; &#39;NSI_TRANSFER&#39; THEN&#10;                l_base_table :&#61; &#39;NSI&#39;;&#10;                l_contact_type_code :&#61; CASE WHEN p_direction &#61; &#39;I&#39; THEN &#39;NSIX&#39; ELSE &#39;ETNW&#39; END;&#10;            ELSIF l_rec_transfer.source_table &#61; &#39;RQMNT_TRANSFER&#39; THEN&#10;                l_base_table :&#61; &#39;RQMNT&#39;;&#10;                l_contact_type_code :&#61; CASE WHEN p_direction &#61; &#39;I&#39; THEN &#39;ETCX&#39; ELSE &#39;ETCW&#39; END;&#10;            ELSIF l_rec_transfer.source_table &#61; &#39;LIC_CONDITION_TRANSFER&#39; THEN&#10;                l_base_table :&#61; &#39;LIC_CONDITION&#39;;&#10;                l_contact_type_code :&#61; CASE WHEN p_direction &#61; &#39;I&#39; THEN &#39;ETCX&#39; ELSE &#39;ETCW&#39; END;&#10;            ELSIF l_rec_transfer.source_table &#61; &#39;PSS_RQMNT_TRANSFER&#39; THEN&#10;                l_base_table :&#61; &#39;PSS_RQMNT&#39;;&#10;                l_contact_type_code :&#61; CASE WHEN p_direction &#61; &#39;I&#39; THEN &#39;ETPX&#39; ELSE &#39;ETPW&#39; END;&#10;            ELSIF l_rec_transfer.source_table &#61; &#39;COURT_REPORT_TRANSFER&#39; THEN&#10;                l_base_table :&#61; &#39;COURT_REPORT&#39;;&#10;                l_contact_type_code :&#61; CASE WHEN p_direction &#61; &#39;I&#39; THEN &#39;ETCRX&#39; ELSE &#39;ETCRW&#39; END;&#10;            ELSIF l_rec_transfer.source_table &#61; &#39;INSTITUTIONAL_REPORT_TRANSFER&#39; THEN&#10;                l_base_table :&#61; &#39;INSTITUTIONAL_REPORT&#39;;&#10;                l_contact_type_code :&#61; CASE WHEN p_direction &#61; &#39;I&#39; THEN &#39;ETIRX&#39; ELSE &#39;ETIRW&#39; END;&#10;            END IF;&#10;            --&#10;            SELECT&#10;              contact_type_id,&#10;              contact_alert_flag&#10;            INTO&#10;              l_contact_type_id,&#10;              l_contact_alert_flag&#10;            FROM r_contact_type&#10;            WHERE code &#61; l_contact_type_code;&#10;            --&#10;        END do_init_transfer_ctx;&#10;        --&#10;        PROCEDURE do_check_master_transfer&#10;        IS&#10;        BEGIN&#10;            IF l_rec_transfer.master_transfer_id IS NULL THEN&#10;                --&#10;                l_rec_transfer.master_transfer_id :&#61; -1;&#10;                l_rec_transfer.transfer_date      :&#61; NVL(l_rec_transfer.transfer_request_date, NVL(l_rec_transfer.termination_date, TRUNC(LC_UPDATED_DATETIME)));&#10;                --&#10;                -- YF: MT creation (if missing)is not required anymore (was needed for SPG compound MT outbound messages)&#10;                /*INSERT INTO master_transfer(&#10;                  master_transfer_id,&#10;                  offender_id,&#10;                  transfer_date,&#10;                  transfer_user_id,&#10;                  transfer_status_id,&#10;                  transfer_status_date,&#10;                  target_provider_id,&#10;                  row_version,&#10;                  created_by_user_id,&#10;                  created_datetime,&#10;                  last_updated_user_id,&#10;                  last_updated_datetime&#10;                ) VALUES (&#10;                  master_transfer_id_SEQ.nextval,&#10;                  l_rec_transfer.offender_id,&#10;                  NVL(l_rec_transfer.transfer_request_date, NVL(l_rec_transfer.termination_date, TRUNC(LC_UPDATED_DATETIME))),&#10;                  LC_USER_ID,&#10;                  PKG_Lookups.funcgetStdRefListID(&#39;TRANSFER STATUS&#39;, &#39;TCOM&#39;),&#10;                  NVL(l_rec_transfer.termination_date, LC_UPDATED_DATETIME),&#10;                  l_rec_transfer.target_provider_id,&#10;                  0,&#10;                  LC_USER_ID,&#10;                  LC_UPDATED_DATETIME,&#10;                  LC_USER_ID,&#10;                  LC_UPDATED_DATETIME )&#10;                RETURNING master_transfer_id, transfer_date INTO l_rec_transfer.master_transfer_id, l_rec_transfer.transfer_date;&#10;                --&#10;                debug_message(&#39;DO_CHECK_MASTER_TRANSFER: created new MASTER_TRASFER record [&#39; || l_rec_transfer.master_transfer_id || &#39;]&#39;);*/&#10;                --&#10;            END IF;&#10;            --&#10;            -- Add Master Transfer record to the SPG buffer queue&#10;            IF NOT l_tab_master_transfer.EXISTS(l_rec_transfer.master_transfer_id) THEN&#10;                --&#10;                l_rec_master_transfer :&#61; NULL;&#10;                --&#10;                l_rec_master_transfer.master_transfer_id  :&#61; l_rec_transfer.master_transfer_id;&#10;                l_rec_master_transfer.offender_id         :&#61; l_rec_transfer.offender_id;&#10;                l_rec_master_transfer.crn                 :&#61; l_rec_transfer.crn;&#10;                l_rec_master_transfer.transfer_direction  :&#61; p_direction;&#10;                l_rec_master_transfer.origin_provider_id  :&#61; l_rec_transfer.origin_provider_id;&#10;                l_rec_master_transfer.target_provider_id  :&#61; l_rec_transfer.target_provider_id;&#10;                l_rec_master_transfer.interested_crc_list :&#61; PKG_SPG_SUPPORT.get_off_interested_CRCs(p_offender_id&#61;&gt;l_rec_transfer.offender_id);&#10;                --&#10;                l_tab_master_transfer(l_rec_transfer.master_transfer_id) :&#61; l_rec_master_transfer;&#10;                --&#10;            END IF;&#10;            --&#10;        END do_check_master_transfer;&#10;        --&#10;        PROCEDURE do_upd_tr_status_and_reason IS&#10;        BEGIN&#10;            l_SQL :&#61;&#10;               &#39;UPDATE &#39; || l_rec_transfer.source_table || &#39; SET&#10;                  master_transfer_id   &#61; NVL(master_transfer_id, :p_master_transfer_id),&#10;                  --&#10;                  transfer_status_id   &#61; :p_transfer_status_id,&#10;                  --&#10;                  &#39; || CASE WHEN l_rec_transfer.source_table &#61; &#39;COURT_REPORT_TRANSFER&#39; THEN &#39;rejected_reason_id&#39; ELSE &#39;rejection_reason_id&#39; END || &#39; &#61; :p_rejection_reason_id,&#10;                  accepted_decision_id &#61; :p_accepted_decision_id,&#10;                  withdrawal_reason_id &#61; :p_withdrawal_reason_id,&#10;                  --&#10;                  &#39; || CASE WHEN p_transfer_notes IS NOT NULL THEN &#39;notes &#61; PKG_LstUtl.concat_CLOB(notes, &#39;&#39;&#39; || p_transfer_notes || &#39;&#39;&#39;, p_delim&#61;&gt;CHR(10)),&#39; ELSE &#39;--&#39; END || &#39;&#10;                  --&#10;                  transfer_status_date &#61; :p_SYSDATE,&#10;                  last_updated_user_id &#61; :p_user_id,&#10;                  last_updated_datetime &#61; :p_SYSDATE&#10;                WHERE &#39; || PKG_DynSQL.get_tab_pk_fld_lst(l_rec_transfer.source_table) || &#39; &#61; :p_transfer_id&#10;                RETURNING &#39; || PKG_DynSQL.get_tab_pk_fld_lst(l_base_table) || &#39;&#10;                INTO :x_ID&#39;;&#10;            --&#10;            EXECUTE IMMEDIATE l_SQL&#10;            USING&#10;              l_rec_transfer.master_transfer_id,&#10;              l_transfer_status_id,&#10;              CASE WHEN p_direction &#61; &#39;I&#39; THEN get_transfer_rejection_reason(l_rec_transfer.source_table)  END,&#10;              CASE WHEN p_direction &#61; &#39;I&#39; THEN get_transfer_accepted_decision(l_rec_transfer.source_table) END,&#10;              CASE WHEN p_direction &#61; &#39;O&#39; THEN get_transfer_withdrawal_reason(l_rec_transfer.source_table) END,&#10;              l_date,&#10;              LC_USER_ID,&#10;              LC_UPDATED_DATETIME,&#10;              l_rec_transfer.transfer_id&#10;            RETURNING INTO&#10;              l_base_table_pkey_id;&#10;            --&#10;            l_SQL :&#61;&#10;               &#39;UPDATE &#39; || l_base_table || &#39; SET&#10;                  pending_transfer &#61; 0&#10;                WHERE &#39; || PKG_DynSQL.get_tab_pk_fld_lst(l_base_table) || &#39; &#61; :p_id&#39;;&#10;            EXECUTE IMMEDIATE l_SQL USING l_base_table_pkey_id;&#10;            --&#10;        END do_upd_tr_status_and_reason;&#10;        --&#10;        PROCEDURE do_ins_tr_hist IS&#10;        BEGIN&#10;            --&#10;            NULL;&#10;            -- YF TODO: not needed anymore?&#10;            /*INSERT INTO z_transfer_0260(&#10;              old_master_transfer_id,&#10;              old_transfer_id,&#10;              transfer_type,&#10;              direction,&#10;              new_master_transfer_id,&#10;              new_transfer_id,&#10;              --&#10;              row_version,&#10;              created_by_user_id,&#10;              created_datetime,&#10;              last_updated_user_id,&#10;              last_updated_datetime&#10;            ) VALUES (&#10;              l_rec_transfer.master_transfer_id,&#10;              l_rec_transfer.transfer_id,&#10;              l_rec.source_table,&#10;              p_direction,&#10;              NULL,&#10;              NULL,&#10;              --&#10;              0,&#10;              LC_USER_ID,&#10;              LC_UPDATED_DATETIME,&#10;              LC_USER_ID,&#10;              LC_UPDATED_DATETIME );*/&#10;        EXCEPTION WHEN OTHERS THEN&#10;            debug_message(&#39;ERROR in DO_INS_TR_HIST: &#39; ||&#10;                &#39;[MstTrID&#61;&#39; || l_rec_transfer.master_transfer_id || &#39;]&#39; ||&#10;                &#39;[SrcTab&#61;&#39;  || l_rec_transfer.source_table       || &#39;]&#39; ||&#10;                &#39;[TrID&#61;&#39;    || l_rec_transfer.transfer_id        || &#39;]&#39; ||&#10;                CHR(10)     ||&#10;                SQLERRM     || CHR(10) ||&#10;                DBMS_UTILITY.format_error_backtrace );&#10;            RAISE;&#10;        END do_ins_tr_hist;&#10;        --&#10;        PROCEDURE do_ins_rejected_tr_diary&#10;        IS&#10;            --&#10;            l_rejection_reason_id NUMBER :&#61; get_transfer_rejection_reason(l_rec_transfer.source_table);&#10;            --&#10;        BEGIN&#10;            --&#10;            INSERT INTO rejected_transfer_diary(&#10;              rejected_transfer_diary_id,&#10;              transfer_request_date,&#10;              transfer_status_date,&#10;              target_provider_id,&#10;              target_team_id,&#10;              target_staff_id,&#10;              origin_provider_id,&#10;              origin_team_id,&#10;              origin_staff_id,&#10;              rejection_reason_id,&#10;              offender_id,&#10;              master_transfer_id,&#10;              offender_transfer_id,&#10;              nsi_transfer_id,&#10;              nsi_id,&#10;              order_transfer_id,&#10;              event_id,&#10;              rqmnt_transfer_id,&#10;              rqmnt_id,&#10;              lic_condition_transfer_id,&#10;              lic_condition_id,&#10;              pss_rqmnt_transfer_id,&#10;              pss_rqmnt_id,&#10;              institutional_rep_transfer_id,&#10;              institutional_report_id,&#10;              court_report_transfer_id,&#10;              court_report_id,&#10;              --&#10;              note_flag )&#10;            SELECT&#10;              REJECTED_TRANSFER_DIARY_ID_SEQ.nextval,&#10;              l_rec_transfer.transfer_request_date,&#10;              l_date AS transfer_status_date,&#10;              l_rec_transfer.target_provider_id,&#10;              l_rec_transfer.receiving_team_id,&#10;              l_rec_transfer.receiving_staff_id,&#10;              l_rec_transfer.origin_provider_id,&#10;              l_rec_transfer.origin_team_id,&#10;              l_rec_transfer.origin_staff_id,&#10;              l_rejection_reason_id AS rejection_reason_id,&#10;              l_rec_transfer.offender_id,&#10;              l_rec_transfer.master_transfer_id,&#10;              l_rec_transfer.offender_transfer_id,&#10;              l_rec_transfer.nsi_transfer_id,&#10;              l_rec_transfer.nsi_id,&#10;              l_rec_transfer.order_transfer_id,&#10;              l_rec_transfer.event_id,&#10;              l_rec_transfer.rqmnt_transfer_id,&#10;              l_rec_transfer.rqmnt_id,&#10;              l_rec_transfer.lic_condition_transfer_id,&#10;              l_rec_transfer.lic_condition_id,&#10;              l_rec_transfer.pss_rqmnt_transfer_id,&#10;              l_rec_transfer.pss_rqmnt_id,&#10;              l_rec_transfer.institutional_rep_transfer_id,&#10;              l_rec_transfer.institutional_report_id,&#10;              l_rec_transfer.court_report_transfer_id,&#10;              l_rec_transfer.court_report_id,&#10;              --&#10;              &#39;Y&#39; AS note_flag&#10;            FROM dual;&#10;            --&#10;        END do_ins_rejected_tr_diary;&#10;        --&#10;        PROCEDURE do_cr_tr_contact&#10;        IS&#10;            --&#10;            l_contact_id NUMBER;&#10;            --&#10;        BEGIN&#10;            --&#10;            l_contact_id :&#61; contact_id_SEQ.NEXTVAL;&#10;            --&#10;            INSERT INTO contact (&#10;              /*00*/ contact_id,&#10;              /*01*/ offender_id,&#10;              --&#10;              /*02*/ event_id,&#10;              /*03*/ nsi_id,&#10;              /*04*/ rqmnt_id,&#10;              /*05*/ lic_condition_id,&#10;              /*06*/ pss_rqmnt_id,&#10;              /*07*/ table_name,&#10;              /*08*/ primary_key_id,&#10;              --&#10;              /*09*/ contact_date,&#10;              /*10*/ contact_start_time,&#10;              /*11*/ contact_type_id,&#10;              --&#10;              --/*12*/ probation_area_id,&#10;              /*13*/ team_id,&#10;              /*14*/ staff_id,&#10;              --/*15*/ trust_provider_flag,&#10;              --&#10;              /*16*/ notes,&#10;              --&#10;              /*17*/ created_by_user_id,&#10;              /*18*/ created_datetime,&#10;              /*19*/ last_updated_user_id,&#10;              /*20*/ last_updated_datetime,&#10;              --&#10;              /*21*/ partition_area_id,&#10;              /*22*/ row_version,&#10;              /*23*/ soft_deleted,&#10;              --&#10;              /*24*/ alert_active&#10;            )&#10;            SELECT&#10;              /*00*/ l_contact_id,&#10;              /*01*/ l_rec_transfer.offender_id,&#10;              --&#10;              /*02*/ l_rec_transfer.event_id,&#10;              /*03*/ l_rec_transfer.nsi_id,&#10;              /*04*/ l_rec_transfer.rqmnt_id,&#10;              /*05*/ l_rec_transfer.lic_condition_id,&#10;              /*06*/ l_rec_transfer.pss_rqmnt_id,&#10;              /*07*/&#10;              CASE&#10;                WHEN l_base_table IN (&#39;INSTITUTIONAL_REPORT&#39;, &#39;COURT_REPORT&#39;) THEN l_base_table&#10;              END AS table_name,&#10;              /*08*/&#10;              CASE&#10;                WHEN l_base_table &#61; &#39;INSTITUTIONAL_REPORT&#39; THEN TO_CHAR(l_rec_transfer.institutional_report_id)&#10;                WHEN l_base_table &#61; &#39;COURT_REPORT&#39;         THEN TO_CHAR(l_rec_transfer.court_report_id)&#10;              END AS primary_key_id,&#10;              --&#10;              /*09*/ /*NVL(l_rec_transfer.termination_date, */TRUNC(LC_UPDATED_DATETIME)/*)*/    AS contact_date,&#10;              /*10*/ TO_DATE(&#39;19700101 &#39; || TO_CHAR(/*NVL(l_rec_transfer.termination_date, */LC_UPDATED_DATETIME/*)*/, &#39;HH24:MI:SS&#39;), &#39;YYYYMMDD HH24:MI:SS&#39;) AS contact_start_time,&#10;              /*11*/ l_contact_type_id AS contact_type_id,&#10;              --&#10;              --/*12*/ l_rec_transfer.target_provider_id AS probation_area_id,&#10;              /*13*/ l_rec_transfer.receiving_team_id  AS team_id,&#10;              /*14*/ l_staff_employee_id               AS staff_id,&#10;              --&#10;              --/*15*/ 0 AS trust_provider_flag,&#10;              --&#10;              /*16*/&#10;              CASE WHEN p_direction &#61; &#39;I&#39; THEN&#10;                  PKG_LstUtl.concat_CLOB(&#10;                      &#39;Transfer Status: &#39;    || l_transfer_status_desc,&#10;                      &#39;Transfer Reason: &#39;    || l_allocation_reason_desc,&#10;                      &#39;Rejection Reason: &#39;   || l_rejection_reason_desc,&#10;                      &#39;Rejection Date: &#39;     || TO_CHAR(NVL(l_rec_transfer.termination_date, TRUNC(LC_UPDATED_DATETIME)), &#39;DD-MON-YYYY&#39;),&#10;                      &#39;Owning Provider: &#39;    || PKG_Lookups.funcgetTabRecord_CACHED(p_table&#61;&gt;&#39;PROBATION_AREA&#39;, p_ref_col&#61;&gt;&#39;probation_area_id&#39;, p_ref_val&#61;&gt;l_rec_transfer.origin_provider_id, p_data_fld&#61;&gt;&#39;description&#39;),&#10;                      &#39;Receiving Provider: &#39; || PKG_Lookups.funcgetTabRecord_CACHED(p_table&#61;&gt;&#39;PROBATION_AREA&#39;, p_ref_col&#61;&gt;&#39;probation_area_id&#39;, p_ref_val&#61;&gt;l_rec_transfer.target_provider_id, p_data_fld&#61;&gt;&#39;description&#39;),&#10;                      PKG_LstUtl.concat_CLOB(&#10;                          &#39;Notes: &#39;,&#10;                          PKG_LstUtl.concat_CLOB(l_rec_transfer.transfer_notes, p_transfer_notes, p_delim&#61;&gt;CHR(10)),&#10;                          p_delim &#61;&gt; CHR(10) ),&#10;                      p_delim &#61;&gt; CHR(10) )&#10;              ELSE&#10;                  --&#10;                  PKG_LstUtl.concat_CLOB(&#10;                      &#39;Receiving Provider: &#39; || PKG_Lookups.funcgetTabRecord_CACHED(p_table&#61;&gt;&#39;PROBATION_AREA&#39;, p_ref_col&#61;&gt;&#39;probation_area_id&#39;, p_ref_val&#61;&gt;l_rec_transfer.target_provider_id, p_data_fld&#61;&gt;&#39;description&#39;),&#10;                      &#39;Receiving Team: &#39;     || PKG_Lookups.funcgetTabRecord_CACHED(p_table&#61;&gt;&#39;TEAM&#39;          , p_ref_col&#61;&gt;&#39;team_id&#39;          , p_ref_val&#61;&gt;l_rec_transfer.receiving_team_id , p_data_fld&#61;&gt;&#39;description&#39;),&#10;                      &#39;Receiving Staff: &#39;    || StaffSupport.getStaffDisplayName(l_rec_transfer.receiving_staff_id),&#10;                      &#39;Withdrawal Reason: &#39;  || l_rejection_reason_desc,&#10;                      &#39;Withdrawal Date: &#39;    || TO_CHAR(NVL(l_rec_transfer.termination_date, TRUNC(LC_UPDATED_DATETIME)), &#39;DD-MON-YYYY&#39;),&#10;                      --&#39;Notes: &#39;              || CHR(10) || l_rec_transfer.transfer_notes || CHR(10),&#10;                      p_delim &#61;&gt; CHR(10) )&#10;              END AS notes,&#10;              --&#10;              /*17*/ LC_USER_ID          AS created_by_user_id,&#10;              /*18*/ LC_UPDATED_DATETIME AS created_datetime,&#10;              /*19*/ LC_USER_ID          AS last_updated_user_id,&#10;              /*20*/ LC_UPDATED_DATETIME AS last_updated_datetime,&#10;              --&#10;              /*21*/ 0 AS partition_area_id,&#10;              /*22*/ 0 AS row_version,&#10;              /*23*/ 0 AS soft_deleted,&#10;              --&#10;              /*24*/ l_contact_alert_flag AS alert_active&#10;            FROM dual;&#10;            --&#10;            IF l_contact_alert_flag &#61; &#39;Y&#39; THEN&#10;                INSERT INTO contact_alert(&#10;                  /*00*/ contact_alert_id,&#10;                  /*01*/ offender_id,&#10;                  /*02*/ offender_manager_id,&#10;                  /*03*/ contact_id,&#10;                  /*04*/ contact_type_id,&#10;                  /*05*/ contact_outcome_type_id,&#10;                  /*06*/ trust_provider_flag,&#10;                  /*07*/ trust_provider_team_id,&#10;                  /*08*/ staff_employee_id,&#10;                  /*09*/ row_version )&#10;                SELECT&#10;                  /*00*/ contact_alert_id_SEQ.NEXTVAL AS contact_alert_id,&#10;                  /*01*/ C.offender_id,&#10;                  /*02*/ OM.offender_manager_id,&#10;                  /*03*/ C.contact_id,&#10;                  /*04*/ C.contact_type_id,&#10;                  /*05*/ C.contact_outcome_type_id,&#10;                  /*06*/ OM.trust_provider_flag,&#10;                  /*07*/ OM.trust_provider_team_id,&#10;                  /*08*/ OM.staff_employee_id,&#10;                  /*09*/ 0 AS row_version&#10;                FROM&#10;                  contact C&#10;                    INNER JOIN offender_manager OM ON OM.offender_id &#61; C.offender_id AND OM.active_flag &#61; 1&#10;                WHERE C.contact_id &#61; l_contact_id;&#10;                --&#10;            END IF;&#10;            --&#10;        END do_cr_tr_contact;&#10;        --&#10;    BEGIN&#10;        --&#10;        do_init_transfer_ctx;&#10;        --&#10;        do_check_master_transfer;&#10;        --&#10;        do_upd_tr_status_and_reason;&#10;        --&#10;        IF p_direction &#61; &#39;I&#39; THEN&#10;            do_ins_rejected_tr_diary;&#10;        END IF;&#10;        --&#10;        do_ins_tr_hist;&#10;        --&#10;        IF l_rec_transfer.master_transfer_id &gt; 0 THEN&#10;            --&#10;            DECLARE&#10;                --&#10;                l_qty NUMBER;&#10;                --&#10;            BEGIN&#10;                --&#10;                SELECT COUNT(1) INTO l_qty&#10;                FROM TABLE( PKG_SEARCH.procMasterTranPenTranTAB(l_rec_transfer.master_transfer_id) );&#10;                --&#10;--                debug_message(&#10;--                    &#39;Transfer_id&#61;&#39; || l_rec_transfer.transfer_id || &#39;; &#39; ||&#10;--                    &#39;MT_id&#61;&#39; || l_rec_transfer.master_transfer_id || &#39;; &#39; ||&#10;--                    &#39;MT_PN_qty&#61;&#39; || l_qty ||&#10;--                    &#39;&#39; );&#10;                --&#10;                IF l_qty &#61; 0 THEN&#10;                    --&#10;                    UPDATE master_transfer SET&#10;                      transfer_status_id    &#61; PKG_Lookups.funcgetStdRefListID(&#39;TRANSFER STATUS&#39;, &#39;TCOM&#39;),&#10;                      transfer_status_date  &#61; NVL(l_rec_transfer.termination_date, LC_UPDATED_DATETIME),&#10;                      last_updated_user_id  &#61; LC_USER_ID,&#10;                      last_updated_datetime &#61; LC_UPDATED_DATETIME&#10;                    WHERE master_transfer_id &#61; l_rec_transfer.master_transfer_id;&#10;                    --&#10;--                    debug_message(&#10;--                        &#39;Transfer_id&#61;&#39; || l_rec_transfer.transfer_id || &#39;; &#39; ||&#10;--                        &#39;MT_id&#61;&#39; || l_rec_transfer.master_transfer_id || &#39;; &#39; ||&#10;--                        &#39;SQLUPDATE_qty&#61;&#39; || SQL%ROWCOUNT ||&#10;--                        &#39;&#39; );&#10;                    --&#10;                END IF;&#10;            --&#10;            END;&#10;            --&#10;        END IF;&#10;        --&#10;        do_cr_tr_contact;&#10;        --&#10;    END do_close_transfers;&#10;    --&#10;    PROCEDURE do_send_spg_msg&#10;    IS&#10;        --&#10;        l_tab_crc T_TAB_ORGANISATIONS :&#61; T_TAB_ORGANISATIONS();&#10;        --&#10;        l_master_transfer_id NUMBER;&#10;        --&#10;    BEGIN&#10;        --&#10;        l_master_transfer_id :&#61; l_tab_master_transfer.FIRST;&#10;        LOOP&#10;            EXIT WHEN l_master_transfer_id IS NULL;&#10;            --&#10;            l_rec_master_transfer :&#61; l_tab_master_transfer(l_master_transfer_id);&#10;            --&#10;            AlfrescoSupport.addOffenders2Queue( t_tab_ORGANISATIONS(l_rec_master_transfer.offender_id) );&#10;            --&#10;            l_tab_crc :&#61; l_rec_master_transfer.interested_crc_list;&#10;            --&#10;            IF NVL(l_tab_crc.COUNT, 0) &gt; 0 THEN&#10;                --&#10;                -- YF: since the SPG has now been discontinued - instead of sending SPG outbound messages&#10;                --     leave only a sanity check for the interested_CRCs[] (must be empty)&#10;                raise_application_error( -20001,&#10;                    &#39;ERROR in DO_SEND_SPG_MSG &#39;                     ||&#10;                    &#39;[&#39; || l_rec_master_transfer.CRN                || &#39;]&#39; ||&#10;                    &#39;[&#39; || l_rec_master_transfer.transfer_direction || &#39;]&#39; ||&#10;                    &#39;[(orig,tgt area&#61;&#39; ||&#10;                        PKG_LstUtl.get_array_2_list(&#10;                            T_TAB_ORGANISATIONS(l_rec_master_transfer.target_provider_id, l_rec_master_transfer.origin_provider_id),&#10;                            p_iterator_function&#61;&gt;&#39;PKG_Lookups.funcgetTabRecord_CACHED(p_table&#61;&gt;&#39;&#39;PROBATION_AREA&#39;&#39;, p_ref_col&#61;&gt;&#39;&#39;probation_area_id&#39;&#39;, p_ref_val&#61;&gt;:p_probation_area_id, p_data_fld&#61;&gt;&#39;&#39;CODE&#39;&#39;)&#39;&#10;                        ) || &#39;]&#39; ||&#10;                    &#39;[interested_CRCs&#61;&#39; ||&#10;                        PKG_LstUtl.get_array_2_list(&#10;                                PKG_Common.funcMultisetIntersect(&#10;                                    T_TAB_ORGANISATIONS(l_rec_master_transfer.target_provider_id, l_rec_master_transfer.origin_provider_id),&#10;                                    l_tab_crc ),&#10;                            p_iterator_function&#61;&gt;&#39;PKG_Lookups.funcgetTabRecord_CACHED(p_table&#61;&gt;&#39;&#39;PROBATION_AREA&#39;&#39;, p_ref_col&#61;&gt;&#39;&#39;probation_area_id&#39;&#39;, p_ref_val&#61;&gt;:p_probation_area_id, p_data_fld&#61;&gt;&#39;&#39;CODE&#39;&#39;)&#39;&#10;                        ) || &#39;]: interested_CRCs must be empty []&#39; );&#10;                --&#10;            END IF;&#10;            --&#10;            l_master_transfer_id :&#61; l_tab_master_transfer.NEXT(l_master_transfer_id);&#10;            --&#10;        END LOOP;&#10;        --&#10;        AlfrescoSupport.processQueue;&#10;        --&#10;    END do_send_spg_msg;&#10;    --&#10;BEGIN&#10;    --&#10;    do_init;&#10;    --&#10;    do_check_ref_data(p_transfer_TYPE);&#10;    --&#10;    l_rows :&#61; 0;&#10;    l_cols :&#61; 250;&#10;    do_init_report;&#10;    --&#10;    do_print_rpt_title(&#39;nDelius Pending Transfers - &#39; || CASE WHEN p_direction &#61; &#39;I&#39; THEN &#39;Incoming&#39; ELSE &#39;Outgoing&#39; END);&#10;    --&#10;    do_print_line_buf(l_cols_TAB, &#39;T&#39;);&#10;    do_print_line_buf(l_cols_TAB, &#39;U&#39;);&#10;    OPEN csTransfers;&#10;    LOOP&#10;        FETCH csTransfers INTO l_rec_transfer;&#10;        EXIT WHEN csTransfers%NOTFOUND;&#10;        --&#10;        do_fetch_rec;&#10;        do_print_line_buf(l_cols_TAB, &#39;D&#39;);&#10;        --&#10;        IF NVL(p_report_only_flag, &#39;N&#39;) &#61; &#39;N&#39; THEN&#10;            do_close_transfers;&#10;        END IF;&#10;        --&#10;    END LOOP;&#10;    CLOSE csTransfers;&#10;    --&#10;    IF NVL(p_report_only_flag, &#39;N&#39;) &#61; &#39;N&#39; THEN&#10;        do_send_spg_msg;&#10;    END IF;&#10;    --&#10;EXCEPTION WHEN OTHERS THEN&#10;    --&#10;    IF csTransfers%ISOPEN THEN&#10;        CLOSE csTransfers;&#10;    END IF;&#10;    --&#10;    do_print_rpt_title(&#39;ERROR: &#39; || SQLERRM);&#10;    RAISE;&#10;    --&#10;END do_terminate_pending_transfers;&#10;--&#10;--&#10;--&#10;PROCEDURE do_close_lc_pending_transfers(&#10;    p_event_id                  NUMBER,&#10;    p_lic_condition_id          NUMBER   DEFAULT NULL,&#10;    p_lic_condition_transfer_id NUMBER   DEFAULT NULL,&#10;    p_termination_date          DATE     DEFAULT NULL,&#10;    p_report_only_flag          VARCHAR2 DEFAULT &#39;N&#39; )&#10;IS&#10;    --&#10;    CURSOR cs IS&#10;      WITH T AS (&#10;        SELECT DISTINCT&#10;          &#39;LIC_CONDITION_TRENSFER&#39; AS transfer_type,&#10;          O.offender_id,&#10;          O.crn,&#10;          E.event_id,&#10;          E.event_number,&#10;          --&#10;          CASE WHEN p_lic_condition_transfer_id IS NOT NULL OR p_lic_condition_id IS NOT NULL THEN LCT.lic_condition_transfer_id END AS lic_condition_transfer_id,&#10;          -- If NOT NULL then exclude Transfer&#10;          CASE WHEN LCAT.code IN ( &#39;LAP&#39; ) THEN LCT.lic_condition_transfer_id END AS lic_condition_transfer_id_1&#10;          --&#10;      FROM&#10;        event E&#10;          INNER JOIN offender O ON O.offender_id &#61; E.offender_id&#10;          INNER JOIN disposal D ON D.event_id &#61; E.event_id&#10;            INNER JOIN lic_condition LC ON LC.disposal_id &#61; D.disposal_id&#10;              LEFT OUTER JOIN r_lic_cond_type_main_cat LCAT ON LCAT.lic_cond_type_main_cat_id &#61; LC.lic_cond_type_main_cat_id&#10;              INNER JOIN lic_condition_transfer LCT ON LCT.lic_condition_id &#61; LC.lic_condition_id&#10;                INNER JOIN r_standard_reference_list r1 ON LCT.transfer_status_id &#61; R1.standard_reference_list_id AND R1.code_value &#61; &#39;PN&#39;&#10;      WHERE 1&#61;1&#10;        AND E.event_id &#61; p_event_id&#10;        AND LC.lic_condition_id &#61; NVL(p_lic_condition_id, LC.lic_condition_id)&#10;        AND LCT.lic_condition_transfer_id &#61; NVL(p_lic_condition_transfer_id, LCT.lic_condition_transfer_id)&#10;        --AND NVL(LCAT.code, &#39;XYZ&#39;) NOT IN ( &#39;LAP&#39; )&#10;      )&#10;      --&#10;      SELECT DISTINCT&#10;        transfer_type,&#10;        offender_id,&#10;        crn,&#10;        event_id,&#10;        event_number,&#10;        lic_condition_transfer_id,&#10;        LISTAGG(lic_condition_transfer_id_1, &#39;,&#39;) WITHIN GROUP (ORDER BY lic_condition_transfer_id_1) AS exclude_transfer_id_lst&#10;      FROM T&#10;      GROUP BY&#10;        transfer_type,&#10;        offender_id,&#10;        crn,&#10;        event_id,&#10;        event_number,&#10;        lic_condition_transfer_id;&#10;    --&#10;    l_rec cs%ROWTYPE;&#10;    --&#10;    PROCEDURE do_close_lc_transfers&#10;    IS&#10;        --&#10;        l_tab_direction T_TAB_ORGANISATIONS :&#61; T_TAB_ORGANISATIONS(&#39;I&#39;/*, &#39;O&#39;*/); -- &#39;I&#39; in combination with P_AREA&#61;ALL will set all PN transfers as Rejected (O - for withdrawal)&#10;        --&#10;    BEGIN&#10;        --&#10;        FOR l_idx IN 1..l_tab_direction.COUNT LOOP&#10;            do_terminate_pending_transfers(&#10;                p_area             &#61;&gt; &#39;ALL&#39;,&#10;                p_offender_id      &#61;&gt; l_rec.offender_id,&#10;                p_event_id         &#61;&gt; l_rec.event_id,&#10;                p_transfer_id      &#61;&gt; l_rec.lic_condition_transfer_id,&#10;                p_transfer_type    &#61;&gt; &#39;LIC_CONDITION_TRANSFER&#39;,&#10;                p_direction        &#61;&gt; l_tab_direction(l_idx),&#10;                p_excl_tr_id_lst   &#61;&gt; TRIM(l_rec.exclude_transfer_id_lst),&#10;                p_report_only_flag &#61;&gt; NVL(p_report_only_flag, &#39;N&#39;),&#10;                p_termination_date &#61;&gt; p_termination_date,&#10;                p_transfer_notes   &#61;&gt; &#39;Transfer automatically rejected due to termination of licence condition&#39; );&#10;        END LOOP;&#10;        --&#10;    END do_close_lc_transfers;&#10;    --&#10;BEGIN&#10;    --&#10;    OPEN cs;&#10;    LOOP&#10;        FETCH cs INTO l_rec;&#10;        EXIT WHEN cs%NOTFOUND;&#10;        --&#10;--        debug_message( &#39;DO_CLOSE_LC_TRANSFERS &#39; ||&#10;--            &#39;[event_id&#61;&#39;       || l_rec.event_id                  || &#39;]&#39; ||&#10;--            &#39;[transfer_id&#61;&#39;    || l_rec.lic_condition_transfer_id || &#39;]&#39; ||&#10;--            &#39;[excl_tr_id_lst&#61;&#39; || l_rec.exclude_transfer_id_lst   || &#39;]&#39; );&#10;        --&#10;        do_close_lc_transfers;&#10;        --&#10;    END LOOP;&#10;    CLOSE cs;&#10;    --&#10;END do_close_lc_pending_transfers;&#10;&#10;BEGIN&#10;--&#10;--&#10;    PKG_Global.do_init;&#10;--&#10;--&#10;END pkg_data_maint;</textarea>
                        </div>
                    </div>
                </section>
            </div>
            <!-- /.content-wrapper -->
            <footer class="main-footer">
                <div>
                    <div class="pull-right hidden-xs">
                        <a href="https://github.com/schemaspy/schemaspy" title="GitHub for SchemaSpy"><i class="fa fa-github-square fa-2x"></i></a>
                        <a href="http://stackoverflow.com/questions/tagged/schemaspy" title="StackOverflow for SchemaSpy"><i class="fa fa-stack-overflow fa-2x"></i></a>
                    </div>
                    <strong>Generated by <a href="http://schemaspy.org/" class="logo-text"><i class="fa fa-database"></i> SchemaSpy 6.2.4</a></strong>
                </div>
                <!-- /.container -->
            </footer>
        </div>
        <!-- ./wrapper -->

        <!-- jQuery 2.2.3 -->
        <script src="../bower/admin-lte/plugins/jQuery/jquery-2.2.3.min.js"></script>
        <script src="../bower/admin-lte/plugins/jQueryUI/jquery-ui.min.js"></script>
        <!-- Bootstrap 3.3.5 -->
        <script src="../bower/admin-lte/bootstrap/js/bootstrap.min.js"></script>
        <!-- DataTables -->
        <script src="../bower/datatables.net/jquery.dataTables.min.js"></script>
        <script src="../bower/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
        <script src="../bower/datatables.net-buttons/dataTables.buttons.min.js"></script>
        <script src="../bower/datatables.net-buttons-bs/js/buttons.bootstrap.min.js"></script>
        <script src="../bower/datatables.net-buttons/buttons.html5.min.js"></script>
        <script src="../bower/datatables.net-buttons/buttons.print.min.js"></script>
        <script src="../bower/datatables.net-buttons/buttons.colVis.min.js"></script>
        <!-- SheetJS -->
        <script src="../bower/js-xlsx/xlsx.full.min.js"></script>
        <!-- pdfmake -->
        <script src="../bower/pdfmake/pdfmake.min.js"></script>
        <script src="../bower/pdfmake/vfs_fonts.js"></script>
        <!-- SlimScroll -->
        <script src="../bower/admin-lte/plugins/slimScroll/jquery.slimscroll.min.js"></script>
        <!-- FastClick -->
        <script src="../bower/admin-lte/plugins/fastclick/fastclick.js"></script>
        <!-- Salvattore -->
        <script src="../bower/salvattore/salvattore.min.js"></script>
        <!-- AnchorJS -->
        <script src="../bower/anchor-js/anchor.min.js"></script>
        <!-- CodeMirror -->
        <script src="../bower/codemirror/codemirror.js"></script>
        <script src="../bower/codemirror/sql.js"></script>
        <!-- AdminLTE App -->
        <script src="../bower/admin-lte/dist/js/app.min.js"></script>
        <script src="routine.js"></script>
        <script src="../schemaSpy.js"></script>
    </body>
</html>
# Default config
spring:
  jackson:
    default-property-inclusion: non_null
  jpa:
    database-platform: org.hibernate.dialect.OracleDialect
    hibernate.ddl-auto: validate
    properties:
      hibernate.query.mutation_strategy: org.hibernate.query.sqm.mutation.internal.inline.InlineMutationStrategy
  security.oauth2.client:
    registration:
      prison-case-notes:
        provider: hmpps-auth
        authorization-grant-type: client_credentials
        client-id: ${integrations.prison-case-notes.client-id}
        client-secret: ${integrations.prison-case-notes.client-secret}
    provider:
      hmpps-auth:
        token-uri: http://localhost:${wiremock.port}/auth/oauth/token
  cloud.openfeign.client.config:
    default:
      logger-level: full
      connect-timeout: 5000
      read-timeout: 5000
      default-request-headers:
        Accept: application/json
        Content-Type: application/json

delius.db.username: PrisonCaseNotesToProbation

management.endpoints.web:
  base-path: /
  exposure.include: [ "health", "info" ]

logging.level:
  org.hibernate.engine.jdbc.spi.SqlExceptionHelper: OFF

---
# Shared dev/test config
spring.config.activate.on-profile: [ "dev", "integration-test", "oracle" ]

context:
  initializer:
    classes: uk.gov.justice.digital.hmpps.wiremock.WireMockInitialiser

spring:
  datasource.url: jdbc:h2:file:./dev;MODE=Oracle;DEFAULT_NULL_ORDERING=HIGH;AUTO_SERVER=true;AUTO_SERVER_PORT=9092
  jpa.hibernate.ddl-auto: create-drop

wiremock:
  enabled: true

messaging:
  consumer.queue: events

integrations:
  prison-case-notes:
    client-id: prison-case-notes-to-probation
    client-secret: prison-case-notes-to-probation

logging.level:
  uk.gov.justice.digital.hmpps: DEBUG
  org.hibernate.tool.schema: ERROR
  org.apache.activemq: WARN



---
spring.config.activate.on-profile: dev


---
spring.config.activate.on-profile: integration-test
spring.datasource.url: jdbc:h2:mem:./test;MODE=Oracle;DEFAULT_NULL_ORDERING=HIGH;DB_CLOSE_ON_EXIT=FALSE



---
spring.config.activate.on-profile: oracle
spring.datasource.url: 'jdbc:tc:oracle:slim-faststart:///XEPDB1'

---
spring.config.activate.on-profile: localstack
spring.cloud.aws:
  sqs.endpoint: http://localhost:4566
  sns.endpoint: http://localhost:4566
  credentials:
    access-key: localstack
    secret-key: localstack
